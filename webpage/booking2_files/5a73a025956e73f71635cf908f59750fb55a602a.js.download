var _i_ = this._i_ || function() {}, _r_ = this._r_ || function(t) {
return t;
};

B.define("caret", function() {
_i_("4ab:1");
var t = function(t) {
_i_("4ab:81");
var e;
if (!t) return _r_();
if (document.selection) return t.focus(), e = document.selection.createRange(), e.moveStart("character", -t.value.length), _r_(e.text.length);
if (t.selectionStart || 0 === t.selectionStart) return _r_(t.selectionStart);
return _r_(0);
}, e = function(t, e) {
_i_("4ab:82");
var i;
if (!t) return _r_();
document.selection ? (t.focus(), i = document.selection.createRange(), i.moveStart("character", -t.value.length), i.moveStart("character", e), i.moveEnd("character", 0), i.select()) :(t.selectionStart || 0 === t.selectionStart) && (t.selectionStart = e, t.selectionEnd = e, t.focus()), _r_();
}, i = function(t, e, i) {
_i_("4ab:83");
var n;
if (!t) return _r_();
document.selection ? (t.focus(), n = document.selection.createRange(), n.moveStart("character", -t.value.length), n.moveStart("character", e), n.moveEnd("character", i - e), n.select()) :(t.selectionStart || 0 === t.selectionStart) && (t.selectionStart = e, t.selectionEnd = i, t.focus()), _r_();
}, n = function(t) {
_i_("4ab:84");
var e;
if (!t) return _r_();
if (document.selection) return t.focus(), e = document.selection.createRange(), _r_(e.text.length || 0);
if (t.selectionStart || 0 === t.selectionStart) return _r_(t.selectionEnd - t.selectionStart);
return _r_(0);
};
return _r_({
getPosition:t,
setPosition:e,
setSelection:i,
getSelectionLength:n
});
}), B.define("click-out", function(t, e, i) {
"use strict";
_i_("4ab:2");
var n = {}, s = !1;
function a() {
_i_("4ab:41"), s || (s = !0, document.documentElement.addEventListener ? document.documentElement.addEventListener("click", r) :document.documentElement.attachEvent && document.documentElement.attachEvent("onclick", r)), _r_();
}
function r(t) {
_i_("4ab:42");
var e, i = Object.keys(n), s = {}, a = !1;
if (i.length) for (e = t.target || t.srcElement; e && (i.forEach(function(t) {
_i_("4ab:442"), n[t].element === e && (s[t] = !0, 1 == i.length && (a = !0)), _r_();
}), !a); ) e = e.parentNode;
i.forEach(function(t) {
_i_("4ab:117"), !s[t] && n[t] && (n[t].callback.call(!1), o(t)), _r_();
}), _r_();
}
function o(t) {
_i_("4ab:43"), n[t] && delete n[t], _r_();
}
function _() {
_i_("4ab:44");
var t = Object.keys(n);
t.forEach(function(t) {
_i_("4ab:118"), n[t].callback.call(!1), o(t), _r_();
}), _r_();
}
e.addMonitor = function(t, e) {
_i_("4ab:85"), a();
var i = Math.random();
return "string" == typeof t.jquery && (t = t[0]), setTimeout(function() {
_i_("4ab:427"), n[i] = {
element:t,
callback:e
}, _r_();
}, 4), _r_(i);
}, e.removeMonitor = o, e.forceClickOut = _, _r_();
}), B.define("keycodes", [], function() {
"use strict";
_i_("4ab:3");
var t = {
backspace:8,
tab:9,
enter:13,
shift:16,
control:17,
alt:18,
escape:27,
space:32,
pageUp:33,
pageDown:34,
end:35,
home:36,
leftArrow:37,
upArrow:38,
rightArrow:39,
downArrow:40,
"delete":46,
navigation:[ 9 ].concat(i(33, 40)),
deletion:[ 8, 46 ],
arrow:i(37, 40),
number:i(48, 57).concat(i(96, 105)),
alphabetic:i(65, 90),
modifier:i(16, 18)
};
t = n(t);
function e(t) {
return _i_("4ab:45"), _r_(t.slice(0, 1).toUpperCase() + t.slice(1));
}
function i(t, e) {
_i_("4ab:46");
for (var i = [], n = 0; e - t >= n; n++) i.push(t + n);
return _r_(i);
}
function n(t) {
_i_("4ab:47");
var e = 65;
return _r_("abcdefghijklmnopqrstuvwxyz".split("").reduce(function(t, i) {
return _i_("4ab:119"), t[i] = e++, _r_(t);
}, t));
}
function s(e, i) {
if (_i_("4ab:48"), Array.isArray(t[e]) && -1 !== t[e].indexOf(i)) return _r_(!0);
if (t[e] === i) return _r_(!0);
return _r_(!1);
}
function a(t, e) {
return _i_("4ab:49"), _r_(s(e, t));
}
function r(e) {
_i_("4ab:50");
var i = [];
return Object.keys(t).forEach(function(t) {
_i_("4ab:120"), s(t, e) && i.push(t), _r_();
}), _r_(i);
}
var o = {
getTypes:r,
isKeycodeType:a
};
return Object.keys(t).forEach(function(t) {
_i_("4ab:86"), o["is" + e(t)] = function(e) {
return _i_("4ab:428"), _r_(a(e, t));
}, _r_();
}), _r_(o);
}), B.define("read-data-options", function(t, e, i) {
_i_("4ab:4"), i.exports = function(t, e) {
_i_("4ab:87");
var i = {};
return t.jquery && (t = t[0]), Object.keys(e).forEach(function(n) {
_i_("4ab:429");
var s = e[n], a = "data-" + n, r = null;
if ("function" == typeof s && (s = {
type:s
}), "string" == typeof s.name && (a = "data-" + s.name), !t.attributes[a]) {
if (s.hasOwnProperty("defaultValue")) i[n] = s.defaultValue; else if (s.hasOwnProperty("required")) throw new Error("read-data-options: missing required " + a + " attribute");
return _r_();
}
var r = t.getAttribute(a);
if (s.type === Boolean) r = !/^0|false|no|off$/.test(r); else if (s.type === String) r = r || s.defaultValue; else {
if (s.type !== Number) throw new Error("data-options: Invalid option type for " + n);
r = parseFloat(r, 10), isNaN(r) && (r = s.defaultValue);
}
i[n] = r, _r_();
}), _r_(i);
}, _r_();
}), B.define("calendar-base", function(t, e, i) {
_i_("4ab:5");
function n(t) {
_i_("4ab:51"), t = t || {}, this.startDate = t.startDate, this.endDate = t.endDate, this.siblingMonths = t.siblingMonths, this.weekNumbers = t.weekNumbers, this.weekStart = t.weekStart, void 0 === this.weekStart && (this.weekStart = 0), _r_();
}
n.prototype.getCalendar = function(t, e) {
_i_("4ab:88");
var i = new Date(Date.UTC(t, e, 1, 0, 0, 0, 0));
t = i.getUTCFullYear(), e = i.getUTCMonth();
for (var s, a, r, o, _, l = [], h = i.getUTCDay(), d = -((7 - this.weekStart + h) % 7), c = n.daysInMonth(t, e), u = (c - d) % 7, p = n.daysInMonth(t, e - 1), f = d, b = c - f + (0 != u ? 7 - u :0) + d, g = null; b > f; ) a = f + 1, s = ((1 > f ? 7 + f :f) + h) % 7, 1 > a || a > c ? this.siblingMonths ? (1 > a ? (o = e - 1, _ = t, 0 > o && (o = 11, _--), a = p + a) :a > c && (o = e + 1, _ = t, o > 11 && (o = 0, _++), a = f - c + 1), r = {
day:a,
weekDay:s,
month:o,
year:_,
siblingMonth:!0
}) :r = !1 :r = {
day:a,
weekDay:s,
month:e,
year:t
}, r && this.weekNumbers && (null === g ? g = n.calculateWeekNumber(r) :1 == s && 52 == g ? g = 1 :1 == s && g++, r.weekNumber = g), r && this.startDate && (r.selected = this.isDateSelected(r)), l.push(r), f++;
return _r_(l);
}, n.prototype.isDateSelected = function(t) {
if (_i_("4ab:89"), t.year == this.startDate.year && t.month == this.startDate.month && t.day == this.startDate.day) return _r_(!0);
if (this.endDate) {
if (t.year == this.startDate.year && t.month == this.startDate.month && t.day < this.startDate.day) return _r_(!1);
if (t.year == this.endDate.year && t.month == this.endDate.month && t.day > this.endDate.day) return _r_(!1);
if (t.year == this.startDate.year && t.month < this.startDate.month) return _r_(!1);
if (t.year == this.endDate.year && t.month > this.endDate.month) return _r_(!1);
if (t.year < this.startDate.year) return _r_(!1);
if (t.year > this.endDate.year) return _r_(!1);
return _r_(!0);
}
return _r_(!1);
}, n.prototype.setStartDate = function(t) {
_i_("4ab:90"), this.startDate = t, _r_();
}, n.prototype.setEndDate = function(t) {
_i_("4ab:91"), this.endDate = t, _r_();
}, n.prototype.setDate = n.prototype.setStartDate, n.diff = function(t, e) {
return _i_("4ab:92"), t = new Date(Date.UTC(t.year, t.month, t.day, 0, 0, 0, 0)), e = new Date(Date.UTC(e.year, e.month, e.day, 0, 0, 0, 0)), _r_(Math.ceil((t.getTime() - e.getTime()) / 864e5));
}, n.interval = function(t, e) {
return _i_("4ab:93"), _r_(Math.abs(n.diff(t, e)) + 1);
}, n.compare = function(t, e) {
if (_i_("4ab:94"), "object" != typeof t || "object" != typeof e || null === t || null === e) throw new TypeError("dates must be objects");
if (t.year < e.year) return _r_(-1);
if (t.year > e.year) return _r_(1);
if (t.month < e.month) return _r_(-1);
if (t.month > e.month) return _r_(1);
if (t.day < e.day) return _r_(-1);
if (t.day > e.day) return _r_(1);
return _r_(0);
}, n.daysInMonth = function(t, e) {
return _i_("4ab:95"), _r_(new Date(t, e + 1, 0).getDate());
}, n.isLeapYear = function(t) {
return _i_("4ab:96"), _r_(t % 4 == 0 && t % 100 != 0 || t % 400 == 0);
}, n.calculateWeekNumber = function(t) {
_i_("4ab:97");
var e = new Date(Date.UTC(t.year, t.month, t.day, 0, 0, 0, 0)), i = new Date(e.valueOf()), n = (e.getUTCDay() + 6) % 7;
i.setUTCDate(i.getUTCDate() - n + 3);
var s = i.valueOf();
return i.setUTCMonth(0, 1), 4 != i.getUTCDay() && i.setUTCMonth(0, 1 + (4 - i.getUTCDay() + 7) % 7), _r_(1 + Math.ceil((s - i) / 6048e5));
}, i.exports = {
Calendar:n
}, _r_();
}), B.define("morphdom", function(t, e, i) {
_i_("4ab:6"), function(t) {
if (_i_("4ab:99"), "object" == typeof e && "undefined" != typeof i) i.exports = t(); else if ("function" == typeof define && define.amd) define([], t); else {
var n;
n = "undefined" != typeof window ? window :"undefined" != typeof global ? global :"undefined" != typeof self ? self :this, n.morphdom = t();
}
_r_();
}(function() {
_i_("4ab:98");
var t, e;
t = {
exports:e = {}
};
var i, n, s = "undefined" != typeof document ? document.body || document.createElement("div") :{}, a = "http://www.w3.org/1999/xhtml", r = 1, o = 3, _ = 8;
n = s.hasAttributeNS ? function(t, e, i) {
return _i_("4ab:443"), _r_(t.hasAttributeNS(e, i));
} :s.hasAttribute ? function(t, e, i) {
return _i_("4ab:468"), _r_(t.hasAttribute(i));
} :function(t, e, i) {
return _i_("4ab:469"), _r_(!!t.getAttributeNode(i));
};
function l(t) {
_i_("4ab:121");
for (var e in t) if (t.hasOwnProperty(e)) return _r_(!1);
return _r_(!0);
}
function h(t) {
_i_("4ab:122"), !i && document.createRange && (i = document.createRange(), i.selectNode(document.body));
var e;
return i && i.createContextualFragment ? e = i.createContextualFragment(t) :(e = document.createElement("body"), e.innerHTML = t), _r_(e.childNodes[0]);
}
var d = {
OPTION:function(t, e) {
_i_("4ab:444"), t.selected = e.selected, t.selected ? t.setAttribute("selected", "") :t.removeAttribute("selected", ""), _r_();
},
INPUT:function(t, e) {
_i_("4ab:445"), t.checked = e.checked, t.checked ? t.setAttribute("checked", "") :t.removeAttribute("checked"), t.value !== e.value && (t.value = e.value), n(e, null, "value") || t.removeAttribute("value"), t.disabled = e.disabled, t.disabled ? t.setAttribute("disabled", "") :t.removeAttribute("disabled"), _r_();
},
TEXTAREA:function(t, e) {
_i_("4ab:446");
var i = e.value;
t.value !== i && (t.value = i), t.firstChild && t.firstChild.nodeValue !== i && (t.firstChild.nodeValue = i), _r_();
}
};
function c() {}
var u = function(t, e) {
return _i_("4ab:430"), _r_(t.nodeName === e.nodeName && t.namespaceURI === e.namespaceURI);
};
function p(t, e) {
return _i_("4ab:124"), _r_(e && e !== a ? document.createElementNS(e, t) :document.createElement(t));
}
function f(t, e) {
_i_("4ab:125");
var i, s, a, r, o, _, l = e.attributes;
for (i = l.length - 1; i >= 0; i--) s = l[i], a = s.name, o = s.value, r = s.namespaceURI, r ? (a = s.localName || a, _ = t.getAttributeNS(r, a)) :_ = t.getAttribute(a), _ !== o && (r ? t.setAttributeNS(r, a, o) :t.setAttribute(a, o));
for (l = t.attributes, i = l.length - 1; i >= 0; i--) s = l[i], s.specified !== !1 && (a = s.name, r = s.namespaceURI, n(e, r, r ? a = s.localName || a :a) || t.removeAttributeNode(s));
_r_();
}
function b(t, e) {
_i_("4ab:126");
for (var i = t.firstChild; i; ) {
var n = i.nextSibling;
e.appendChild(i), i = n;
}
return _r_(e);
}
function g(t) {
return _i_("4ab:127"), _r_(t.id);
}
function m(t, e, i) {
if (_i_("4ab:128"), i || (i = {}), "string" == typeof e) if ("#document" === t.nodeName || "HTML" === t.nodeName) {
var n = e;
e = document.createElement("html"), e.innerHTML = n;
} else e = h(e);
var s = {}, a = {}, m = i.getNodeKey || g, v = i.onBeforeNodeAdded || c, y = i.onNodeAdded || c, M = i.onBeforeElUpdated || i.onBeforeMorphEl || c, B = i.onElUpdated || c, k = i.onBeforeNodeDiscarded || c, C = i.onNodeDiscarded || c, w = i.onBeforeElChildrenUpdated || i.onBeforeMorphElChildren || c, D = i.childrenOnly === !0, x = [];
function $(t, e) {
_i_("4ab:431");
var i = m(t);
if (i ? s[i] = t :e || C(t), t.nodeType === r) for (var n = t.firstChild; n; ) $(n, e || i), n = n.nextSibling;
_r_();
}
function E(t) {
if (_i_("4ab:432"), t.nodeType === r) for (var e = t.firstChild; e; ) m(e) || (C(e), E(e)), e = e.nextSibling;
_r_();
}
function S(t, e, i) {
if (_i_("4ab:433"), k(t) === !1) return _r_();
e.removeChild(t), i ? m(t) || (C(t), E(t)) :$(t), _r_();
}
function T(t, e, i, n) {
_i_("4ab:434");
var l = m(e);
if (l && delete s[l], !n) {
if (M(t, e) === !1) return _r_();
if (f(t, e), B(t), w(t, e) === !1) return _r_();
}
if ("TEXTAREA" !== t.nodeName) {
var h, c, p, b, g, k = e.firstChild, C = t.firstChild;
t:for (;k; ) {
for (p = k.nextSibling, h = m(k); C; ) {
var D = m(C);
if (c = C.nextSibling, !i && D && (g = a[D])) {
g.parentNode.replaceChild(C, g), T(C, g, i), C = c;
continue;
}
var $ = C.nodeType;
if ($ === k.nodeType) {
var E = !1;
if ($ === r ? (u(C, k) && (D || h ? h === D && (E = !0) :E = !0), E && T(C, k, i)) :($ === o || $ == _) && (E = !0, C.nodeValue = k.nodeValue), E) {
k = p, C = c;
continue t;
}
}
S(C, t, i), C = c;
}
h && ((b = s[h]) ? (T(b, k, !0), k = b) :a[h] = k), v(k) !== !1 && (t.appendChild(k), y(k)), k.nodeType === r && (h || k.firstChild) && x.push(k), k = p, C = c;
}
for (;C; ) c = C.nextSibling, S(C, t, i), C = c;
}
var N = d[t.nodeName];
N && N(t, e), _r_();
}
var N = t, A = N.nodeType, F = e.nodeType;
if (!D) if (A === r) F === r ? u(t, e) || (C(t), N = b(t, p(e.nodeName, e.namespaceURI))) :N = e; else if (A === o || A === _) {
if (F === A) return N.nodeValue = e.nodeValue, _r_(N);
N = e;
}
if (N === e) C(t); else {
T(N, e, !1, D);
var I = function(t) {
_i_("4ab:482");
for (var e = t.firstChild; e; ) {
var i = e.nextSibling, n = m(e);
if (n) {
var a = s[n];
if (a && u(e, a)) {
if (e.parentNode.replaceChild(a, e), T(a, e, !0), e = i, l(s)) return _r_(!1);
continue;
}
}
e.nodeType === r && I(e), e = i;
}
_r_();
};
if (!l(s)) t:for (;x.length; ) {
var j = x;
x = [];
for (var O = 0; O < j.length; O++) if (I(j[O]) === !1) break t;
}
for (var J in s) if (s.hasOwnProperty(J)) {
var L = s[J];
C(L), E(L);
}
}
return !D && N !== t && t.parentNode && t.parentNode.replaceChild(N, t), _r_(N);
}
return t.exports = m, _r_(t.exports);
}), _r_();
}), B.define("search/modules/flags", function(t, e, i) {
_i_("4ab:7");
function n(t) {
_i_("4ab:52");
var e = {};
if ("string" != typeof t) throw new TypeError("First argument must be a string");
if (t = t.trim(), "" === t) return _r_(e);
return t.split(/\s+/).forEach(function(t) {
_i_("4ab:129");
var i = t, n = !0, a = t.indexOf(":");
-1 !== a && (i = t.substr(0, a), n = t.substr(a + 1), n || (n = 0), s(n) && (n = parseInt(n, 10))), e[i] = n, _r_();
}), _r_(e);
}
function s(t) {
return _i_("4ab:53"), _r_(!isNaN(parseFloat(t)) && isFinite(t));
}
i.exports = {
parse:n
}, _r_();
}), B.define("search/modules/search-date", function(t, e, i) {
_i_("4ab:8");
var n = t("calendar-base").Calendar;
function s(t) {
_i_("4ab:54"), this.year = null, this.month = null, this.day = null, this.complete = !1, "number" == typeof t.year && (this.year = t.year), "number" == typeof t.month && (this.month = t.month), "number" == typeof t.day && (this.day = t.day), null !== this.month && (this.month < 0 ? this.month = 0 :this.month > 11 && (this.month = 11)), null !== this.day && (this.day < 0 ? this.day = 0 :this.day > a(this.year, this.month) && (this.day = a(this.year, this.month))), this.complete = null !== this.year && null !== this.month && null !== this.day, _r_();
}
s.prototype = {
toString:function() {
if (_i_("4ab:130"), !this.complete) return _r_("");
var t = this.month + 1;
return _r_(this.year + "-" + (10 > t ? "0" :"") + t + "-" + (this.day < 10 ? "0" :"") + this.day);
},
toNative:function() {
if (_i_("4ab:131"), !this.complete) return _r_(new Date(NaN));
return _r_(new Date(Date.UTC(this.year, this.month, this.day, 0, 0, 0, 0)));
},
valueOf:function() {
return _i_("4ab:132"), _r_(this.toNative().valueOf());
}
}, s.create = function(t) {
_i_("4ab:100");
var e;
if ("string" == typeof t && (e = t.split("-"), 3 == e.length && (t = {
year:parseInt(e[0], 10),
month:parseInt(e[1], 10) - 1,
day:parseInt(e[2], 10)
})), "object" != typeof t || null === t) throw new TypeError("date must be an object");
return _r_(new s(t));
}, s.createFromString = function(t) {
if (_i_("4ab:101"), "string" != typeof t) throw new TypeError("dateString must be a string");
var e = t.split(/-/g), i = {
year:parseInt(e[0], 10),
month:parseInt(e[1], 10) - 1,
day:parseInt(e[2], 10)
};
return _r_(s.create(i));
}, s.createFlexible = function(t) {
if (_i_("4ab:102"), "object" != typeof t || null === t) throw new TypeError("date must be an object");
if ("number" != typeof t.year || "number" != typeof t.month || "number" != typeof t.day) throw new TypeError("invalid date");
var e = new Date(Date.UTC(t.year, t.month, t.day, 0, 0, 0, 0));
return t = {
year:e.getUTCFullYear(),
month:e.getUTCMonth(),
day:e.getUTCDate()
}, _r_(s.create(t));
}, s.isStrictlyValid = function(t) {
_i_("4ab:103");
var e = s.create(t);
return _r_(t.year === e.year && t.month === e.month && t.day === e.day);
}, s.compare = function(t, e) {
if (_i_("4ab:104"), !(t instanceof s && e instanceof s)) throw new TypeError("dates must be an instance of SearchDate");
if (t.year < e.year) return _r_(-1);
if (t.year > e.year) return _r_(1);
if (t.month < e.month) return _r_(-1);
if (t.month > e.month) return _r_(1);
if (t.day < e.day) return _r_(-1);
if (t.day > e.day) return _r_(1);
return _r_(0);
};
function a(t, e) {
return _i_("4ab:55"), _r_("number" == typeof t && "number" == typeof e ? n.daysInMonth(t, e) :3 == e || 5 == e || 8 == e || 10 == e ? 30 :1 == e ? 29 :31);
}
i.exports = {
SearchDate:s
}, _r_();
}), B.define("component/autocomplete-core", function(t, e, i) {
_i_("4ab:9");
var n = t("jquery"), s = t("component"), a = t("read-data-options");
i.exports = s.extend({
init:function() {
_i_("4ab:228"), this.highlightedIndex = -1, this.isDeletion = !1, this.items = [], this.keyDownCount = 0, this.keysDown = {}, this.listHeight = 0, this.listVisible = !1, this.preventBlurClose = !1, this.selectedIndex = -1, this.selectedValue = null, this.valueBuffer = null, this.clickOutController = t("click-out"), this.clickOutMonitorId = null, this.$input = this.$el.find('[data-input=""]'), this.input = this.$input[0], this.$list = this.$el.find('[data-list=""]'), this.$items = this.$list.children(), this.optionsSpec = this.optionsSpec || {}, this.optionsSpec = n.extend(this.optionsSpec, {
openFocus:{
name:"open-focus",
type:Boolean
},
highlightFirst:{
name:"highlight-first",
type:Boolean
}
}), this.options = a(this.$el, this.optionsSpec), this.supportsInputEvent = this.input && "oninput" in this.input, this.addInputEventListeners(), this.addListEventListeners(), this.addItemsEventListeners(), this.calculateListHeight(), this.$input.attr("autocomplete", "off"), _r_();
},
addInputEventListeners:function() {
_i_("4ab:229");
var t = this.$input.component("keyboard");
t.on("keydown:Escape", this.inputEscape.bind(this)), t.on("keydown:ArrowUp", this.inputArrowUp.bind(this)), t.on("keydown:ArrowDown", this.inputArrowDown.bind(this)), t.on("keydown:Enter", this.inputEnter.bind(this)), t.on("keydown:Tab", this.inputTab.bind(this)), this.$input.on("click", this.inputClick.bind(this)), this.$input.focus(this.inputFocus.bind(this)), this.$input.blur(this.inputBlur.bind(this)), this.$input.keydown(this.inputKeyDown.bind(this)), this.$input.bind("input", this.inputInput.bind(this)), this.$input.keyup(this.inputKeyUp.bind(this)), _r_();
},
addListEventListeners:function() {
_i_("4ab:230"), this.$list.mousedown(this.listMouseDown.bind(this)), this.$list.mouseup(this.listMouseUp.bind(this)), this.$list.on("click", '[data-list-item=""]', this.listItemClick.bind(this)), _r_();
},
addItemsEventListeners:function() {
_i_("4ab:231"), this.$items.click(this.listItemClick.bind(this)), _r_();
},
addClickOutEventListener:function() {
_i_("4ab:232"), this.clickOutMonitorId = this.clickOutController.addMonitor(this.el, this.clickOut.bind(this)), _r_();
},
removeClickOutEventListener:function() {
_i_("4ab:233"), this.clickOutController.removeMonitor(this.clickOutMonitorId), _r_();
},
calculateListHeight:function() {
_i_("4ab:234"), this.listHeight = this.$list.outerHeight(), _r_();
},
inputClick:function(t) {},
inputFocus:function(t) {
_i_("4ab:236"), this.options.openFocus && (this.listShow(), this.autocomplete({
fromFocus:!0
})), _r_();
},
inputBlur:function(t) {
_i_("4ab:237"), setTimeout(this.inputBlurSync.bind(this), 4), _r_();
},
inputBlurSync:function() {
_i_("4ab:238"), !this.preventBlurClose && this.listVisible && (this.highlightReset(), this.reset()), _r_();
},
inputKeyDown:function(t) {
_i_("4ab:239");
var e = t.ctrlKey || t.metaKey || t.shiftKey || t.altKey, i = 8 == t.which || 46 == t.which;
this.isDeletion = i, this.taintedKeyDown = e, _r_();
},
inputInput:function(t) {
_i_("4ab:240"), this.autocomplete(), _r_();
},
inputKeyUp:function(t) {
_i_("4ab:241");
var e = this.taintedKeyDown || t.ctrlKey || t.metaKey || t.shiftKey || t.altKey || t.which >= 16 && t.which <= 18 || 91 == t.which, i = 32 == t.which || t.which >= 48, n = t.which >= 37 && t.which <= 40;
e || ((n || i) && this.listShow(), !this.isDeletion && !i || this.supportsInputEvent || this.autocomplete(), i && this.keyDownCount++), _r_();
},
inputEscape:function(t) {
_i_("4ab:242"), this.listVisible && (t.originalEvent.preventDefault(), this.highlightReset(), this.reset()), _r_();
},
inputArrowUp:function(t) {
_i_("4ab:243"), t.originalEvent.preventDefault(), this.listVisible ? this.highlightPrevious() :this.listShow(), _r_();
},
inputArrowDown:function(t) {
_i_("4ab:244"), t.originalEvent.preventDefault(), this.listVisible ? this.highlightNext() :this.listShow(), _r_();
},
inputEnter:function(t) {
_i_("4ab:245"), this.listVisible && -1 != this.highlightedIndex && (t.originalEvent.preventDefault(), this.choose(this.highlightedIndex)), _r_();
},
inputTab:function(t) {
_i_("4ab:246"), this.inputEnter.apply(this, arguments), _r_();
},
listItemClick:function(t) {
_i_("4ab:247");
var e = n(t.currentTarget);
this.choose(e.data("i")), _r_();
},
listMouseDown:function(t) {
_i_("4ab:248"), this.preventBlurClose = !0, _r_();
},
listMouseUp:function(t) {
_i_("4ab:249"), this.preventBlurClose = !1, _r_();
},
clickOut:function() {
_i_("4ab:250"), this.listVisible && (this.highlightReset(), this.reset()), _r_();
},
setValue:function(t) {
_i_("4ab:251"), this.input.value = t, _r_();
},
listShow:function() {
_i_("4ab:252"), this.listVisible || this._loading || (this.$list.addClass("-visible"), this.listVisible = !0, this.addClickOutEventListener(), this.$list[0].scrollTop = 1, setTimeout(function() {
_i_("4ab:522"), this.$list[0].scrollTop = 0, _r_();
}.bind(this), 10)), _r_();
},
listHide:function() {
_i_("4ab:253"), this.listVisible && (this.$list.removeClass("-visible"), this.resetFlags(), this.removeClickOutEventListener()), _r_();
},
highlightPrevious:function() {
_i_("4ab:254");
var t = this.highlightedIndex;
do -1 == t ? t = this.items.length - 1 :t--; while (-1 != t && this.items[t].hidden);
this.highlightFromNavigation(t), _r_();
},
highlightNext:function() {
_i_("4ab:255");
var t = this.highlightedIndex;
do t == this.items.length - 1 ? t = -1 :t++; while (-1 != t && this.items[t].hidden);
this.highlightFromNavigation(t), _r_();
},
highlightFromNavigation:function(t, e, i) {
if (_i_("4ab:256"), (-1 == this.highlightedIndex || e) && (this.valueBuffer = this.input.value), -1 == t) this.highlightReset({
preserveFocus:!0
}); else if (this.supportsInputEvent) if (this.valueBuffer && 0 == this.items[t].valueLowerCase.indexOf(this.valueBuffer.toLowerCase())) {
var n = this.valueBuffer.length, s = this.items[t].value.length, a = this.valueBuffer + this.items[t].value.substring(n);
if (this.input.value == a || i || this.setValue(a), this.input.setSelectionRange) this.input.setSelectionRange(s, s); else if (this.input.createTextRange) {
var r = this.input.createTextRange();
r.collapse(!0), r.moveStart("character", n), r.moveEnd("character", s), r.select();
} else void 0 !== this.input.selectionStart && (this.input.selectionStart = n, this.input.selectionEnd = s);
} else this.setValue(this.items[t].value), this.fixIEFocusLoss();
this.highlight(t), _r_();
},
highlightFromAutocomplete:function() {
_i_("4ab:257");
var t = this.input.value, e = this.getListFirstIndex();
-1 !== e && this.options.highlightFirst && !this.isDeletion && t && 0 === this.items[e].valueLowerCase.indexOf(t.toLowerCase()) ? this.highlightFromNavigation(e, !0) :this.highlight(-1), _r_();
},
highlight:function(t) {
_i_("4ab:258"), this.listShow(), -1 != this.highlightedIndex && this.$items.eq(this.highlightedIndex).removeClass("-highlighted"), -1 != t && this.$items.eq(t).addClass("-highlighted"), this.highlightedIndex = t, this.highlightScroll(), _r_();
},
highlightReset:function(t) {
_i_("4ab:259"), t = t || {}, null === this.valueBuffer || t.preserveInputValue || (this.setValue(this.valueBuffer), t.preserveFocus && this.fixIEFocusLoss()), -1 != this.highlightedIndex && this.$items.eq(this.highlightedIndex).removeClass("-highlighted"), this.highlightedIndex = -1, _r_();
},
highlightScroll:function() {
_i_("4ab:260");
var t = !1, e = this.$list[0].scrollTop;
if (-1 != this.highlightedIndex) {
var i = this.$items.eq(this.highlightedIndex), n = (1 == i.length && i.position().top) + e, s = i.outerHeight();
n + s > this.listHeight + e ? t = n + s - this.listHeight :e > n && (t = n);
} else t = 0;
t !== !1 && t != e && (this.$list[0].scrollTop = t), _r_();
},
getListLength:function() {
return _i_("4ab:261"), _r_(this.items.length);
},
getListFirstIndex:function() {
return _i_("4ab:262"), _r_(0 === this.items.length ? -1 :0);
},
autocomplete:function() {
_i_("4ab:263"), this.postAutocomplete(), _r_();
},
postAutocomplete:function() {
_i_("4ab:264"), 0 === this.getListLength() ? this.listHide() :(this.listShow(), this.calculateListHeight(), this.highlightFromAutocomplete()), _r_();
},
choose:function(t) {
_i_("4ab:265"), this.selectedIndex = t, this.selectedValue = this.items[t].value, this.setValue(this.selectedValue), this.reset(), _r_();
},
reset:function(t) {
_i_("4ab:266"), t = t || {}, -1 != this.highlightedIndex && this.$items.eq(this.highlightedIndex).removeClass("-highlighted"), this.listHide(), t.hard && (this.resetFlags(), this.selectedIndex = -1, this.selectedValue = null, this.setValue("")), _r_();
},
resetFlags:function() {
_i_("4ab:267"), this.highlightedIndex = -1, this.isDeletion = !1, this.keyDownCount = 0, this.keysDown = {}, this.listVisible = !1, this.preventBlurClose = !1, this.valueBuffer = null, _r_();
},
fixIEFocusLoss:function() {
if (_i_("4ab:268"), this.input.createTextRange) {
var t = this.input.createTextRange();
t.moveStart("character", this.input.value.length), t.collapse(), t.select();
}
_r_();
}
}), _r_();
}), B.define("component/core/input-placeholder", function(t, e, i) {
"use strict";
_i_("4ab:10");
var n = t("component"), s = t("read-data-options");
return _r_(n.extend({
init:function() {
if (_i_("4ab:133"), this.browserSupported()) return _r_();
this.options = s(this.$el, {
placeholderClass:{
name:"placeholder-class",
type:String
},
placeholderColor:{
name:"placeholder-color",
type:String,
defaultValue:"#7C90A6"
}
});
var t = "input, textarea", e = this.$el.find(t);
this.$el.is(t) && (e = e.add(this.$el)), e.filter(function(t, e) {
return _i_("4ab:484"), _r_(!!$(e).attr("placeholder"));
}).each(function(t, e) {
_i_("4ab:483"), this.setupPlaceholder($(e)), _r_();
}.bind(this)), _r_();
},
browserSupported:function() {
_i_("4ab:134");
var t = $('input[type="text"]')[0] || $('<input type="text">')[0];
return _r_(!!("placeholder" in t));
},
setupPlaceholder:function(t) {
_i_("4ab:135");
var e = $("<label />").text(t.attr("placeholder")).css({
width:t.width() + "px",
height:t.height() + "px",
paddingTop:t.css("padding-top"),
paddingLeft:t.css("padding-left"),
paddingRight:t.css("padding-right"),
fontFamily:t.css("font-family"),
fontSize:t.css("font-size"),
color:this.options.placeholderColor,
overflow:"hidden",
cursor:"text",
position:"absolute"
});
this.options.placeholderClass && e.addClass(this.options.placeholderClass), e.insertBefore(t), e.click(function() {
_i_("4ab:447"), t.focus(), _r_();
}), t.focus(function() {
_i_("4ab:485"), e.hide(), _r_();
}).blur(function() {
_i_("4ab:448"), e[t.val().length ? "hide" :"show"](), _r_();
}), t.get(0) === document.activeElement ? t.triggerHandler("focus") :t.triggerHandler("blur"), _r_();
}
}));
}), B.define("component/keyboard", function(t, e, i) {
_i_("4ab:11");
var n = t("component"), s = t("event-emitter"), a = {
8:"Backspace",
46:"Delete",
9:"Tab",
13:"Enter",
32:"Space",
27:"Escape",
33:"PageUp",
34:"PageDown",
35:"End",
36:"Home",
37:"ArrowLeft",
38:"ArrowUp",
39:"ArrowRight",
40:"ArrowDown",
48:"0",
49:"1",
50:"2",
51:"3",
52:"4",
53:"5",
54:"6",
55:"7",
56:"8",
57:"9",
65:"A",
66:"B",
67:"C",
68:"D",
69:"E",
70:"F",
71:"G",
72:"H",
73:"I",
74:"J",
75:"K",
76:"L",
77:"M",
78:"N",
79:"O",
80:"P",
81:"Q",
82:"R",
83:"S",
84:"T",
85:"U",
86:"V",
87:"W",
88:"X",
89:"Y",
90:"Z"
};
function r(t, e) {
return _i_("4ab:56"), _r_(function(i) {
_i_("4ab:110");
var n = "";
i.which && void 0 !== a[i.which.toString()] && (i.originalEvent.altKey && (n += ":alt"), i.originalEvent.ctrlKey && (n += ":ctrl"), i.originalEvent.metaKey && (n += ":meta"), i.originalEvent.shiftKey && (n += ":shift"), n += ":" + a[i.which], t.trigger(e + n, {
keys:e + n,
originalEvent:i
})), _r_();
});
}
i.exports = n.extend({
init:function() {
_i_("4ab:269"), s.extend(this), this.$el.bind("keydown", r(this, "keydown")).bind("keyup", r(this, "keyup")), _r_();
}
}), _r_();
}), B.define("component/tooltip-loc", function(t, e, i) {
"use strict";
_i_("4ab:12");
var n = t("component"), s = t("jquery");
i.exports = n.extend({
DEFAULTS:{
template:'<div class="component-tooltip off" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
placement:"top",
alignment:"center",
trigger:"hover focus",
animation:"true"
},
init:function() {
_i_("4ab:270"), this._buildOptions(), this._createTooltip(), this._attachEvents(), this.$el.trigger("ready.B.tooltip", [ this.$tip ]), _r_();
},
_buildOptions:function() {
_i_("4ab:271"), this.options = s.extend({}, this.DEFAULTS, this.$el.data()), this.options.intangible = "intangible" in this.options, this.options.target && (this.options.target = s(this.options.target).first()), this.options.content || (this.options.content = this.options.title || this.el.title), _r_();
},
_createTooltip:function() {
_i_("4ab:272");
var t = "tooltip-" + this.options.placement + " tooltip-align-" + this.options.alignment;
this.options.extraClass && (t = t + " " + this.options.extraClass), "true" === this.options.animation && (t += " tooltip-animate"), this.$tip = s(this.options.template), this.$tip.addClass(t), this._attachContent(), this.$tip.appendTo(s("body")), this.$el.trigger("inserted.B.tooltip", [ this.$tip ]), _r_();
},
_attachContent:function() {
_i_("4ab:273");
var t = this.$tip.find(".tooltip-inner");
this.options.target ? t.append(this.options.target.clone()) :(this.options.target = [], t.text(this.options.content)), _r_();
},
_positionTooltip:function() {
_i_("4ab:274"), this._defineAlignmentVars(), this._placeTooltip(), this._alignTooltip(), this.$tip.css({
left:this.left,
top:this.top
}), _r_();
},
_defineAlignmentVars:function() {
_i_("4ab:275"), this.elOffset = this.$el.offset(), this.position = "left", this.dimension = "outerWidth", this.options.placement.match(/top|bottom/) && (this.position = "top", this.dimension = "outerHeight"), _r_();
},
_accountForRTL:function(t) {
if (_i_("4ab:276"), !B.env.rtl) return _r_(t);
if ("left" === t) return _r_("right");
if ("right" === t) return _r_("left");
return _r_(t);
},
_placeTooltip:function() {
_i_("4ab:277");
var t = this._accountForRTL(this.position), e = this.dimension;
this._accountForRTL(this.options.placement) === t ? this[t] = this.elOffset[t] - this.$tip[e]() :this[t] = this.elOffset[t] + this.$el[e](), _r_();
},
_alignTooltip:function() {
_i_("4ab:278");
var t, e;
switch ("left" === this.position ? (t = "top", e = "outerHeight") :(t = "left", e = "outerWidth"), this._accountForRTL(this.options.alignment)) {
case t:
this[t] = this.elOffset[t];
break;

case "center":
this[t] = this.$el[e]() / 2 + this.elOffset[t] - this.$tip[e]() / 2;
break;

default:
this[t] = this.elOffset[t] + this.$el[e]() - this.$tip[e]();
}
_r_();
},
_attachEvents:function() {
if (_i_("4ab:279"), this.options.trigger.match(/manual/)) return _r_();
var t, e, i, n = this.options.trigger.split(" "), a = n.length, r = this.$el.add(this.$tip);
for (this.options.intangible && (r = this.$el), a; a--; ) t = n[a], "click" === t ? this.$el.on("click", s.proxy(this.toggle, this)) :(e = "hover" == t ? "mouseenter" :"focusin", i = "hover" == t ? "mouseleave" :"focusout", r.on(e, s.proxy(this.show, this)), r.on(i, s.proxy(this.hide, this)));
_r_();
},
_trackTransitionEnd:function(t) {
_i_("4ab:280");
var e = this.$el;
this.$tip.one("transitionend", function(i) {
_i_("4ab:470"), e.trigger(t, [ this ]), _r_();
}), _r_();
},
show:function() {
_i_("4ab:281"), this.$el.trigger("show.B.tooltip", [ this.$tip ]), this._trackTransitionEnd("shown.B.tooltip"), this.$el.attr("aria-describedby", this.el.id), this._positionTooltip(), this.$tip.addClass("on").removeClass("off"), _r_();
},
hide:function() {
_i_("4ab:282"), this.$el.trigger("hide.B.tooltip", [ this.$tip ]), this._trackTransitionEnd("hidden.B.tooltip"), this.$el.removeAttr("aria-describedby"), this.$tip.removeClass("on").addClass("off"), _r_();
},
toggle:function() {
_i_("4ab:283"), this.$tip.is(".on") ? this.hide() :this.show(), _r_();
}
}), _r_();
}), B.define("component/search/destination/input-placeholder", function(t, e, i) {
_i_("4ab:13");
var n = B.require("component/core/input-placeholder"), s = t("search/searchbox/model");
return _r_(n.extend({
init:function() {
_i_("4ab:136"), this.model = s.getInstance(this.$el.data("sb-id")), n.prototype.init.apply(this, arguments), _r_();
}
}));
}), B.define("component/search/destination/input", function(t, e, i) {
"use strict";
_i_("4ab:14"), booking.jstmpl("search_destination_autocomplete_results", function() {
_i_("4ab:111");
var t = [ "\n		", "\n\n	", "\n	", "\n\n		\n\n		", '\n			<li\n				class="', "c-autocomplete__item sb-autocomplete__item ", "sb-autocomplete__item--cjk ", '"\n				>\n				<div class="sb-autocomplete__section-title-wrapper">\n					<div class="sb-autocomplete__section-title">\n						', '\n							<i class="bicon bicon-', '"></i>\n						', "\n						<span>", "</span>\n					</div>\n				</div>\n			</li>\n		", '\n		<li\n			class="', "c-autocomplete__item sb-autocomplete__item sb-autocomplete__item-with_photo ", "sb-autocomplete__item-from_history ", "sb-autocomplete__item--airport ", "sb-autocomplete__item--city ", "sb-autocomplete__item--country ", "sb-autocomplete__item--district ", "sb-autocomplete__item--hotel ", "sb-autocomplete__item--landmark ", "sb-autocomplete__item--region ", "sb-autocomplete__item--theme ", "sb-autocomplete__item__item--elipsis ", "sb-autocomplete__item--with-title ", "sb-autocomplete__item--with-two-lines ", "sb-autocomplete__item--regioncity ", "sb-autocomplete__item--theme-expanded ", "first_theme ", "1", "smaller_theme_wrapper ", '"\n			role="option"\n			data-list-item\n			data-i="', '"\n			data-value="', '"\n			', '\n				data-label="', "\n			\n			", '\n			    data-et-mouseenter="customGoal:', ':1"\n			    data-et-click="customGoal:', ':2"\n			', "\n			\n			>", "", '<img alt="', '" src="', '" class="sb-autocomplete--photo">', '<div class="', "sb_passion_highlight_wrapper smaller_theme ", '">\n						<p class="sb_passion_highlight_inner">', '<i class="', "sb_passion_icon dficon-", " ", '">\n									</i>\n								<strong class="', "sb_passion_highlight_heading ", '">', "</strong>\n						</p>\n					</div>", '<span class="sb-autocomplete__item__highlight">', "</span>", '<span class="sb-autocomplete__item__extra">', '<span class="searchbox__region__subcity__item">', ",", '<span class="sb-autocomplete__badge sb-autocomplete__badge--popular">', "/private/search_top_50_badge/name", '<span class="sb-autocomplete__badge sb-autocomplete__badge--skiarea">\n							-\n							<i class="bicon-skiing"></i>', "/private/geo_desktop_index_sbox_ski_area_label/name", "</li>\n	", '\n		<li class="sb-autocomplete__google"></li>\n	', "\n" ], e = [ "total_index", "results", "lc", "section_title_icon", "section_title", "flags", "dest_type", "search_config", "group_config", "is_first_theme", "index", "value", "label", "photo_uri", "dest_id", "label_blocks", "highlighted", "text", "label_highlighted", "additional_label", "b_region_city_endorsements", "is_powered_by_google" ];
return _r_(function(i) {
_i_("4ab:435");
var n = "", s = this.fn;
function a(n) {
if (_i_("4ab:449"), s.MD(e[1])) {
n += t[1], s.MN("index", 0), n += t[2], s.MN(e[0], s.MI(s.array_length(s.MB(e[1]))) - s.MI(1)), n += t[1];
var a = s.MC(e[1]) || [];
i.unshift(null);
for (var r = 1, o = a.length; o >= r; r++) {
if (i[0] = a[r - 1], n += t[3], s.MJ(s.MB(e[4])) && (n += t[4], n += t[5], s.MJ(/zh|xt|ja|ko/.test(s.MB(e[2]))) && (n += t[6]), n += t[7], s.MD(e[3]) && (n += [ t[8], s.MC(e[3]), t[9] ].join("")), n += [ t[10], s.MC(e[4]), t[11] ].join("")), n += t[12], n += t[13], s.MJ(s.MG((s.MC(e[5]) || {}).history)) && (n += t[14]), s.MJ(/zh|xt|ja|ko/.test(s.MB(e[2]))) && (n += t[6]), n += s.MJ(s.MB(e[6]) + "" == "airport") ? t[15] :s.MJ(s.MB(e[6]) + "" == "city") ? t[16] :s.MJ(s.MB(e[6]) + "" == "country") ? t[17] :s.MJ(s.MB(e[6]) + "" == "district") ? t[18] :s.MJ(s.MB(e[6]) + "" == "hotel") ? t[19] :s.MJ(s.MB(e[6]) + "" == "landmark") ? t[20] :s.MJ(s.MB(e[6]) + "" == "region") ? t[21] :s.MJ(s.MB(e[6]) + "" == "theme") ? t[22] :t[17], n += t[23], s.MD(e[4]) && (n += t[24]), s.MJ(s.MB(e[7])) && s.MJ(s.MB(e[8])) && (n += t[25]), s.MJ(s.MB(e[5])) && s.MJ(s.MC(e[5]).is_region_city) && (n += t[26]), s.MJ(s.MB(e[6]) + "" == "theme") && (n += t[27], s.MD(e[9]) || (n += t[28], s.MN(e[9], t[29])), n += t[30]), n += [ t[31], s.MC(e[10]), t[32], s.F.entities(s.MC(e[11])), t[33] ].join(""), s.MD(e[12]) && (n += [ t[34], s.F.html(s.MC(e[12])), t[33] ].join("")), n += t[35], s.MJ(s.MB(e[5])) && s.MJ(s.MC(e[5]).ski_destination) && s.MJ(s.track_experiment("HMDEDRNQVSfCSRBJBBfOUC")) && (n += [ t[36], "HMDEDRNQVSfCSRBJBBfOUC", t[37], "HMDEDRNQVSfCSRBJBBfOUC", t[38] ].join("")), n += t[39], n += t[40], s.MJ(s.MB(e[13])) && (n += [ t[41], s.F.html(s.MC(e[12])), t[42], s.STATIC_HOSTNAME(s.MB(e[13]), 0, 0, 0), t[43] ].join("")), n += t[40], s.MJ(s.MB(e[6]) + "" == "theme")) n += t[44], n += t[45], n += t[46], s.MJ(s.track_experiment("YQecfDZaAcYcVMKIfLKIITOJIPeDBFEO")) ? n += t[40] :(n += t[47], n += [ t[48], s.F.entities(s.MC(e[14])), t[49] ].join(""), n += t[50], n += t[51], n += t[52]), n += [ t[40], s.F.entities(s.MC(e[12])), t[53] ].join(""); else {
if (n += t[40], s.MD(e[15])) {
n += t[40];
var _ = r, l = a, h = o, a = s.MC(e[15]) || [];
i.unshift(null);
for (var r = 1, o = a.length; o >= r; r++) i[0] = a[r - 1], n += t[40], s.MD(e[16]) && (n += t[54]), n += [ t[40], s.F.entities(s.MC(e[17])), t[40] ].join(""), s.MD(e[16]) && (n += t[55]), n += t[40];
i.shift(), r = _, a = l, o = h, n += t[40];
} else s.MD(e[18]) ? n += [ t[40], s.MC(e[18]), t[40] ].join("") :s.MD(e[12]) && (n += [ t[40], s.F.entities(s.MC(e[12])), t[40] ].join(""));
if (n += t[40], s.MD(e[19]) && (n += [ t[56], s.MC(e[19]), t[55] ].join("")), n += t[40], s.MD(e[20])) {
n += t[40];
var _ = r, l = a, h = o, d = c, a = s.MC(e[20]) || [];
i.unshift({
endorsement:null
});
for (var c, r = 1, o = a.length; o >= r; r++) i[0].endorsement = c = a[r - 1], n += [ t[57], c ].join(""), s.MJ(r != a.length) && (n += t[58]), n += t[55];
i.shift(), r = _, a = l, o = h, c = d, n += t[40];
}
n += t[40], s.MJ(s.MC(e[5]).popular) ? n += [ t[59], s.F.entities(s.ME(t[60], s.MB, s.MN, null)), t[55] ].join("") :s.MJ(s.MC(e[5]).ski_destination) && s.MJ(2 == s.track_experiment("HMDEDRNQVSfCSRBJBBfOUC")) && (n += [ t[61], s.F.entities(s.ME(t[62], s.MB, s.MN, null)), t[55] ].join("")), n += t[40];
}
n += t[40], s.MN("index", s.MI(s.MB(e[10])) + s.MI(1)), n += t[40], n += t[63];
}
i.shift(), n += t[1], s.MD(e[21]) && (n += t[64]), n += t[65];
}
return n += t[65], _r_(n);
}
return n += t[0], n = a(n), n += t[2], _r_(n);
});
}()), booking.jstmpl("search_destination_autocomplete_loading", function() {
_i_("4ab:112");
var t = [ "\n		", '\n\n<ul class="c-autocomplete__list sb-autocomplete__list sb-autocomplete__list--loading">\n	', '\n		<li class="c-autocomplete__item sb-autocomplete__item sb-autocomplete__item--city">\n			', '\n				<span class="sb-autocomplete__item-placeholder-text js-placeholder-text"></span>\n			', "\n		</li>\n	", "\n</ul>\n", "\n	" ], e = [ "fe_sb_autocomplete_loading_items" ];
return _r_(function(i) {
_i_("4ab:436");
var n = "", s = this.fn;
function a(n) {
_i_("4ab:450"), s.MN("fe_sb_autocomplete_loading_items", 5), n += t[1];
var a = s.seq(1, s.MB(e[0])) || [];
i.unshift(null);
for (var r = 1, o = a.length; o >= r; r++) {
i[0] = a[r - 1], n += t[2];
var _ = r, l = a, h = o, a = s.seq(1, 3) || [];
i.unshift(null);
for (var r = 1, o = a.length; o >= r; r++) i[0] = a[r - 1], n += t[3];
i.shift(), r = _, a = l, o = h, n += t[4];
}
return i.shift(), n += t[5], _r_(n);
}
return n += t[0], n = a(n), n += t[6], _r_(n);
});
}());
var n = t("component/autocomplete-core"), s = t("search/searchbox/model"), a = t("search/searchbox/analytics"), r = t("et");
i.exports = n.extend({
init:function() {
_i_("4ab:284"), this.optionsSpec = {
delay:{
name:"delay",
type:Number,
defaultValue:300
},
modelId:{
name:"sb-id",
type:String,
required:!0
},
filterDestType:{
name:"filter-dest-type",
type:String
},
gpf:{
name:"gpf",
type:Boolean
},
gpOnly:{
name:"gp-only",
type:Boolean
},
minLength:{
name:"minlength",
type:Number,
defaultValue:2
},
focusOnLoad:{
name:"focus-on-load",
type:Boolean
},
focusOnTyping:{
name:"focus-on-typing",
type:Boolean
},
isSticky:{
name:"is-sticky",
type:Boolean
},
required:{
name:"required",
type:Boolean
},
flags:{
name:"flags",
type:String,
defaultValue:""
}
}, $.extend(this.optionsSpec, this.extendOptions()), this.$errors = this.$el.find("[data-error-id]"), this.$clear = this.$el.find('[data-clear=""]'), this.$searchbox = this.$el.closest(".sb-searchbox__outer"), this.$clrBtn = $(".sb-searchbox_input__clear_active + .input_clear_button"), n.prototype.init.apply(this, arguments), this.model = s.getInstance(this.options.modelId), this.model.use("destination"), this.model.use("dates"), this.model.updateFlags(this.options.flags), this.inputUntouched = !0, this.model.on("change", this.modelChange.bind(this)), this.model.on("validation", this.modelValidation.bind(this)), this.options.required && this.model.destination.configure({
validate:!0
}), this.options.gpOnly && this.model.destination.configurePredictions({
gpo:1
}), this.options.gpf && this.model.destination.configure({
gpf:1
}), this.options.filterDestType && this.model.destination.configurePredictions({
dest_type:this.options.filterDestType
}), this.options.focusOnLoad && this.focusOnLoad(), this.options.focusOnTyping && this.options.isSticky && (this.stickyController = t("search/searchbox/searchbox-sticky-controller").getController()), this.model.getFlag("track_focus_on_typing_stages") && this.enableFocusOnTyping(), this.$errors.filter(".-visible").length && (this.model.destination.valid = !1), this.templateResults = B.jstmpl("search_destination_autocomplete_results"), this.toggleClear(), this.modelInit(), this.renderLoadingElement(), _r_();
},
addInputEventListeners:function() {
_i_("4ab:285"), n.prototype.addInputEventListeners.apply(this, arguments), this.$clear.length && this.$clear.on("click", this.clearClick.bind(this)), this.$clrBtn && this.$clrBtn.length && (this.clearButtonCheck(this.$input.val()), this.$clrBtn.click($.proxy(function() {
_i_("4ab:512"), B.et.customGoal("VKcAESfPMZCfPESHBZC", 1), this.setValue(""), this.inputInput(), _r_();
}, this))), _r_();
},
renderLoadingElement:function() {
_i_("4ab:286"), this.shouldShowLoadingState = !0;
var t = {};
this.$loading = $(B.jstmpl("search_destination_autocomplete_loading").render(t)), this.$loading.find(".js-placeholder-text").each(function() {
_i_("4ab:471"), $(this).width(65 + parseInt(65 * Math.random(), 10)), _r_();
}), this.$loading.insertAfter(this.$list), _r_();
},
showLoading:function() {
_i_("4ab:287"), this.shouldShowLoadingState && (n.prototype.listHide.apply(this), this.$loading.addClass("-visible")), _r_();
},
hideLoading:function() {
_i_("4ab:288"), this.shouldShowLoadingState && this.$loading.removeClass("-visible"), _r_();
},
modelInit:function() {
_i_("4ab:289");
var t = {
ss:this.input.value
};
this.model.destination.init(t), _r_();
},
modelChange:function(t) {
if (_i_("4ab:290"), t && t.group && "destination" == t.group) {
var e = this.model.destination.get();
e.ss == this.input.value || this.isDeletion || this.setValue(e.ss), t.onlyCurrentCountry && (this.$input.focus(), this.autocomplete()), B.env.b_is_bbtool_user && B.et.customGoal("VObLMEKKTVeBKeYEGWe", 3), this.inputUntouched = !1;
}
_r_();
},
modelValidation:function(t) {
_i_("4ab:291"), t && "destination" == t.group && (this.$errors.filter(".-visible").removeClass("-visible"), this.model.destination.valid ? this.model.getFlag("adUAKYSfHPSeGEVSPDbbTXUAJKe") && (this.model.setFormAction(""), this.model.emit("change", {
group:""
})) :(r.stage("adUAKYSfHPSeGEVSPDbbTXUAJKe", 1), this.model.getFlag("adUAKYSfHPSeGEVSPDbbTXUAJKe") ? (this.model.setFormAction("/destinationrecommendations.html"), this.model.setFields("drec_traffic", [ {
name:"dr_source",
value:"sb_no_dest"
} ]), this.model.emit("change", {
group:""
}), this.model.destination.emptyValid = !0, this.model.destination.valid = !0, this.model.submit()) :(this.$el.find("#destination__error").addClass("-visible"), this.$errors.filter('[data-error-id="' + this.model.destination.validationError + '"]').addClass("-visible"), a.send("[error] destination: " + this.model.destination.validationError)))), _r_();
},
inputClick:function() {
_i_("4ab:292"), ("" === this.input.value || this.inputUntouched) && this.model.getFlag("on_click_suggestions") && this.showSuggestions(), "" !== this.input.value && "undefined" != typeof this.model.getFlag("clear_input_on_click") && (B.et.stage("AEJPOAJeKZBeNfRJVYaGDTC", 1), "index" === B.env.b_action && B.et.stage("AEJPOAJeKZBeNfRJVYaGDTC", 2), "searchresults" === B.env.b_action && B.et.stage("AEJPOAJeKZBeNfRJVYaGDTC", 3)), this.input.value.length > 0 && this.model.getFlag("clear_input_on_click") && (this.$input.data("cached-value", this.input.value), this.input.value = ""), n.prototype.inputClick.apply(this, arguments), _r_();
},
clearButtonCheck:function(t) {
_i_("4ab:293"), this.$clrBtn && this.$clrBtn.length && (t.length > 0 ? this.$clrBtn.addClass("input_clear_button__active") :this.$clrBtn.removeClass("input_clear_button__active")), _r_();
},
inputInput:function() {
_i_("4ab:294"), this.isVisibleCalendar() && this.hideCalendar(), this.model.destination.setSearchString(this.input.value), this.clearButtonCheck(this.input.value), this.inputUntouched = !1, B.et.stage("TAeKPJNCNCaSIVEMMC", 1), n.prototype.inputInput.apply(this, arguments), _r_();
},
inputKeyUp:function(t) {
if (_i_("4ab:295"), 2 === B.et.track("YQecfBfIHSHFTVZMYIO")) {
var e = t.which >= 37 && t.which <= 40, i = this.input.value.toLowerCase(), s = this.items.some(function(t) {
return _i_("4ab:513"), _r_(t.valueLowerCase.indexOf(i) >= 0);
});
(e && !s || !i) && (this.results = [], this.items = [], this.$items = $({}), this.listHide());
}
n.prototype.inputKeyUp.apply(this, arguments), _r_();
},
inputFocus:function(t) {
_i_("4ab:296"), n.prototype.inputFocus.apply(this, arguments), _r_();
},
inputBlur:function() {
_i_("4ab:297"), clearTimeout(this.timer), this.model.destination.abortPredictions();
var t = this.model.destination.get().ss_raw;
if (t) {
var e = t.split(/\s+/).length;
a.sendOnce("[interaction] autocomplete tokens typed [" + e + "]");
}
0 === this.input.value.length && this.model.getFlag("clear_input_on_click") && this.input.value !== this.$input.data("cached-value") && (this.input.value = this.$input.data("cached-value") || ""), n.prototype.inputBlur.apply(this, arguments), this.suggestionsLocked = !1, _r_();
},
inputEnter:function(t) {
_i_("4ab:298"), a.send("[interaction] search input pressed enter"), n.prototype.inputEnter.apply(this, arguments), _r_();
},
clearClick:function(t) {
_i_("4ab:299"), t.preventDefault(), this.reset({
hard:!0
}), this.input.focus(), _r_();
},
setValue:function(t) {
_i_("4ab:300"), this.clearButtonCheck(t), n.prototype.setValue.apply(this, arguments), this.toggleClear(), _r_();
},
toggleClear:function() {
_i_("4ab:301"), this.$clear.length && this.$clear.toggleClass("-visible", "" !== this.input.value), _r_();
},
listShow:function() {
_i_("4ab:302"), this.results && this.results.filter(function(t) {
return _i_("4ab:490"), _r_(t.photo_uri);
}).length ? this.$list.addClass("sb-autocomplete__list-with_photos") :this.$list.removeClass("sb-autocomplete__list-with_photos"), this.items.length > 0 && this.input.value.length >= this.options.minLength ? n.prototype.listShow.apply(this, arguments) :this.items.length > 0 && this.model.getFlag("on_click_suggestions") && n.prototype.listShow.apply(this, arguments), _r_();
},
autocomplete:function(t) {
_i_("4ab:303"), t = t || {}, this.highlightReset({
preserveInputValue:!0
}), clearTimeout(this.timer), this.model.destination.abortPredictions(), this.hideLoading(), this.toggleClear(), t.fromFocus || (this.isDeletion ? this.model.destination.reset() :this.postAutocomplete(), this.input.value.length >= this.options.minLength && (this._loading = !0), this.model.getFlag("BbVIDQOJHZWSdKWdPOAcOcMWVceVbYANZMTAdTdHO") && B.et.stage("BbVIDQOJHZWSdKWdPOAcOcMWVceVbYANZMTAdTdHO", 6), this.timer = setTimeout(function() {
_i_("4ab:530"), this.input.value.length >= this.options.minLength && (this.model.destination.getPredictions(this.query(), this.render.bind(this)), this.showLoading()), _r_();
}.bind(this), this.options.delay)), _r_();
},
query:function() {
return _i_("4ab:304"), _r_(this.input.value);
},
extendOptions:function() {
return _i_("4ab:305"), _r_({});
},
render:function(t, e) {
_i_("4ab:306"), this.results = [], this.items = [], this.$items = $({}), this.on_click_suggestion = !1, this.hideLoading(), !t && this.model.getFlag("on_click_suggestions_track") && e.on_click_suggestion && (this.on_click_suggestion = !0), this._loading = !1, !t || "service-booking-no-results" != t.toString() && -1 === t.toString().indexOf("ZERO_RESULTS") || a.send("[context] autocomplete zero results search"), !t && Array.isArray(e.results) ? (a.send("[context] autocomplete suggestions [" + e.results.length + "]"), e.is_powered_by_google && a.send("[context] autocomplete google place search"), this.results = e.results, B.env.rtl && (e.is_rtl = !0), this.items = e.results.map(function(t) {
return _i_("4ab:514"), _r_({
value:t.label,
valueLowerCase:t.label.toLowerCase()
});
}), this.$list.html(this.templateResults.render(e)), this.$items = this.$list.find('[data-list-item=""]'), this.model.getFlag("a11yinput") && this.a11yAnnounceResults(e)) :t || (this.$list.html(this.templateResults.render(e)), this.model.getFlag("a11yinput") && this.a11yAnnounceResults(e)), this.postAutocomplete(), setTimeout(function() {
_i_("4ab:491"), this.$items.each(function() {
_i_("4ab:536"), this.scrollWidth > this.offsetWidth && this.setAttribute("data-title", this.getAttribute("data-label")), _r_();
}), _r_();
}.bind(this), 500), r.stage("bLESfPQfQMbWHcALXT", 1), _r_();
},
a11yAnnounceResults:function(t) {
_i_("4ab:307"), Array.isArray(t.results) && t.results.length > 0 && setTimeout(function() {
_i_("4ab:523"), this.$el.find(".sb-a11y-announcement").show(), this.$el.find(".sb-a11y-announcement").html("<p>" + B.jstmpl.translations("a11y_index_autocomplete_suggested_destinations") + "</p>"), setTimeout(function() {
_i_("4ab:541"), this.$el.find(".sb-a11y-announcement").html(""), this.$el.find(".sb-a11y-announcement").hide(), _r_();
}.bind(this), 500), _r_();
}.bind(this), 900), _r_();
},
choose:function(t) {
_i_("4ab:308"), a.send("[interaction] autocomplete click position [" + t + "]"), a.send("[interaction] autocomplete click [" + this.results[t].dest_type + "]"), clearTimeout(this.timer), this.model.destination.abortPredictions(), this.model.destination.set(this.results[t]), n.prototype.choose.apply(this, arguments);
var e = this.results[t];
B.et.goal("autocomplete_option_selected"), "theme" == this.results[t].dest_type ? B.et.goal("autocomplete_option_selected_theme") :"hotel" == this.results[t].dest_type ? B.et.goal("autocomplete_option_selected_hotel") :this.results[t].place_id ? B.et.goal("autocomplete_option_selected_google_places") :"query_finder" == this.results[t].result_type || B.et.goal("autocomplete_option_selected_destination"), "anywhere" == this.results[t].dest_type ? (this.model.setFields("drec_traffic", [ {
name:"dr_source",
value:"sb_anywhere"
} ]), this.model.emit("change", {
group:""
})) :(this.model.setFields("drec_traffic", []), this.model.emit("change", {
group:""
})), this.results[t].flags && this.results[t].flags.is_region_city && B.et.customGoal("adUAKYGPBDJfNcDBbNMTKe", 1);
var i = [ "landmark", "airport", "district", "region" ];
if (this.model.destination.setTrackingFields("map_autoopen", []), -1 !== i.indexOf(e.dest_type)) {
this.locationSelected = !0, B.et.stage("ebccCcCcCWNAURAfPMTOdcRe", 1);
var s = [];
this.model.getFlag("open_location_in_map") && (s.push({
name:"map",
value:1
}), B.et.track("ebccCcCcCWNAURAfPMTOdcRe") || $(".sb-searchbox__map_trigger").removeClass("g-hidden")), this.model.destination.setTrackingFields("map_trigger", s);
} else this.model.getFlag("open_location_in_map") && ($(".sb-searchbox__map_trigger").addClass("g-hidden"), this.model.destination.setTrackingFields("map_trigger", []));
("theme" == this.results[t].dest_type || "theme_dest" == this.results[t].result_type) && this.model.submit(), this.showCalendarOnDesinationChange(), _r_();
},
showCalendarOnDesinationChange:function() {
if (_i_("4ab:309"), !this.model.getFlag("calendar_on_destination_change") || this.model.dates.get().checkin) return _r_();
this.showCalendar(), _r_();
},
showCalendar:function() {
_i_("4ab:310"), setTimeout(function() {
_i_("4ab:492"), this.$searchbox.find(".c2-wrapper-s-checkin").trigger("show"), _r_();
}.bind(this)), _r_();
},
hideCalendar:function() {
_i_("4ab:311"), setTimeout(function() {
_i_("4ab:493"), this.$searchbox.find(".c2-wrapper-s-checkin").trigger("hide"), this.$searchbox.find(".c2-wrapper-s-checkout").trigger("hide"), _r_();
}.bind(this)), _r_();
},
isVisibleCalendar:function() {
return _i_("4ab:312"), _r_(this.$searchbox.find(".c2-calendar").is(":visible"));
},
showSuggestions:function() {
if (_i_("4ab:313"), this.suggestionsLocked) return _r_();
this.model.destination.getSuggestions(this.render.bind(this)), this.suggestionsLocked = !0, _r_();
},
focusOnLoad:function() {
_i_("4ab:314");
var t = $(document);
t.ready(function() {
_i_("4ab:494"), this.input.focus(), _r_();
}.bind(this)), _r_();
},
enableFocusOnTyping:function() {
_i_("4ab:315");
var t = $(document);
t.on("keydown.autofocus", this.onKeyDown.bind(this)), this.$input.on("blur", function() {
_i_("4ab:524"), t.on("keydown.autofocus", this.onKeyDown.bind(this)), _r_();
}.bind(this)).on("focus", function() {
_i_("4ab:495"), t.off("keydown.autofocus", this.onKeyDown.bind(this)), _r_();
}.bind(this)), _r_();
},
onKeyDown:function(t) {
_i_("4ab:316");
var e = this.$input.offset().top, i = t.keyCode, n = t.metaKey || t.ctrlKey, s = i > 47 && 58 > i || i > 64 && 91 > i || i > 95 && 112 > i;
!s || n || !document.activeElement || /INPUT|TEXTAREA|SELECT/.test(document.activeElement.nodeName) || $(".modal-mask").length || this.options.focusOnTyping && (this.options.isSticky && this.stickyController ? this.stickyController.show() :window.scrollY > e && $("html, body").animate({
scrollTop:e - 5
}), this.input.value && this.setValue(""), this.$input.focus()), _r_();
},
reset:function() {
_i_("4ab:317"), this.selectedValue || this.model.destination.reset(), n.prototype.reset.apply(this, arguments), _r_();
},
highlightFromNavigation:function() {
_i_("4ab:318");
var t = [].slice.call(arguments);
this.model.getFlag("bLESfPQfQMbWHcALXT") && t.push(!0), n.prototype.highlightFromNavigation.apply(this, t), _r_();
},
inputBlurSync:function() {
if (_i_("4ab:319"), "cross_product_index" === B.env.b_action && B.et.track("YQecfBfIHSHFTVZMYIO")) return _r_();
n.prototype.inputBlurSync.apply(this, arguments), _r_();
},
clickOut:function() {
if (_i_("4ab:320"), "cross_product_index" === B.env.b_action && B.et.track("YQecfBfIHSHFTVZMYIO")) return this.listHide(), _r_();
n.prototype.clickOut.apply(this, arguments), _r_();
}
}), _r_();
}), B.define("search/destination/model", function(t, e, i) {
"use strict";
_i_("4ab:15");
var n = t("search/destination/service");
function s(t) {
_i_("4ab:57"), this.model = t, this.data = {
ss:""
}, this.valid = !0, this.validationError = "", this.options = {}, this.predicitonParameters = {}, this.searchInstance = null, this.suggestionsCache = {
results:[]
}, _r_();
}
$.extend(s.prototype, {
init:function(t) {
_i_("4ab:137"), this.data = t;
var e = {};
if (this.model && this.model.getFlag && (this.model.getFlag("on_click_suggestions") || this.model.getFlag("on_click_suggestions_anywhere")) && (this.model.getFlag("on_click_suggestions_anywhere") && (e.anywhere = !0), B.env.b_ac_search_history && this.model.getFlag("on_click_suggestions") && (e.searchHistory = !0), this.model.use("group"), this.model.on("init", function(t) {
_i_("4ab:515"), "group" === t.group && this.fetchSuggestions(e), _r_();
}.bind(this))), this.model.getFlag("retain_destination_values_on_back") && "sessionStorage" in window) {
var i = window.sessionStorage.getItem("retail_destinaiton_dest_id");
if (i && t.dest_id !== i && (B.et.stage("AEJPXMXFLNeZIBTdSTHe", 1), 2 === this.model.getFlag("retain_destination_values_on_back"))) {
var n = JSON.parse(window.sessionStorage.getItem("retail_destinaiton_data"));
this.set(n);
}
}
this.emit("init"), _r_();
},
configure:function(t, e) {
_i_("4ab:138"), void 0 !== e ? this.options[t] = e :"object" == typeof t && $.extend(this.options, t), _r_();
},
getOption:function(t) {
return _i_("4ab:139"), _r_(this.options[t]);
},
get:function() {
return _i_("4ab:140"), _r_(this.data);
},
set:function(t) {
if (_i_("4ab:141"), "sessionStorage" in window && this.model.getFlag("retain_destination_values_on_back") && t.dest_id && window.sessionStorage.getItem("retail_destinaiton_dest_id") !== t.dest_id && (window.sessionStorage.setItem("retail_destinaiton_dest_id", t.dest_id), window.sessionStorage.setItem("retail_destinaiton_data", JSON.stringify(t))), this.searchInstance && this.searchInstance.getResultDetails && !t._details) return this.searchInstance.getResultDetails(t, function(e, i) {
_i_("4ab:516"), i = i || {}, i._details = !0, this.set(i), window.ga && window.ga("send", "event", "ac_google_places", [ i.place_types || "unknown", i.name ].join("|"), this.data.ss_raw, t.position), _r_();
}.bind(this)), _r_();
this.data.ss = t.ss, this.data.dest_id = t.dest_id, this.data.dest_type = t.dest_type, t.nr_hotels && (this.data.nr_hotels = t.nr_hotels), this.data.acc_type_id = t.acc_type_id, t.place_id && t.latitude && t.longitude ? (this.data.place_id = t.place_id, this.data.latitude = t.latitude, this.data.longitude = t.longitude, this.data.place_types = t.place_types) :t.dest_id && t.latitude && t.longitude ? (this.data.place_id = "", this.data.latitude = t.latitude, this.data.longitude = t.longitude, this.data.place_types = null) :(this.data.place_id = "", this.data.latitude = "", this.data.longitude = "", this.data.place_types = null), t._fa ? this.model.setFormAction(t._fa) :this.model.setFormAction(null), t._ef = t._ef || [], this.data.dest_id && t._ef.push({
name:"dest_id",
value:this.data.dest_id
}), this.data.dest_type && t._ef.push({
name:"dest_type",
value:this.data.dest_type
}), this.data.place_id && t._ef.push({
name:"place_id",
value:this.data.place_id
}), this.data.latitude && t._ef.push({
name:"place_id_lat",
value:this.data.latitude
}), this.data.longitude && t._ef.push({
name:"place_id_lon",
value:this.data.longitude
}), this.data.place_types && Array.isArray(this.data.place_types) && t._ef.push({
name:"place_types",
value:this.data.place_types.join(",")
}), t._ef.push({
name:"search_pageview_id",
value:B.env.pageview_id
}), t._ef.push({
name:"search_selected",
value:"true"
}), this.model.setFields("destinationNotSelected", []), this.model.setFields("destinationSelected", t._ef), this.emit("change"), _r_();
},
setSearchString:function(t) {
_i_("4ab:142"), this.data.ss = t, this.data.ss_raw = t, this.valid || this.validate(), _r_();
},
reset:function() {
_i_("4ab:143"), this.data.dest_id = null, this.data.dest_type = null, this.data.place_id = null, this.data.latitude = null, this.data.longitude = null, this.model.setFormAction(null), this.model.setFields("destination", []), this.model.setFields("destinationNotSelected", []), this.model.setFields("destinationSelected", [ {
name:"dest_id",
value:""
}, {
name:"dest_type",
value:""
}, {
name:"search_pageview_id",
value:B.env.pageview_id
}, {
name:"search_selected",
value:"false"
} ]), this.emit("change"), _r_();
},
setTrackingFields:function(t, e) {
_i_("4ab:144"), this.model.setFields(t, e), this.emit("change"), _r_();
},
validate:function() {
_i_("4ab:145");
var t = !0, e = "";
if (!this.options.validate) return this.valid = t, this.validationError = e, _r_(t);
return "" === this.data.ss && (this.emptyValid || (t = !1, e = "search-string-empty")), this.valid != t && (this.valid = t, this.validationError = e, this.emit("validation")), _r_(t);
},
initPredictions:function() {
if (_i_("4ab:146"), this.options.gpf) {
var t = B.require("search/destination/service-atlas");
t.init();
}
_r_();
},
configurePredictions:function(t) {
_i_("4ab:147"), $.extend(this.predicitonParameters, t), _r_();
},
getPredictions:function(t, e) {
_i_("4ab:148");
var i = $.extend({}, B.env.search_autocomplete_params, this.predicitonParameters);
this.searchInstance && this.searchInstance.abort();
function s(t, i) {
_i_("4ab:437"), i && (this.model.setFields("destination", i._ef), this.model.setFields("destinationNotSelected", i._efd)), e.apply(null, arguments), _r_();
}
i.ss = t, i.gpf = this.options.gpf, this.options.onlyCurrentCountry && (i.e_acf_i = B.env.b_country_id, i.e_acf_t = "country"), this.searchInstance = n.search(i, s.bind(this)), this.model.setFields("destinationOriginal", [ {
name:"ss_raw",
value:i.ss
} ]), this.model.setFields("destinationSelected", [ {
name:"search_pageview_id",
value:B.env.pageview_id
} ]), _r_();
},
abortPredictions:function() {
_i_("4ab:149"), this.searchInstance && this.searchInstance.abort(), _r_();
},
getSuggestions:function(t, e) {
if (_i_("4ab:150"), this.suggestionsCache.results.length) return setTimeout(function() {
_i_("4ab:517"), t(null, this.suggestionsCache), _r_();
}.bind(this), 0), _r_();
this.model.one("destination:suggestions", function() {
_i_("4ab:486"), this.suggestionsCache.results.length && t(null, this.suggestionsCache), _r_();
}.bind(this)), _r_();
},
fetchSuggestions:function(t) {
if (_i_("4ab:151"), this.suggestionsLoading) return _r_();
var e = function(t, e) {
if (_i_("4ab:451"), !t && e && e.results) {
e.on_click_suggestion = e.results.length > 0;
for (var i = 0; i < e.results.length; i++) !e.results[i].ss && e.results[i].label && (e.results[i].ss = e.results[i].label);
this.suggestionsCache = e;
}
this.suggestionsLoading = !1, this.emit("destination:suggestions"), _r_();
}, i = B.require("search/destination/service-booking");
this.suggestionsInstance = i.getSuggestions(e.bind(this), t), this.suggestionsLoading = !0, _r_();
},
initOnlyCurrentCountry:function(t) {
_i_("4ab:152"), this.options.onlyCurrentCountry = !!t, _r_();
},
getOnlyCurrentCountry:function() {
return _i_("4ab:153"), _r_(!!this.options.onlyCurrentCountry);
},
setOnlyCurrentCountry:function(t) {
_i_("4ab:154"), this.options.onlyCurrentCountry = !!t, this.emit("change", {
onlyCurrentCountry:!0
}), _r_();
},
emit:function(t, e) {
_i_("4ab:155"), e = e || {}, this.model.emit(t, $.extend(e, {
group:"destination"
})), _r_();
}
}), i.exports = s, _r_();
}), B.define("search/destination/service", function(t, e, i) {
"use strict";
_i_("4ab:16");
var n = t("search/destination/service-booking"), s = t("search/destination/service-atlas");
function a(t, e, i) {
_i_("4ab:58");
var n, s, a, o = [], _ = [], l = [], h = 0, d = function(t, e, n) {
if (_i_("4ab:156"), h++, o.length && (e ? _.push(e) :l[t] = n, h == o.length)) if (_.length == o.length) i.call(null, _[0], null); else {
var s = r(l);
i.call(null, null, s);
}
_r_();
}, c = function() {
for (_i_("4ab:157"), n = 0; n < o.length; n++) o[n].abort();
_r_();
};
for (n = 0; n < t.length; n++) s = t[n].search.call(t[n], $.extend({}, e), d.bind(null, n)), s.getResultDetails && (a = s.getResultDetails), o.push(s);
return _r_({
abort:c,
getResultDetails:a
});
}
function r(t) {
_i_("4ab:59");
var e = 6, i = 3, n = {
results:[],
_ef:[],
_efd:[]
};
return t.forEach(function(t) {
if (_i_("4ab:158"), !t) return _r_();
if (t.results) if (n.results.length) {
t.results = t.results.filter(l), t.results.splice(i);
var s = e - t.results.length;
n.results.splice(s), n.results = t.results.concat(n.results);
} else n.results = t.results;
[ "_ef", "_efd" ].forEach(function(e) {
_i_("4ab:452"), t[e] && (n[e] = n[e].concat(t[e].filter(o(n[e])))), _r_();
}), n.is_powered_by_google = n.is_powered_by_google || t.results.length && t.is_powered_by_google, _r_();
}), n.results.forEach(function(t, e) {
_i_("4ab:159"), t._ef = _(t._ef, "ac_position", e), _r_();
}), n.city = n.results, n.__js_upa__ = n.is_powered_by_google, _r_(n);
}
function o(t) {
_i_("4ab:60");
var e = {};
return t.forEach(function(t) {
_i_("4ab:160"), e[t.name] = !0, _r_();
}), _r_(function(t) {
return _i_("4ab:113"), _r_(!e[t.name]);
});
}
function _(t, e, i) {
return _i_("4ab:61"), t = t.filter(function(t) {
return _i_("4ab:321"), _r_(t.name !== e);
}), t.push({
name:e,
value:i
}), _r_(t);
}
function l(t) {
return _i_("4ab:62"), _r_(-1 != [ "route", "postal_code", "street_address" ].indexOf(t.place_type));
}
function h(t, e, i) {
_i_("4ab:63");
var n, s = [], a = [], r = function(t, e) {
if (_i_("4ab:161"), s.length) if (t) a.push(t), a.length == s.length && i.call(null, t, e); else for (i.call(null, t, e), n = 0; n < s.length; n++) s[n].abort();
_r_();
}, o = function() {
for (_i_("4ab:162"), n = 0; n < s.length; n++) s[n].abort();
_r_();
};
for (n = 0; n < t.length; n++) s.push(t[n].search.call(t[n], $.extend({}, e), r));
return _r_({
abort:o
});
}
function d(t, e, i) {
_i_("4ab:64");
var n, s, a = {}, r = function(e, n) {
_i_("4ab:163"), setTimeout(function() {
_i_("4ab:453"), e && t.length ? s() :i.call(null, e, n), _r_();
}, 0), _r_();
};
s = function() {
_i_("4ab:164");
var i = t.shift();
n = i.search.call(i, $.extend({}, e), r), a.getResultDetails = n.getResultDetails, _r_();
};
var o = function() {
_i_("4ab:165"), n && n.abort(), _r_();
};
return s(), a.abort = o, _r_(a);
}
i.exports = {
search:function(t, e) {
if (_i_("4ab:166"), !t || !t.ss || "function" != typeof e) throw new Error("Invalid arguments");
return _r_(t.gpo ? s.search(t, e) :t.fesp_acf_i || t.fesp_acf_i_regions || t.fesp_acf_i_cities ? n.search(t, e) :t.gpf && t.ss.match(/[0-9]/) ? a([ n, s ], t, e) :t.gpr ? h([ n, s ], t, e) :t.gpf ? d([ n, s ], t, e) :n.search(t, e));
}
}, _r_();
}), B.define("search/destination/service-atlas", function(t, e, i) {
"use strict";
_i_("4ab:17");
var n = t("event-emitter"), s = B.env.b_map_center_latitude || B.env.b_latitude || void 0, a = B.env.b_map_center_longitude || B.env.b_longitude || void 0, r = 3e4, o = 2, _ = [ "ChIJNy0jzGPMUQ4RWpboPw0ztMY", "ChIJ2xJC2SwmsUcRBqiHnUEubtY", "ChIJT-IyeGHurw0Rx89nUEaYTPM", "ChIJk_Swujrurw0R7yS_X2BSuD4", "ChIJv02k1k9oWQ0RWvhKDOLvTWA" ], l = {
administrative_area_level_1:"region",
administrative_area_level_2:"region",
administrative_area_level_3:"region",
administrative_area_level_4:"region",
administrative_area_level_5:"region",
airport:"airport",
country:"country",
locality:"city",
point_of_interest:"landmark",
route:"region",
street_address:"region",
postal_code:"region",
sublocality:"district"
};
function h() {
return _i_("4ab:65"), _r_(!!B.atlas);
}
function d(t, e, i) {
_i_("4ab:66");
var n = {
city:[]
};
n.__upa__ = e.filter(c).slice(0, 5).map(function(e, i) {
_i_("4ab:322"), e = e.get("data");
var n = {
upa:!0,
nr_hotels:0,
nr_hotels_25:0,
ss_raw:t.ss,
dest_id:e.id,
place_id:e.id,
dest_type:l[e.types && e.types[0]] || "landmark",
place_type:e.types && e.types[0],
place_types:e.types,
ss:e.description,
label:e.description,
label_blocks:b(e.description, e.matched_substrings),
label_highlighted:f(e.description, e.matched_substrings, {
encode:t.gpf_encode
}),
label_multiline:"<span><b>" + e.description + "</b></span>",
hotels:0,
lc:B.env.b_lang,
position:i,
is_google_result:!0,
_ef:[],
cjk:"zh" === B.env.b_lang || "xt" === B.env.b_lang || "ja" === B.env.b_lang || "ko" === B.env.b_lang
};
return n._ef.push({
name:"ac_position",
value:i
}), _r_(n);
}), n.results = n.__upa__, n._ef = [], n._ef.push({
name:"search_pageview_id",
value:B.env.pageview_id
}), n.is_powered_by_google = n.results.length > 0, n.__js_upa__ = n.is_powered_by_google, i(null, n), _r_();
}
function c(t) {
_i_("4ab:67");
var e = t.get("data");
return _r_(-1 === _.indexOf(e.id));
}
function u(t, e, i) {
_i_("4ab:68"), t = t || {}, t.id = e.id || e.place_id, t.place_id = t.id, t.name = e.name || e.formatted_address, t.latitude = e.geometry.location.lat(), t.longitude = e.geometry.location.lng(), t.place_types = e.types, t.dest_type = l[e.types && e.types[0]] || "landmark", t._ef = t._ef || [], t._ef.push({
name:"ss_short",
value:e.name
}), i(null, t), _r_();
}
function p(t, e) {
if (_i_("4ab:69"), !t.place_id) return e(null, t), _r_();
this.atlas.getGeocodeDetails({
placeId:t.place_id
}, function(i) {
_i_("4ab:167"), u(t, i, e), _r_();
}), _r_();
}
function f(t, e, i) {
_i_("4ab:70");
var n = "";
if (i = i || {}, !e || 0 === e.length) return _r_(t);
for (var s = e.map(function(t) {
return _i_("4ab:323"), _r_(t.offset);
}), a = e.map(function(t) {
return _i_("4ab:324"), _r_(t.offset + t.length - 1);
}), r = 0; r < t.length; r++) -1 != s.indexOf(r) && (n += "<b>"), n += t.charAt(r), -1 != a.indexOf(r) && (n += "</b>");
return i.encode && (n = B.jstmpl.fn.FILTERS.entities(n), n = n.replace(/&lt;b&gt;/g, "<b>"), n = n.replace(/&lt;&#47;b&gt;/g, "</b>")), _r_(n);
}
function b(t, e) {
_i_("4ab:71");
var i = [];
if (!e || 0 === e.length) return _r_([ {
text:t
} ]);
return e[0].offset && i.push({
text:t.substr(0, e[0].offset)
}), e.forEach(function(n, s) {
_i_("4ab:168");
var a = n.offset + n.length, r = (e[s + 1] && e[s + 1].offset || t.length) - a;
i.push({
highlighted:!0,
text:t.substr(n.offset, n.length)
}), r && i.push({
text:t.substr(a, r)
}), _r_();
}), _r_(i);
}
i.exports = n.extend({
init:function(t, e) {
_i_("4ab:325"), t = t || {};
var i = this, n = "booking-places";
if (!h()) return _r_();
if (this.initialized) return e && this.atlas.done(e), _r_();
this.initialized = !0;
var s = function(t) {
_i_("4ab:472");
var s = document.createElement("div");
i.atlas = new t({
provider:"provider-places",
modules:[ "autocomplete", "places" ],
options:{
domNode:s,
channel:n
}
}), e && i.atlas.done(e), _r_();
};
B.atlas.isAtlasAsync ? B.require([ "async-loader" ], function(t) {
_i_("4ab:496"), t.load({
js:"async_atlas_places_js"
}).then(function() {
_i_("4ab:537"), s(B.atlas.require("atlas-places")), _r_();
}), _r_();
}) :s(B.atlas.require("atlas-places")), _r_();
},
search:function(t, e) {
if (_i_("4ab:326"), !t || !t.ss || "function" != typeof e) throw new Error("service-atlas-invalid-arguments");
if (t.ss.length < o) return setTimeout(function() {
_i_("4ab:497"), e(new Error("service-atlas-too-short-search-string"), {}), _r_();
}, 4), _r_({
getDetails:$.noop,
abort:$.noop
});
if (!h()) return setTimeout(function() {
_i_("4ab:498"), e(new Error("service-atlas-no-atlas"), null), _r_();
}, 4), _r_({
getDetails:$.noop,
abort:$.noop
});
var i = !1, n = {
query:t.ss
};
s && a && r && (n.lat = s, n.lon = a, n.radius = r);
var _ = function(n) {
_i_("4ab:473"), i || (n && Array.isArray(n) ? d(t, n, e) :e(new Error("service-atlas-invalid-results"), null)), _r_();
}, l = function(t) {
_i_("4ab:474"), i || e(new Error("service-atlas-error " + t), null), _r_();
};
this.init(t, function() {
_i_("4ab:499"), this.atlas.autocomplete(n, _, l), _r_();
}.bind(this));
var c = function() {
_i_("4ab:475"), i = !0, _r_();
};
return _r_({
getResultDetails:p.bind(this),
abort:c
});
}
}), _r_();
}), B.define("search/destination/service-booking", function(t, e, i) {
"use strict";
_i_("4ab:18");
var n = t("event-emitter"), s = B.env.b_sb_autocomplete_predictions_url;
function a(t) {
return _i_("4ab:72"), t.term = t.ss, delete t.ss, _r_(t);
}
function r(t, e, i) {
_i_("4ab:73"), t && t.city ? t.__upa__ || 0 !== t.city.length || t.bbtoollocations && 0 !== t.bbtoollocations.length || t.theme && 0 !== t.theme.length || t.searches && 0 !== t.searches.length ? (t.city = t.city.map(function(e, i) {
return _i_("4ab:476"), !e.label && e.labels && (e.label = o(e.labels)), !e.labels || "zh" !== e.lc && "xt" !== e.lc && "ja" !== e.lc && "ko" !== e.lc || (e.label_blocks = _(e.labels)), e.ss = e.label, e.label_highlighted = e.label_highlighted || e.label, e.position = i, e._ef = e._ef || [], e._ef.push({
name:"ac_position",
value:i
}), e._ef.push({
name:"ac_langcode",
value:e.lc
}), t.__did_you_mean__ && (e._ef.push({
name:"suggested_term",
value:t.__did_you_mean__.suggestion
}), e._ef.push({
name:"suggestion_clicked",
value:1
})), _r_(e);
}), t.results = t.city, t.bbtoollocations && (t.results = t.bbtoollocations.map(function(t, e) {
return _i_("4ab:525"), delete t.label_highlighted, t.label_blocks = [ {
highlighted:1,
text:t.name
}, {
text:", "
}, {
text:t.address
} ], t.ss = t.name, t.latitude = t.place_id_lat, t.longitude = t.place_id_lon, t.position = e, t._ef = t._ef || [], t._ef.push({
name:"bbtoollocation",
value:"1"
}), _r_(t);
}).concat(t.results)), t.theme && (t.theme = t.theme.map(function(e, i) {
return _i_("4ab:500"), e.ss = e.label, e._ef = e._ef || [], e._ef.push({
name:"ac_position",
value:i + t.city.length
}), _r_(e);
}), t.theme.length && e.limitOneTheme && (t.theme = [ t.theme[0] ]), t.results = t.results.concat(t.theme)), t._ef = t._ef || [], t._ef.push({
name:"search_pageview_id",
value:B.env.pageview_id
}), t._ef.push({
name:"ac_suggestion_list_length",
value:t.city.length
}), t._ef.push({
name:"ac_suggestion_theme_list_length",
value:t.theme ? t.theme.length :0
}), t._efd = t._efd || [], i(null, t)) :i(new Error("service-booking-no-results"), t) :i(new Error("service-booking-data-invalid"), null), _r_();
}
function o(t) {
return _i_("4ab:74"), _r_(t.map(function(t) {
return _i_("4ab:438"), _r_(t.text);
}).join(", "));
}
function _(t) {
_i_("4ab:75");
var e = [];
return t.forEach(function(t, i) {
_i_("4ab:169"), i > 0 && e.push({
text:", "
}), e.push({
highlighted:!!t.hl,
text:t.text
}), _r_();
}), _r_(e);
}
i.exports = n.extend({
search:function(t, e) {
if (_i_("4ab:327"), !t || !t.ss || "function" != typeof e) throw new Error("Invalid arguments");
var i = a(t);
this.emit("beforeajax", t, i);
var n = $.ajax({
type:"get",
url:s,
data:i,
success:function(i, n, s) {
_i_("4ab:531"), r(i, t, e), _r_();
}.bind(this),
error:function(t, i, n) {
_i_("4ab:532"), "abort" !== i && e(new Error("service-booking-error " + n), null), _r_();
}.bind(this)
}), o = function() {
_i_("4ab:477"), n && n.abort && n.abort(), _r_();
};
return _r_({
abort:o
});
},
getSuggestions:function(t, e) {
_i_("4ab:328");
var i = B.env.search_autocomplete_params, n = 0, s = "";
if (e && e.searchHistory && B.env.b_ac_search_history) return t(!1, {
results:B.env.b_ac_search_history
}), _r_();
"searchresults" === B.env.b_action && (s = B.search.dates("checkin"), s = "valid" === s.type ? s.toString() :""), i = Object.assign({}, i, {
ttype:n,
checkin:s
});
var a = $.ajax({
type:"get",
url:"/search_history_and_suggestions",
data:i,
success:function(e, i, n) {
_i_("4ab:518"), t(null, e), _r_();
},
error:function(e, i, n) {
if (_i_("4ab:519"), "abort" === i) return _r_();
t(new Error("service-booking-error " + n), null), _r_();
}
}), r = function() {
_i_("4ab:478"), a && a.abort && a.abort(), _r_();
};
return _r_({
abort:r
});
}
}), _r_();
}), B.define("component/search/travel-purpose/checkbox", function(t, e, i) {
"use strict";
_i_("4ab:19");
var n = t("component"), s = t("search/searchbox/model");
i.exports = n.extend({
init:function() {
_i_("4ab:329"), this.$form = this.$el.closest("form"), this.$checkbox = this.$el.find("[name=sb_travel_purpose]"), this.profileSplitAccounts = B.env.b_connected_user_accounts, this.formAction = this.$form.attr("action"), this.model = s.getInstance(this.$form.attr("data-sb-id")), this.searchedBusiness = !1, this.$checkbox.length && "checked" === this.$checkbox[0].getAttribute("checked") && (this.searchedBusiness = !0), (this.searchedBusiness || this.profileSplitAccounts) && this.bindEvents(), _r_();
},
bindEvents:function() {
_i_("4ab:330"), this.$checkbox.on("change", this.handleCheckboxChange.bind(this)), _r_();
},
handleCheckboxChange:function() {
_i_("4ab:331"), this.$checkbox.prop("checked") ? (this.$hidden && (this.$hidden.remove(), this.$checkbox[0].setAttribute("name", "sb_travel_purpose")), this.createRedirectFormFields()) :(this.$hidden = $('<input name="sb_travel_purpose" value="leisure" type="hidden" />').appendTo(this.$el), this.$checkbox[0].setAttribute("name", "h_sb_travel_purpose"), this.createRedirectFormFields()), _r_();
},
createRedirectFormFields:function() {
if (_i_("4ab:332"), !this.profileSplitAccounts || !this.profileSplitAccounts.length || !B.env.feature_profile_split_sb_checkbox) return _r_();
this.model.setFields("bnss", []), this.model.trigger("change", {});
var t = this.findAccountType(this.$checkbox.prop("checked")), e = this.formAction, i = B.env.b_secure_domain + this.$el.attr("data-profile-switch-url");
-1 === e.indexOf(B.env.b_nonsecure_hostname) && (e = B.env.b_nonsecure_hostname + e), e += -1 === e.indexOf("?") ? +this.$form.serialize() :"&" + this.$form.serialize(), this.model.setFields("bnss", [ {
type:"hidden",
name:"redirect_url",
value:e
}, {
type:"hidden",
name:"switch_to_user_id",
value:t.b_user_id
} ]), this.$form.attr("method", "POST"), this.model.setFormAction(i), this.model.trigger("change", {}), _r_();
},
findAccountType:function(t) {
_i_("4ab:333");
var e, i, n;
for (e = 0, i = this.profileSplitAccounts.length; i > e; ++e) "business" === this.profileSplitAccounts[e].b_type && t ? n = this.profileSplitAccounts[e] :"business" === this.profileSplitAccounts[e].b_type || t || (n = this.profileSplitAccounts[e]);
return _r_(n);
}
}), _r_();
}), B.define("component/search/dates/date-field", function(t, e, i) {
"use strict";
_i_("4ab:20");
var n = t("caret"), s = t("component"), a = t("formatting/date"), r = t("keycodes"), o = t("read-data-options"), _ = t("ga-tracker"), l = t("search/searchbox/model");
i.exports = s.extend({
init:function() {
_i_("4ab:334"), this.options = o(this.el, {
forceInitRender:{
name:"force-init-render",
type:Boolean,
defaultValue:!1
},
modelId:{
name:"sb-id",
type:String,
required:!0
},
modelMode:{
name:"mode",
type:String,
defaultValue:"single"
},
validators:{
name:"validators",
type:String,
defaultValue:""
}
});
var t = this.options.validators.split(",");
this.model = l.getInstance(this.options.modelId), this.model.use("dates"), this.model.on("change", this.modelChange.bind(this)), this.model.dates.configure({
noValidation:!0,
allowMaxLos:!0,
notEmpty:t.indexOf("not-empty") >= 0
}), this.$display = this.$el.find("[data-display]"), this.$inputs = this.$el.find("[data-input]"), this.$inputYear = this.$inputs.filter('[data-input-fragment="year"]'), this.$inputMonth = this.$inputs.filter('[data-input-fragment="month"]'), this.$inputDay = this.$inputs.filter('[data-input-fragment="day"]'), this.$controls = this.$el.find("[data-controls]"), this.$iconDay = this.$el.find("[data-icon-day]"), this.$field = this.$el.find("[data-field]"), this.$controls.on("mousedown", this.controlsMouseDown.bind(this)), this.$inputs.on("focus", this.inputFocus.bind(this)), this.$inputs.one("focus", this.inputFocusTrack.bind(this)), this.$inputs.on("blur", this.inputBlur.bind(this)), this.$inputs.on("keydown", this.inputKeyDown.bind(this)), this.$inputs.on("keyup", this.inputKeyUp.bind(this)), this.$inputs.on("keypress", this.inputKeyPress.bind(this)), B.eventEmitter.on("CALENDAR:shown CALENDAR:closed", this.updateFocusClass.bind(this)), this.previousState = {}, this.state = {
editing:!1,
currentField:null
}, this.checkDateFields(), this.initModel(), _r_();
},
checkDateFields:function() {
_i_("4ab:335");
var t, e;
this.$inputYear.length && this.$inputMonth.length && this.$inputDay.length || (t = this.model.dates.getFallbackDates(this.options.modelMode), 0 === this.$inputYear.length && (e = t.year || "", this.$inputYear = this.createDateInputField(this.options.modelMode + "_year", e).appendTo(this.el), setTimeout(function() {
throw _i_("4ab:526"), Error("Date input field year was not found in " + B.env.b_action + " action");
}, 0)), 0 === this.$inputMonth.length && (e = t.month || "", this.$inputMonth = this.createDateInputField(this.options.modelMode + "_month", e).appendTo(this.el), setTimeout(function() {
throw _i_("4ab:527"), Error("Date input field month was not found in " + B.env.b_action + " action");
}, 0)), 0 === this.$inputDay.length && (e = t.day || "", this.$inputDay = this.createDateInputField(this.options.modelMode + "_monthday", e).appendTo(this.el), setTimeout(function() {
throw _i_("4ab:528"), Error("Date input field day was not found in " + B.env.b_action + " action");
}, 0))), _r_();
},
createDateInputField:function(t, e) {
return _i_("4ab:336"), _r_($("<input>").attr({
type:"hidden",
name:t,
value:e
}).val(e));
},
initModel:function() {
_i_("4ab:337");
var t = !1, e = this.$inputYear.val(), i = this.$inputMonth.val(), n = this.$inputDay.val();
e && i && n ? (t = this.model.dates.initDate(this.options.modelMode, {
year:+e,
month:+i - 1,
day:+n
}), this.$field.hasClass("-empty") && "index" === B.env.b_action && this.render()) :t = this.model.dates.initDate(this.options.modelMode, null), (!t || this.options.forceInitRender) && this.render(), _r_();
},
modelChange:function(t) {
if (_i_("4ab:338"), "dates" !== t.group || !t[this.options.modelMode]) return _r_();
B.env.b_is_bbtool_user && B.et.customGoal("VObLMEKKTVeBKeYEGWe", 3), this.render(), _r_();
},
controlsMouseDown:function(t) {
_i_("4ab:339"), this.inputBlurPrevented = !0, setTimeout(function() {
_i_("4ab:501"), this.inputBlurPrevented = !1, _r_();
}.bind(this)), _r_();
},
inputFocus:function(t) {
_i_("4ab:340"), clearTimeout(this.inputBlurTimer), this.state.editing = !0, this.state.currentField = t.target.getAttribute("data-input-fragment"), this.startEditing(), this.updateFocusClass(), _r_();
},
inputFocusTrack:function() {
_i_("4ab:341"), _.trackEvent(_.SearchBoxTracker, "Keyboard Focus", this.options.modelMode + " field"), _r_();
},
inputBlur:function(t) {
_i_("4ab:342");
var e = t.target, i = e.getAttribute("data-input-fragment");
this.inputBlurPrevented || (this.state.editing = !1, this.state.currentField = null), this.setDateFragment(i, e.value), this.inputBlurTimer = setTimeout(function() {
_i_("4ab:520"), this.apply(), this.updateFocusClass(), _r_();
}.bind(this)), _r_();
},
inputKeyDown:function(t) {
_i_("4ab:343");
var e = t.target, i = e.getAttribute("data-input-fragment");
if (r.isModifier(t.which)) return _r_();
r.isUpArrow(t.which) ? (this.adjustDateFragment(i, e.value, 1), t.preventDefault()) :r.isDownArrow(t.which) ? (this.adjustDateFragment(i, e.value, -1), t.preventDefault()) :r.isLeftArrow(t.which) || r.isBackspace(t.which) ? this.inputMoveAdjacent(t, -1, {
backspace:r.isBackspace(t.which)
}) :r.isRightArrow(t.which) && this.inputMoveAdjacent(t, 1), _r_();
},
inputKeyUp:function(t) {
_i_("4ab:344");
var e = t.target;
if (r.isModifier(t.which)) return _r_();
!r.isNavigation(t.which) && !r.isDeletion(t.which) && e.value.length >= Math.floor(e.getAttribute("maxlength")) && this.inputMoveAdjacent(t, 1, {
automatic:!0
}), _r_();
},
inputMoveAdjacent:function(t, e, i) {
_i_("4ab:345");
var s, a, r = t.target, o = this.$inputs.length, _ = n.getPosition(r), l = 0, h = this.$inputs.filter(r).index(), d = o - 1, i = i || {};
if (e > 0 && (l = r.value.length, d = 0), i.automatic && h == o - 1) return _r_();
if (!i.force && n.getSelectionLength(r)) return _r_();
(i.force || _ == l) && (h += e, (0 > h || h > o - 1) && (h = d), s = this.$inputs.get(h), i.automatic && s.value.length ? s.select() :(a = e > 0 ? 0 :s.value.length, n.setPosition(s, a), i.backspace || t.preventDefault())), _r_();
},
inputKeyPress:function(t) {
_i_("4ab:346"), t.keyCode && r.isNavigation(t.keyCode) || !(t.which < 48 || t.which > 57) || (this.inputMoveAdjacent(t, 1, {
automatic:!0,
force:!0
}), t.preventDefault()), _r_();
},
startEditing:function() {
_i_("4ab:347"), setTimeout(function() {
_i_("4ab:502"), this.model.dates.startEditing(), _r_();
}.bind(this)), this.render(), _r_();
},
setDateFragment:function(t, e) {
_i_("4ab:348"), e = "" === e ? null :+e, "month" === t && null !== e && (e -= 1), this.model.dates.setEditingFragment(this.options.modelMode, t, e), _r_();
},
adjustDateFragment:function(t, e, i) {
_i_("4ab:349"), e = "" === e ? 0 :+e, "month" === t && (e -= 1), this.model.dates.adjustEditingFragment(this.options.modelMode, t, e, i), _r_();
},
apply:function() {
_i_("4ab:350"), this.model.dates.applyEditing(this.options.modelMode), _r_();
},
render:function() {
_i_("4ab:351");
var t = this.$field.hasClass("-editing"), e = this.model.dates.get(), i = this.$inputYear.val(), n = this.$inputMonth.val(), s = this.$inputDay.val(), r = e[this.options.modelMode], o = e["editing_" + this.options.modelMode] || {}, _ = o.year, l = o.month, h = o.day, d = "date_with_weekday";
i = "" === i ? null :+i, n = "" === n ? null :+n, s = "" === s ? null :+s, _ = "number" == typeof _ ? _ :null, l = "number" == typeof l ? l + 1 :null, h = "number" == typeof h ? h :null, t != this.state.editing && (t = this.state.editing, this.$field.toggleClass("-editing", t)), i !== _ && (this.$inputYear.val(_), "year" === this.state.currentField && this.$inputYear.select()), n !== l && (this.$inputMonth.val(l), "month" === this.state.currentField && this.$inputMonth.select()), s !== h && (this.$inputDay.val(h), "day" === this.state.currentField && this.$inputDay.select()), t || r || (this.$field.addClass("-empty"), this.$display.html(this.$display.attr("data-placeholder")), this.$iconDay.html(this.$iconDay.attr("data-placeholder"))), !t && r && (this.$field.removeClass("-empty"), d = this.$display.data("date-format") || d, this.$display.html(a.format(r, d)), this.$iconDay.html(a.format(r, "{day_of_month}"))), _r_();
},
updateFocusClass:function() {
_i_("4ab:352"), setTimeout(function() {
_i_("4ab:503");
var t = this.$el.parent(), e = this.state.editing, i = !t.hasClass("c2-wrapper-s-hidden");
e || i ? this.$el.addClass("-focus") :this.$el.removeClass("-focus"), _r_();
}.bind(this), 100), _r_();
}
}), _r_();
}), B.define("search/dates/util", function(t, e, i) {
_i_("4ab:21"), i.exports = {
formatDate:function(t) {
_i_("4ab:170");
var e = new Date(t), i = "" + (e.getMonth() + 1), n = "" + e.getDate(), s = e.getFullYear();
return i.length < 2 && (i = "0" + i), n.length < 2 && (n = "0" + n), _r_([ s, i, n ].join("-"));
},
addDay:function(t) {
_i_("4ab:171");
var e = new Date(t);
return e.setDate(e.getDate() + 1), _r_(e);
},
substractDay:function(t) {
_i_("4ab:172");
var e = new Date(t);
return e.setDate(e.getDate() - 1), _r_(e);
},
daysBetween:function(t, e) {
_i_("4ab:173"), t = new Date(t), e = new Date(e);
var i = 864e5, n = t.getTime(), s = e.getTime(), a = Math.abs(n - s);
return _r_(Math.round(a / i));
}
}, _r_();
}), B.define("search/dates/date-prices-service", function(t, e, i) {
_i_("4ab:22");
var n = t("promise"), s = t("fragment"), a = t("search/dates/util"), r = {
getGroupInformation:function() {
_i_("4ab:174");
var t = 2, e = 0, i = !1, n = B.env.b_group_rooms_wanted || 1;
return B.env.b_group && B.env.b_group[0] && B.env.b_group[0].guests && (t = B.env.b_group[0].guests, e = B.env.b_group[0].children || 0, B.env.b_group[0].children_ages && (i = B.env.b_group[0].children_ages)), _r_({
adults:t,
children:e,
ages:i,
rooms:n
});
},
getPrices:function(t) {
_i_("4ab:175");
var e, i = this.getGroupInformation();
if (t.dates) {
if ("string" == typeof t.model && "av_calendar" === t.model) {
var n = {
hotel_id:t.destinationId,
checkin:t.dates.startFromDay,
n_days:t.days,
result_format:"price_histogram",
no_rooms:i.rooms,
group_adults:i.adults,
group_children:i.children
};
i.ages && (n.age = i.ages), e = s.call("hotel.availability_calendar", n);
} else {
var n = {
dest_type:t.destinationType,
dest_id:t.destinationId,
checkin:t.dates.startFromDay,
n_days:t.days,
adults:i.adults
};
"dots" === t.style && (n.price_indicator = 1), t.months && t.months.length && (n.legend_months = t.months), e = s.call("lp.get_av_calendar_prices", n);
}
return _r_(e.then(function(e) {
if (_i_("4ab:487"), !e || !e.dates && !e.days) return _r_({
data:t.datesData,
legends:t.legends
});
var i = e.dates || e.days, n = {
data:t.datesData.concat(i)
};
return t.months && t.months.length && e.legends ? (n.legends = e.legends, t.cacheObject.monthLenged[t.months.join("-")] = e.legends, t.cacheObject.monthLenged[t.months[0]] = e.legends, t.cacheObject.monthLenged[t.months[1]] = e.legends) :n.legends = t.legends, _r_(n);
}));
}
return _r_({
data:t.datesData,
legends:t.legends
});
},
getPricesFromCache:function(t, e) {
_i_("4ab:176");
var i = e, s = e.monthLenged = e.monthLenged || {};
return t.cacheObject = e, _r_(new n(function(e, n) {
_i_("4ab:488");
var r, o, _ = new Date(t.dates.startFromDay), l = new Date(t.dates.endUntilDay), h = t.datesData;
if (t.months && t.months.length) {
var d = t.months.join("-");
s[d] ? t.legends = s[d] :s[t.months[0]] ? t.legends = s[t.months[0]] :s[t.months[1]] && (t.legends = s[t.months[1]]);
} else t.legends = {};
for (;l >= _ && (r = i[a.formatDate(_)]); ) h.push(r), _ = a.addDay(_);
if (_ >= l) return t.dates = !1, _r_(e($.extend(t, {
dates:t.dates,
datesData:h
})));
for (t.dates.startFromDay = a.formatDate(a.substractDay(_)), o = new Date(t.dates.startFromDay), _ = new Date(t.dates.endUntilDay); _ >= o && (r = i[a.formatDate(_)]); ) h.push(r), _ = a.substractDay(_);
return o >= _ ? t.dates = !1 :(t.dates.endUntilDay = a.formatDate(a.addDay(_)), t.days = a.daysBetween(t.dates.startFromDay, t.dates.endUntilDay)), _r_(e($.extend(t, {
dates:t.dates,
datesData:h
})));
}.bind(this)));
},
getDatesToQuery:function(t, e) {
_i_("4ab:177");
var i = new Date(t), n = new Date(t), s = i.getMonth() + 1, r = s + 1 === 13 ? 1 :s + 1;
return n.setDate(n.getDay() + e.daysToDisplay), _r_({
startFromDay:a.formatDate(i),
endUntilDay:a.formatDate(n),
months:[ s, r ]
});
}
};
i.exports = r, _r_();
}), B.define("search/dates/date-prices", function(t, e, i) {
_i_("4ab:23");
var n = t("component"), s = t("search/dates/date-prices-service"), a = B.utils.accounting.formatMoney, r = t("search/dates/util"), o = "UBKeJbLYQCLBMJFUWOEQeRe", _ = t("et"), l = {
daysToDisplay:62,
style:"numbers"
}, h = {}, d = {}, c = {}, u = /^(city|country|district|region|hotel)$/;
booking.jstmpl("search_calendar_date_prices", function() {
_i_("4ab:114");
var t = [ "\n		", '<span class="sb-date-prices-footer">\n	', "\n		<span>\n			", "/private/sxp_sbox_calendar_lowest_prices_only/name", "\n		</span>\n		", '\n			<span class="sb-date-prices-footer-legend">\n				<i class="c2-price-dot __green"></i> ', "-", "\n			</span>\n		", '\n			<span class="sb-date-prices-footer-legend">\n				<i class="c2-price-dot __yellow"></i> ', '\n			<span class="sb-date-prices-footer-legend">\n				<i class="c2-price-dot __red"></i> ', "+\n			</span>\n		", "\n	", "\n</span>\n" ], e = [ "legends" ];
return _r_(function(i) {
_i_("4ab:439");
var n = "", s = this.fn;
function a(i) {
return _i_("4ab:454"), i += t[1], s.MD(e[0]) && (i += [ t[2], s.ME(t[3], s.MB, s.MN, null), t[4] ].join(""), s.MJ(s.MG((s.MC(e[0]) || {}).low)) && (i += [ t[5], ((s.MC(e[0]) || {}).low || [])[0], t[6], ((s.MC(e[0]) || {}).low || [])[1], t[7] ].join("")), i += t[0], s.MJ(s.MG((s.MC(e[0]) || {}).medium)) && (i += [ t[8], ((s.MC(e[0]) || {}).medium || [])[0], t[6], ((s.MC(e[0]) || {}).medium || [])[1], t[7] ].join("")), i += t[0], s.MJ(s.MG((s.MC(e[0]) || {}).high)) && (i += [ t[9], ((s.MC(e[0]) || {}).high || [])[0], t[10] ].join("")), i += t[11]), i += t[12], _r_(i);
}
return n += t[0], n = a(n), n += t[11], _r_(n);
});
}());
var p = n.extend({
init:function(t) {
_i_("4ab:353"), this.options = Object.assign({}, l, t), this.model || (this.model = t.model, this.hash = t.trackHash || o, this.model.use && (this.model.use("destination"), u = /^(city|country|district|region)$/), t.variant ? (this.initParameters(), this.bindEvents()) :(this.initParameters(), this.initTrackingOnly())), _r_();
},
initParameters:function() {
_i_("4ab:354"), ("index" !== B.env.b_action || B.env.b_cal_dest_id || B.env.b_cal_dest_type) && parseInt(B.env.b_cal_dest_id, 10) && B.env.b_cal_dest_type && B.env.b_cal_dest_type.match(u) ? (this.destinationId = parseInt(B.env.b_cal_dest_id, 10), this.destinationType = B.env.b_cal_dest_type, $(".c2-wrapper").removeClass("calendar-no-prices")) :this.resetParameters(), _r_();
},
resetParameters:function() {
_i_("4ab:355"), this.destinationId = !1, this.destinationType = !1, $(".c2-wrapper").addClass("calendar-no-prices"), _r_();
},
bindEvents:function() {
_i_("4ab:356"), B.eventEmitter.on("CALENDAR:shown CALENDAR:previousclick CALENDAR:nextclick", this.onCalendarShown.bind(this)), this.model.on && this.model.on("change", this.modelChange.bind(this)), _r_();
},
modelChange:function(t) {
_i_("4ab:357"), t && t.group && "destination" == t.group && (this.cleanPrices(), t = this.model.destination.get(), parseInt(t.dest_id, 10) && t.dest_type && t.dest_type.match(u) ? (this.destinationId = parseInt(t.dest_id), this.destinationType = t.dest_type, $(".c2-wrapper").removeClass("calendar-no-prices")) :this.resetParameters()), _r_();
},
initTrackingOnly:function() {
_i_("4ab:358"), B.eventEmitter.on("CALENDAR:shown CALENDAR:previousclick CALENDAR:nextclick", this.trackStage.bind(this)), this.model.on && this.model.on("change", this.modelChange.bind(this)), _r_();
},
trackStage:function(t, e) {
if (_i_("4ab:359"), !e || !e.instance || !e.instance.options) return _r_();
if (!this.destinationId || !this.destinationType) return _r_();
if ("string" == typeof this.model && this.model !== e.instance.options.category) return _r_();
switch (_.stage(this.hash, 1), B.env.b_action) {
case "index":
_.stage(this.hash, 2), B.env.b_is_domestic && _.stage(this.hash, 3);
break;

case "searchresults":
_.stage(this.hash, 4), B.env.b_is_domestic && _.stage(this.hash, 3);
break;

case "hotel":
B.env.b_has_valid_dates_not_in_past && B.env.b_availability_checked && _.stage(this.hash, 2), B.env.b_has_valid_dates_not_in_past && !B.env.b_availability_checked && _.stage(this.hash, 3), B.env.b_has_valid_dates_not_in_past || _.stage(this.hash, 4), B.env.b_has_valid_dates_not_in_past && B.env.b_checkin_date && (r.daysBetween(new Date(), B.env.b_checkin_date) >= 7 ? _.stage(this.hash, 5) :_.stage(this.hash, 6));
}
_r_();
},
onCalendarShown:function(t, e) {
if (_i_("4ab:360"), !e || !e.instance || !e.instance.options) return _r_();
if (!this.destinationId || !this.destinationType) return _r_();
if ("string" == typeof this.model && this.model !== e.instance.options.category) return _r_();
this.trackStage(t, e);
var i = e.instance, n = s.getDatesToQuery(i.getCurrentMonthUtc(), this.options);
this.showLoading(i), s.getPricesFromCache({
dates:n,
datesData:[],
months:n.months,
days:this.options.daysToDisplay,
destinationId:this.destinationId,
destinationType:this.destinationType,
model:this.model,
style:this.options.style
}, d).then(s.getPrices.bind(s)).then(this.displayPrices.bind(this, i, n)).then(this.hideLoading.bind(this, i))["catch"](this.hideLoading.bind(this, i)), _r_();
},
updateCalendarFooter:function(t, e) {
_i_("4ab:361");
var i = B.jstmpl("search_calendar_date_prices").render({
legends:e
});
t.$element.find(".sb-date-prices-footer").remove(), t.$element.find(".c2-calendar-footer").append(i), _r_();
},
cleanPrices:function() {
_i_("4ab:362"), d = {}, c = {}, $(".c2-day-price-ready").each(function() {
_i_("4ab:479"), $(this).removeClass("c2-day-price-ready").data("day-price", "").html('<i class="bicon bicon-search"></i>'), _r_();
}), $(".sb-date-prices-footer").html(""), _r_();
},
displayPrices:function(t, e, i) {
_i_("4ab:363");
var n, s, o, _ = 0, l = 0, h = t.$screen, u = t.id();
i && i.data || this.hideLoading(t);
var p = i.data;
this.updateCalendarFooter(t, i.legends), c[u] = c[u] || {};
for (var f = 0; f < p.length; f++) {
if (p[f].error || !p[f].avg_price_raw) continue;
if (n = new Date(p[f].checkin), o = r.formatDate(n), c[u][o]) continue;
if (d[o] = p[f], c[u][o] = !0, l = Math.floor(parseInt(p[f].avg_price_raw, 10)), "dots" === this.options.style) {
if (_ = "", !p[f].price_indicator) continue;
var b = "";
switch (p[f].price_indicator) {
case 1:
b = "__green";
break;

case 2:
b = "__yellow";
break;

case 3:
b = "__red";
}
_ = '<div class="c2-price-dot ' + b + '"></div>';
} else _ = p[f].avg_price_pretty, _ = a(l, B.env.b_selected_currency);
if (!_) break;
s = h.find("[data-id=" + n.getTime() + "]").find(".c2-day-price"), s.length && s.hasClass("c2-day-price-ready") || (s.addClass("c2-day-price-ready"), s.data("day-price", l), s.html(_));
}
_r_();
},
hideLoading:function(t) {
_i_("4ab:364"), t.$header.find(".c2-progress-bar-inner").removeClass("c2-progress-bar-animation"), _r_();
},
showLoading:function(t) {
_i_("4ab:365"), t.$header.find(".c2-progress-bar-inner").addClass("c2-progress-bar-animation"), _r_();
},
isAvCalendar:function(t) {
return _i_("4ab:366"), _r_("hotel" === B.env.b_action && t && t.instance && t.instance.options && "av_calendar" === t.instance.options.category);
}
});
i.exports = {
getInstance:function(t) {
return _i_("4ab:178"), t = t || "searchbox", h[t] || (h[t] = new p()), _r_(h[t]);
}
}, _r_();
}), B.define("component/search/dates/dates-errors", function(t, e, i) {
"use strict";
_i_("4ab:24");
var n = t("component"), s = t("jstmpl"), a = t("read-data-options"), r = t("search/searchbox/model");
i.exports = n.extend({
init:function() {
_i_("4ab:367"), this.options = a(this.el, {
modelId:{
name:"sb-id",
type:String,
required:!0
}
}), this.model = r.getInstance(this.options.modelId), this.model.use("dates"), this.model.on("validation", this.modelValidation.bind(this)), this.template = s("fe_search_dates_errors"), _r_();
},
modelValidation:function(t) {
if (_i_("4ab:368"), "dates" !== t.group) return _r_();
var e = a(this.el, {
viewId:{
name:"view-id",
type:String,
defaultValue:""
}
});
t.valid ? this.$el.html("") :this.$el.html(this.template.render({
fe_error:t.validationError,
fe_new:!0,
fe_view:e.viewId
})), _r_();
}
}), _r_();
}), booking.jstmpl("search_dates_length_of_stay", function() {
_i_("4ab:39");
var t, e = [ "\n		", "\n\n", "\n\n    ", "\n        ", "\n    ", '\n\n    <div\n      class="sb-dates__los\n      ', " sb-dates__los--bold\n      ", '\n      ">\n\n      \n      ', '\n          <i class="bicon bicon-halfmoon sb_dates__los__icon"></i>\n          <span class="sb-dates__los__text">\n      ', "\n\n        ", "\n          ", "/private/bh_gf_sbox_general_dates_num_nights_1/name", "/private/sbox_general_dates_num_nights_1/name", "\n      ", "\n         </span>\n      ", "\n    </div>\n", '\n    <div class="sb-dates--los-placeholder"></div>\n', "\n", "\n	" ], i = [ "b_action", "fe_sb_los_bold", "fe_sb_state_length_of_stay", "fe_is_family", "b_search_config" ];
return _r_(function(n) {
_i_("4ab:105");
var s = "", a = this.fn;
function r(s) {
return _i_("4ab:179"), s += e[1], a.MJ(a.MB(i[2])) ? (s += e[2], a.MJ(a.MB(i[1]) + "" == "") && (s += e[3], a.MN("fe_sb_los_bold", a.MJ(a.MC(i[0]) + "" == "hotel") && a.track_experiment("AEJPOTIKSBOEQC")), s += e[4]), s += e[5], a.MD(i[1]) && (s += e[6]), s += e[7], a.MD(i[1]) && (s += e[8]), s += e[9], s += a.MJ(a.MB(i[3])) || a.MJ(a.MC(i[4])) && a.MJ(a.MC(i[4]).b_children_total) ? [ e[10], (n.unshift({
num_nights:a.MB(i[2])
}), t = a.ME(e[11], a.MB, a.MN, a.MO(a.MC(i[2]), null, e[11])), n.shift(), t), e[3] ].join("") :[ e[10], (n.unshift({
num_nights:a.MB(i[2])
}), t = a.ME(e[12], a.MB, a.MN, a.MO(a.MC(i[2]), null, e[12])), n.shift(), t), e[3] ].join(""), s += e[13], a.MD(i[1]) && (s += e[14]), s += e[15]) :s += e[16], s += e[17], _r_(s);
}
return s += e[0], s = r(s), s += e[18], _r_(s);
});
}()), B.define("component/search/dates/length-of-stay", function(t, e, i) {
_i_("4ab:25");
var n = t("calendar-base").Calendar, s = t("component"), a = t("read-data-options"), r = t("search/searchbox/model");
i.exports = s.extend({
init:function() {
_i_("4ab:369"), this.options = a(this.$el, {
modelId:{
name:"sb-id",
type:String,
required:!0
},
isAvailability:{
name:"is-availability",
type:Boolean
}
}), this.model = r.getInstance(this.options.modelId), this.model.use("dates"), this.model.use("group"), this.model.on("change", this.modelChange.bind(this)), this.state = {};
var t = "hotel" === B.env.b_action && B.et.track("AEJPOTIKSBOEQC");
t && (this.state.fe_sb_los_bold = 1), this.template = B.jstmpl("search_dates_length_of_stay"), _r_();
},
modelChange:function(t) {
if (_i_("4ab:370"), !t || "dates" != t.group && "group" != t.group) return _r_();
this.render(), _r_();
},
render:function() {
_i_("4ab:371");
var t = this.model.dates.get(), e = this.model.group.get();
this.state.fe_is_family = e.children_ages && e.children_ages.length > 0 ? 1 :0, this.state.fe_is_availability = this.options.isAvailability, this.state.fe_sb_state_length_of_stay = !t.editing && t.checkin && t.checkout && n.diff(t.checkout, t.checkin) > 0 ? n.interval(t.checkin, t.checkout) - 1 :"", this.$el.html(this.template.render(this.state)), _r_();
}
}), _r_();
}), B.define("search/dates/date-public-holidays", function(t, e, i) {
_i_("4ab:26");
var n = t("component"), s = t("fragment"), a = t("search/dates/util"), r = {}, o = "AEJPAaNCWQQDQZJZGZVSBYQeRe", _ = null;
booking.jstmpl("search_calendar_date_public_holidays", function() {
_i_("4ab:115");
var t, e = [ "\n		", '<div class="sb-date-public-holidays">\n	<i class="sb-date-public-holidays__indicator"></i>\n	<span class="sb-date-public-holidays__single hidden">\n		', "/private/lp_sb_calendar_dates_public_holiday_one_date/name", '\n	</span>\n	<span class="sb-date-public-holidays__multiple hidden">\n		', "/private/lp_sb_calendar_dates_public_holiday_multiple/name", "\n	</span>\n</div>", "\n	" ], i = [ "country_name", "country_name_in" ];
return _r_(function(n) {
_i_("4ab:440");
var s = "", a = this.fn;
function r(s) {
return _i_("4ab:455"), s += [ e[1], (n.unshift({
country_name:a.MB(i[0]),
country_name_in:a.MB(i[1])
}), t = a.ME(e[2], a.MB, a.MN, null), n.shift(), t), e[3], (n.unshift({
country_name:a.MB(i[0]),
country_name_in:a.MB(i[1])
}), t = a.ME(e[4], a.MB, a.MN, null), n.shift(), t), e[5] ].join(""), _r_(s);
}
return s += e[0], s = r(s), s += e[6], _r_(s);
});
}());
var l = n.extend({
init:function(t) {
_i_("4ab:372"), !this.model && t.model && (this.model = t.model), B.eventEmitter.on("CALENDAR:shown", this.onCalendarShown.bind(this)), B.eventEmitter.on("CALENDAR:nextclick", this.onCalendarNextClick.bind(this)), B.eventEmitter.on("CALENDAR:previousclick", this.onCalendarNextClick.bind(this)), this.model.on("init", this.onCalendarRangeSelected.bind(this)), this.model.on("change", this.onCalendarRangeSelected.bind(this)), _r_();
},
onCalendarShown:function(t, e) {
if (_i_("4ab:373"), !e || !e.instance || !e.instance.options) return _r_();
this.getPublicHolidays().then(this.render.bind(this, e)), _r_();
},
onCalendarNextClick:function(t, e) {
if (_i_("4ab:374"), !e || !e.instance || !e.instance.options) return _r_();
this.getPublicHolidays().then(this.updateLegend.bind(this, e)), _r_();
},
onCalendarPrevClick:function(t, e) {
if (_i_("4ab:375"), !e || !e.instance || !e.instance.options) return _r_();
this.getPublicHolidays().then(this.updateLegend.bind(this, e)), _r_();
},
onCalendarRangeSelected:function() {
_i_("4ab:376");
var t = this.model.dates.get();
if (!t.checkin || !t.checkout) return _r_();
var e = t.checkin.toNative().getTime(), i = t.checkout.toNative().getTime();
this.getPublicHolidays().then(function(t) {
_i_("4ab:480");
for (var n = 0; n < t.length; n++) {
var s = t[n].getTime(), a = s >= e && i >= s;
if ($(".contains_public_holiday_input").val(a ? 1 :0), a) break;
}
_r_();
}), _r_();
},
getPublicHolidays:function() {
return _i_("4ab:377"), null === _ && (_ = this.requestPublicHolidays()), _r_(_);
},
requestPublicHolidays:function() {
_i_("4ab:378");
var t = B.env.ip_country, e = B.calendar2.checkinOptions, i = e.startDate, n = e.endDate;
if (!(t || i || n)) return _r_();
var r = {
cc1:t,
start_date:a.formatDate(i),
end_date:a.formatDate(n)
};
return _r_(s.call("lp.public_holidays_dates_for_country", r).then(this.normalize.bind(this)));
},
normalize:function(t) {
_i_("4ab:379");
for (var e = [], i = 0; i < t.length; i++) e.push(new Date(t[i]));
return _r_(e);
},
updateLegend:function(t, e) {
_i_("4ab:380");
for (var i = t.instance.$element, n = 0, s = [], a = t.instance.getVisibleMonths(), r = 0; r < a.length; r++) {
var _ = t.instance.months[a[r]];
s.push(_);
}
for (var r = 0; r < e.length; r++) for (var l = e[r], h = 0; h < s.length; h++) {
var _ = s[h];
l.getMonth() === _.month_ && l.getFullYear() === _.year_ && n++;
}
if (n > 0 && B.et.stage(o, 1), 2 > this.model.getFlag("highlight_public_holidays")) return _r_();
if (!i.find(".sb-date-public-holidays").length) {
var d = B.jstmpl("search_calendar_date_public_holidays").render({
public_holidays_amount:n,
country_name:B.env.ph_guest_country_name,
country_name_in:B.env.ph_guest_country_name_in
});
i.find(".c2-calendar-footer").prepend(d);
}
i.find(".sb-date-public-holidays").toggleClass("hidden", 0 === n), i.find(".sb-date-public-holidays__single").toggleClass("hidden", n > 1), i.find(".sb-date-public-holidays__multiple").toggleClass("hidden", 2 > n), _r_();
},
render:function(t, e) {
_i_("4ab:381");
var i = t.instance.$screen;
if (2 === this.model.getFlag("highlight_public_holidays")) for (var n = 0; n < e.length; n++) {
var s = e[n], a = i.find("[data-id=" + s.getTime() + "]");
a.addClass("c2-day-public-holiday");
var r = a.prev(".c2-day-public-holiday");
r.length && (a.addClass("c2-day-public-holiday-ml"), r.addClass("c2-day-public-holiday-mr"));
}
t.instance.adjustHeight(!0), this.updateLegend(t, e), _r_();
}
});
i.exports = {
getInstance:function(t) {
return _i_("4ab:180"), t = t || "searchbox", r[t] || (r[t] = new l()), _r_(r[t]);
}
}, _r_();
}), B.define("search/dates/model", function(t, e, i) {
"use strict";
_i_("4ab:27");
var n = t("calendar-base").Calendar, s = t("search/modules/search-date").SearchDate, a = B.env.b_timestamp, r = B.env.sunday_first, o = B.env.b_search_max_months || 13;
function _(t) {
_i_("4ab:76"), this._model = t, this._data = {
initialized:!1,
checkin:null,
checkout:null,
firstValidDay:null,
lastValidDay:null,
editing:!1,
editing_checkin:null,
editing_checkout:null,
length_of_stay:null,
week_start:r ? 0 :1
}, this._valid = !0, this._validationError = "", this._options = {
maxLos:30,
maxMonths:o,
syncLegacy:!0
};
var e = new Date(1e3 * (a - 39600));
this._data.firstValidDay = s.create({
year:e.getUTCFullYear(),
month:e.getUTCMonth(),
day:e.getUTCDate()
}), this._data.lastValidDay = s.createFlexible({
year:e.getUTCFullYear(),
month:e.getUTCMonth() + this._options.maxMonths,
day:0
}), this._data.firstValidCheckoutDay = s.create({
year:e.getUTCFullYear(),
month:e.getUTCMonth(),
day:e.getUTCDate() + 1
}), this._options.syncLegacy && (this.boundLegacyDateChange = this.legacyDateChange.bind(this), B.eventEmitter.on(B.Search.Events.DATE_CHANGED, this.boundLegacyDateChange)), _r_();
}
$.extend(_.prototype, {
init:function(t) {
_i_("4ab:181");
var e = s.create(t.checkin), i = s.create(t.checkout);
this.validateDate("checkin", e).valid && this.validateDate("checkout", i, {
checkin:e
}).valid && (this.setDate("checkin", e, {
init:!0
}), this.setDate("checkout", i, {
init:!0
}), this.emit("init")), _r_();
},
configure:function(t, e) {
_i_("4ab:182");
var i = this._options.maxMonths, n = this._options.syncLegacy;
void 0 !== e ? this._options[t] = e :"object" == typeof t && $.extend(this._options, t), i != this._options.maxMonths && (this._data.lastValidDay = s.createFlexible({
year:this._data.firstValidDay.year,
month:this._data.firstValidDay.month + this._options.maxMonths,
day:0
})), n !== this._options.syncLegacy && B.eventEmitter[this._options.syncLegacy ? "on" :"off"](B.Search.Events.DATE_CHANGED, this.boundLegacyDateChange), _r_();
},
getOption:function(t) {
return _i_("4ab:183"), _r_(this._options[t]);
},
get:function() {
return _i_("4ab:184"), _r_(this._data);
},
initDate:function(t, e, i) {
_i_("4ab:185"), i = i || {}, i.init = !0;
var n = !1;
if (this._data.initialized) return _r_(!1);
return e && (n = this.setDate(t, e, i)), this["initialized" + t] = !0, this.initializedcheckin && this.initializedcheckout && (this.emit("init"), this._data.initialized = !0), _r_(n);
},
setDate:function(t, e, i) {
_i_("4ab:186"), i = i || {};
var a, r, o, _ = {};
if (e = s.create(e), !this._options.noValidation && !this.validateDate(t, e, {
loose:!0
}).valid) return _r_(!1);
if ("checkin" == t) this._data.checkin = e, r = !0, s.compare(this._data.checkin, this._data.firstValidDay) < 0 && (this._data.checkin = s.create(this._data.firstValidDay)), s.compare(this._data.checkin, this._data.lastValidDay) > 0 && (this._data.checkin = s.createFlexible({
year:this._data.lastValidDay.year,
month:this._data.lastValidDay.month,
day:this._data.lastValidDay.day - 1
})), this._data.checkout ? (a = n.diff(this._data.checkout, e), 0 >= a ? (this._data.checkout = s.createFlexible({
year:e.year,
month:e.month,
day:e.day + 1
}), o = !0) :!this._options.allowMaxLos && a > this._options.maxLos && (this._data.checkout = s.createFlexible({
year:e.year,
month:e.month,
day:e.day + this._options.maxLos
}), o = !0)) :(this._data.checkout = s.createFlexible({
year:e.year,
month:e.month,
day:e.day + 1
}), o = !0); else {
if ("checkout" != t) return _r_(!1);
this._data.checkout = e, o = !0, s.compare(this._data.checkout, this._data.lastValidDay) > 0 && (this._data.checkout = s.create(this._data.lastValidDay)), 0 == s.compare(this._data.checkout, this._data.firstValidDay) && (this._data.checkin = s.create(this._data.firstValidDay), this._data.checkout = s.createFlexible({
year:this._data.firstValidDay.year,
month:this._data.firstValidDay.month,
day:this._data.firstValidDay.day + 1
}), o = !0), this._data.checkin && (a = n.diff(e, this._data.checkin), 0 >= a && (this._data.checkin = null)), this._data.checkin || (this._data.checkin = s.createFlexible({
year:e.year,
month:e.month,
day:e.day - 1
}), r = !0);
}
return r && (this._options.syncLegacy && B.search.setDate_("checkin", this._data.checkin.toString(), {
referrer:"search/dates/model"
}), this._data.editing_checkin = this._data.checkin, _.checkin = !0), o && (this._options.syncLegacy && B.search.setDate_("checkout", this._data.checkout.toString(), {
referrer:"search/dates/model"
}), this._data.editing_checkout = this._data.checkout, _.checkout = !0), (r || o) && (this._data.length_of_stay = this._data.checkin && this._data.checkout && n.interval(this._data.checkin, this._data.checkout) - 1), this._data.editing = !1, i.init || this.emit("change", _), _r_(!0);
},
startEditing:function() {
if (_i_("4ab:187"), this._data.editing) return _r_();
this._data.editing = !0, this.emit("change", {
editing:!0
}), _r_();
},
setEditingFragment:function(t, e, i) {
if (_i_("4ab:188"), "checkin" !== t && "checkout" !== t) throw new TypeError("invalid type");
if ("day" !== e && "month" !== e && "year" !== e) throw new TypeError("invalid fragment");
if ("number" != typeof i && null !== i) throw new TypeError("invalid value");
var n = this._data["editing_" + t] || {}, a = {
year:n.year,
month:n.month,
day:n.day
}, r = {
editing:!0
};
return a[e] = i, this._data.editing = !0, this._data["editing_" + t] = s.create(a), r[t] = !0, this.emit("change", r), _r_(!0);
},
adjustEditingFragment:function(t, e, i, n) {
if (_i_("4ab:189"), "checkin" !== t && "checkout" !== t) throw new TypeError("invalid type");
if ("day" !== e && "month" !== e && "year" !== e) throw new TypeError("invalid fragment");
var s = 1, a = i + n;
return "month" == e ? s = 0 :"year" == e && (s = this._data.firstValidDay.year), s > a && (a = s), _r_(this.setEditingFragment(t, e, a));
},
applyEditing:function(t) {
if (_i_("4ab:190"), "checkin" !== t && "checkout" !== t) throw new TypeError("invalid type");
return this._data["editing_" + t].complete ? _r_(this.setDate(t, this._data["editing_" + t])) :(this.clearDates(), _r_(!0));
},
clearDates:function() {
_i_("4ab:191"), this._data.checkin = null, this._data.checkout = null, this._data.editing = !1, this._data.editing_checkin = null, this._data.editing_checkout = null, this._data.length_of_stay = null, this._options.syncLegacy && (B.search.setDate_("checkin", "", {
referrer:"search/dates/model"
}), B.search.setDate_("checkout", "", {
referrer:"search/dates/model"
})), this.emit("change", {
checkin:!0,
checkout:!0
}), _r_();
},
validate:function(t) {
_i_("4ab:192"), t = t || {};
var e = !0, i = "";
if (!e || !t.notEmpty || this._data.checkin && this._data.checkout || (e = !1, i = "missing-dates"), e && !this._data.checkin && this._data.checkout && (e = !1, i = "missing-checkin"), e && this._data.checkin && !this._data.checkout && (e = !1, i = "missing-checkout"), e && this._data.checkin) {
var n = this.validateDate("checkin", this._data.checkin);
n.valid || (e = n.valid, i = n.validationError);
}
if (e && this._data.checkout) {
var n = this.validateDate("checkout", this._data.checkout);
n.valid || (e = n.valid, i = n.validationError);
}
if (e && t.validateTime) {
var s = new Date(1e3 * B.env.b_timestamp), a = s.getUTCDate(), r = s.getUTCMonth(), o = s.getUTCFullYear(), _ = s.getHours() + 2;
(!this._data.checkin || this._data.checkin.year === o && this._data.checkin.month === r && this._data.checkin.day == a) && this._data.checkinTime <= _ && (e = !1, i = "past-time");
}
return t.checkOnly || this._valid == e || (this._valid = e, this._validationError = i, this.emit("validation", {
valid:e,
validationError:i
})), _r_(e);
},
validateDate:function(t, e, i) {
_i_("4ab:193"), i = i || {}, i.checkin = i.checkin || this._data.checkin;
var a = null;
if (!t || "checkin" != t && "checkout" != t) return _r_({
valid:!1,
validationError:"invalid-data"
});
if (!e || void 0 === e.year || void 0 === e.month || void 0 === e.day || isNaN(e.year) || isNaN(e.month) || isNaN(e.day)) return _r_({
valid:!1,
validationError:"invalid-data"
});
if ("checkin" == t && s.compare(e, this._data.firstValidDay) < 0 || "checkout" == t && 0 == s.compare(e, this._data.firstValidDay)) return _r_({
valid:!1,
validationError:"past"
});
if ("checkout" == t && i.checkin && (a = n.diff(e, i.checkin)), null !== a) {
if (0 == a) return _r_({
valid:!1,
validationError:"more-than-one-day"
});
if (0 > a) return _r_({
valid:!1,
validationError:"negative-period"
});
if (a > this._options.maxLos) return _r_({
valid:!1,
validationError:"exceeds-max-los"
});
}
return _r_({
valid:!0,
validationError:""
});
},
legacyDateChange:function(t, e) {
_i_("4ab:194");
var i, n;
if ("search/dates/model" == e.referrer) return _r_();
i = "checkin" == e.type ? "checkin" :"checkout", n = s.createFromString(e.value.toString()), this.setDate(i, n), _r_();
},
emit:function(t, e) {
_i_("4ab:195"), e = e || {}, this._model.emit(t, $.extend(e, {
group:"dates"
})), _r_();
},
getFallbackDates:function(t) {
_i_("4ab:196");
var e, i;
return i = "checkin" === t ? B.env.b_checkin_date :B.env.b_checkout_date, i && (i = i.split("-"), e = {
year:parseInt(i[2], 10),
month:parseInt(i[1], 10),
day:parseInt(i[0], 10)
}), _r_(e || {});
}
}), i.exports = _, _r_();
}), booking.jstmpl("fe_search_dates_errors", function() {
_i_("4ab:40");
var t = [ "\n	", "\n\n		", "\n			", "\n				", "/error/checkout_date_invalid/name", "/error/checkin_date_invalid/name", "/private/sbox_error_checkin_future/name", "/error/checkin_date_to_far_in_the_future/name", "/private/sbox_error_checkout_after/name", "/private/sbox_error_30_night_res/name", "\n		", "\n					", "/private/iq_sbox_error_flights_return_date_invalid/name", "/private/iq_sbox_error_flights_departure_date_invalid/name", "/private/iq_sbox_error_dates/name", "/private/iq_sbox_error_flights_departure_date_too_far_future/name", "/private/iq_sbox_error_flights_return_after_departure/name", "\n	\n		", "/private/iq_sbox_error_cars_arrival_date_invalid/name", "/private/iq_sbox_error_cars_departure_date_invalid/name", "/private/iq_sbox_error_cars_departure_date_too_far_future/name", "/private/iq_sbox_error_cars_arrival_after_departure/name", "/private/iq_sbox_error_cars_1_hour_future/name", "\n\n\n\n\n\n", "\n\n    ", "\n        ", "data-", '="', '"', "\n    ", " data-", '<div data-component="onview-animate" data-anim-type="fadeInBottom"> ', '<div class="fe_banner ', "fe_banner__scale_small ", "fe_banner__w-icon ", "fe_banner__w-dismiss ", "fe_banner__", " ", "fe_banner__w-icon-", "fe_banner__bp fe_banner__inherit_font_size ", ' " ', 'id="', '" ', 'role="alert"', 'data-et-view="', ':1" ', "> ", '<i class="fe_banner__icon ', '" aria-hidden="true"></i> ', '<img class="fe_banner__icon" src="', '"> ', '<span class="fe_banner__icon"> ', " </span> ", '<div class="popular_dates__container"> <div class="popular_dates__calendar"> <div class="popular_dates__month">', '</div> <div class="popular_dates__day">', '</div> </div> <div class="popular_dates__calendar"> <div class="popular_dates__month">', "</div> </div> </div> ", '<div class="fe_banner__btn_container"> <div class="fe_banner__btn_container_content"> ', '<h3 class="fe_banner__title"> ', " </h3> ", '<div class="fe_banner__message ', "fe_banner__genius-trial", " </div> ", '</div> <div class="fe_banner__button"> ', "</div> ", '<span class="fe_banner__dismiss js-close"><i class="bicon-btnclose" aria-label="close"></i></span> ', '<form action="', "/genius_activate_trial", '" class="fe_banner__genius-banner-form" method="post"> <input type="hidden" name="return_url" value="', '"> <input type="hidden" name="src" value="hp_banner"> <input type="hidden" name="campaign_id" value="', '"> <input type="submit" class="button fe_banner__genius-banner-button" value="', '"> </form> ', "\n", "\n\n\n\n", "\n\n", "\n\n\n", "0", "red" ], e = [ "fe_error_message", "fe_error", "s_raw_param_errorc_checkout_date_invalid", "s_raw_param_errorc_checkin_date_invalid", "s_raw_param_errorc_checkin_date_in_the_past", "s_raw_param_errorc_checkin_date_to_far_in_the_future", "s_raw_param_errorc_checkout_date_not_after_checkin_date", "s_raw_param_errorc_checkout_date_more_than_30_days_after_checkin", "fe_view", "fe_banner__data", "fe_banner__data_id", "fe_banner__data_value", "fe_banner__data_id_2", "fe_banner__data_value_2", "fe_banner__data_id_3", "fe_banner__data_value_3", "fe_banner__data_id_4", "fe_banner__data_value_4", "fe_banner__data_id_5", "fe_banner__data_value_5", "fe_banner__animate", "fe_banner__scale", "fe_banner__icon_class", "fe_banner__icon_img_url", "fe_banner__icon_svg", "fe_banner__close_button", "fe_banner__color_scheme", "fe_banner__color_scheme_classes", "fe_banner__icon_size", "b_action", "fe_banner__exp_ot_d_sr_reduce_soldout_ws_class", "fe_banner__extra_classes", "fe_banner__id", "fe_banner__aria_alert", "fe_banner__dates", "b_checkin_month_short_name", "b_checkin_day", "b_checkout_month_short_name", "b_checkout_day", "fe_banner__btn_include", "fe_banner__title_text", "fe_banner__start_genius_trial", "fe_banner__message_text", "b_secure_hostname", "b_query_params_with_lang", "b_original_url", "fe_ge_trial_desktop_campaign_id", "ge_expand_hp_trial_sidebar_cta", "fe_banner__banners_count" ];
return _r_(function(i) {
_i_("4ab:106");
var n = "", s = this.fn;
function a(n) {
if (_i_("4ab:197"), s.MJ(s.MB(e[1])) || s.MJ(s.MC(e[2])) || s.MJ(s.MC(e[3])) || s.MJ(s.MC(e[4])) || s.MJ(s.MC(e[5])) || s.MJ(s.MC(e[6])) || s.MJ(s.MC(e[7]))) {
n += t[1];
var a = "";
if (a += t[2], s.MJ(s.MB(e[1]) + "" == "missing-checkout") || s.MJ(s.MC(e[2])) ? a += [ t[3], s.ME(t[4], s.MB, s.MN, null), t[2] ].join("") :s.MJ(s.MB(e[1]) + "" == "missing-checkin") || s.MJ(s.MC(e[3])) ? a += [ t[3], s.ME(t[5], s.MB, s.MN, null), t[2] ].join("") :s.MJ(s.MB(e[1]) + "" == "past") || s.MJ(s.MC(e[4])) ? a += [ t[3], s.ME(t[6], s.MB, s.MN, null), t[2] ].join("") :s.MJ(s.MB(e[1]) + "" == "checkin_date_to_far_in_the_future") || s.MJ(s.MC(e[5])) ? a += [ t[3], s.ME(t[7], s.MB, s.MN, null), t[2] ].join("") :s.MJ(s.MB(e[1]) + "" == "negative-period") || s.MJ(s.MC(e[6])) ? a += [ t[3], s.ME(t[8], s.MB, s.MN, null), t[2] ].join("") :s.MJ(s.MB(e[1]) + "" == "exceeds-max-los") || s.MJ(s.MC(e[7])) ? a += [ t[3], s.ME(t[9], s.MB, s.MN, null), t[2] ].join("") :s.MJ(s.MB(e[1])) && (a += [ t[3], s.ME(t[5], s.MB, s.MN, null), t[2] ].join("")), a += t[10], s.MN(e[0], a), n += t[1], s.MJ(s.MB(e[8]) + "" == "flights")) {
n += t[2];
var a = "";
a += t[3], s.MJ(s.MB(e[1]) + "" == "missing-checkout") ? a += [ t[11], s.ME(t[12], s.MB, s.MN, null), t[3] ].join("") :s.MJ(s.MB(e[1]) + "" == "missing-checkin") ? a += [ t[11], s.ME(t[13], s.MB, s.MN, null), t[3] ].join("") :s.MJ(s.MB(e[1]) + "" == "past") ? a += [ t[11], s.ME(t[14], s.MB, s.MN, null), t[3] ].join("") :s.MJ(s.MB(e[1]) + "" == "checkin_date_to_far_in_the_future") ? a += [ t[11], s.ME(t[15], s.MB, s.MN, null), t[3] ].join("") :s.MJ(s.MB(e[1]) + "" == "negative-period") ? a += [ t[11], s.ME(t[16], s.MB, s.MN, null), t[3] ].join("") :s.MJ(s.MB(e[1]) + "" == "missing-dates") ? a += [ t[11], s.ME(t[13], s.MB, s.MN, null), t[3] ].join("") :s.MJ(s.MB(e[1])) && (a += [ t[11], s.ME(t[13], s.MB, s.MN, null), t[3] ].join("")), a += t[2], s.MN(e[0], a), n += t[10];
}
if (n += t[17], s.MJ(s.MB(e[8]) + "" == "rentalcars")) {
n += t[2];
var a = "";
a += t[3], s.MJ(s.MB(e[1]) + "" == "missing-checkout") ? a += [ t[11], s.ME(t[18], s.MB, s.MN, null), t[3] ].join("") :s.MJ(s.MB(e[1]) + "" == "missing-checkin") ? a += [ t[11], s.ME(t[19], s.MB, s.MN, null), t[3] ].join("") :s.MJ(s.MB(e[1]) + "" == "past") ? a += [ t[11], s.ME(t[14], s.MB, s.MN, null), t[3] ].join("") :s.MJ(s.MB(e[1]) + "" == "checkin_date_to_far_in_the_future") ? a += [ t[11], s.ME(t[20], s.MB, s.MN, null), t[3] ].join("") :s.MJ(s.MB(e[1]) + "" == "negative-period") ? a += [ t[3], s.ME(t[21], s.MB, s.MN, null), t[3] ].join("") :s.MJ(s.MB(e[1]) + "" == "missing-dates") ? a += [ t[11], s.ME(t[19], s.MB, s.MN, null), t[3] ].join("") :s.MJ(s.MB(e[1]) + "" == "past-time") ? a += [ t[11], s.ME(t[22], s.MB, s.MN, null), t[3] ].join("") :s.MJ(s.MB(e[1])) && (a += [ t[11], s.ME(t[19], s.MB, s.MN, null), t[3] ].join("")), a += t[2], s.MN(e[0], a), n += t[10];
}
n += t[1], i.unshift({
fe_banner__close_button:t[76],
fe_banner__color_scheme:t[77],
fe_banner__message_text:s.MB(e[0])
}), n = r(n), i.shift(), n += t[74];
}
return n += t[72], _r_(n);
}
function r(i) {
if (_i_("4ab:198"), i += t[23], s.MD(e[42])) {
i += t[24], s.MD(e[10]) && (i += t[25], s.MN(e[9], [ t[26], s.MB(e[10]), t[27], s.MB(e[11]), t[28] ].join("")), i += t[29]), i += t[24], s.MD(e[12]) && (i += t[25], s.MN(e[9], [ s.MB(e[9]), t[30], s.MB(e[12]), t[27], s.MB(e[13]), t[28] ].join("")), i += t[29]), i += t[24], s.MD(e[14]) && (i += t[25], s.MN(e[9], [ s.MB(e[9]), t[30], s.MB(e[14]), t[27], s.MB(e[15]), t[28] ].join("")), i += t[29]), i += t[24], s.MD(e[16]) && (i += t[25], s.MN(e[9], [ s.MB(e[9]), t[30], s.MB(e[16]), t[27], s.MB(e[17]), t[28] ].join("")), i += t[29]), i += t[24], s.MD(e[18]) && (i += t[25], s.MN(e[9], [ s.MB(e[9]), t[30], s.MB(e[18]), t[27], s.MB(e[19]), t[28] ].join("")), i += t[29]), i += t[24], s.MD(e[20]) && (i += t[31]), i += t[32];
var n = s.MB(e[21]);
s.MJ(n + "" == "small") && (i += t[33]), (s.MJ(s.MB(e[22])) || s.MJ(s.MB(e[23])) || s.MJ(s.MB(e[24]))) && (i += t[34]), s.MD(e[25]) && (i += t[35]), s.MJ(s.MB(e[26])) && (i += [ t[36], s.MC(e[26]), s.MC(e[27]), t[37] ].join("")), s.MJ(s.MB(e[22])) && s.MJ(s.MB(e[28])) && (i += [ t[38], s.MC(e[28]), t[37] ].join("")), s.MJ(s.MC(e[29]) + "" == "book") && (i += t[39]), i += [ s.MC(e[30]), t[37], s.MC(e[31]), t[40] ].join(""), s.MD(e[32]) && (i += [ t[41], s.MC(e[32]), t[42] ].join("")), s.MD(e[9]) && (i += [ s.MC(e[9]), t[37] ].join("")), s.MD(e[33]) && (i += t[43]), s.MJ(s.MC(e[29]) + "" == "searchresults") && s.MJ(s.MB(e[34])) && (i += [ t[44], "OLWLfTLDFHBUBMJKDKaT", t[45] ].join("")), i += t[46], s.MD(e[22]) ? i += [ t[47], s.MC(e[22]), t[48] ].join("") :s.MD(e[23]) ? i += [ t[49], s.MC(e[23]), t[50] ].join("") :s.MD(e[24]) ? i += [ t[51], s.MC(e[24]), t[52] ].join("") :s.MJ(s.MB(e[34])) && s.MJ(s.track_experiment("OLWLfTLDFHBUBMJKDKaT")) && (i += [ t[53], s.MC(e[35]), t[54], s.MC(e[36]), t[55], s.MC(e[37]), t[54], s.MC(e[38]), t[56] ].join("")), s.MD(e[39]) && (i += t[57]), s.MD(e[40]) && (i += [ t[58], s.MC(e[40]), t[59] ].join("")), s.MD(e[42]) && (i += t[60], s.MD(e[41]) && (i += t[61]), i += [ t[50], s.MC(e[42]), t[62] ].join("")), s.MD(e[39]) && (i += [ t[63], s.MC(e[39]), t[62] ].join("")), s.MD(e[39]) && (i += t[64]), s.MD(e[25]) && (i += t[65]), s.MD(e[41]) && (i += [ t[66], s.MC(e[43]), t[67], s.MC(e[44]), t[68], s.MC(e[45]), t[69], s.MB(e[46]), t[70], s.MB(e[47]), t[71] ].join("")), i += t[64], s.MD(e[20]) && (i += t[64]), i += t[72];
}
return i += t[73], s.MN(e[26], void 0), i += t[72], s.MN(e[22], void 0), i += t[72], s.MN(e[23], void 0), i += t[72], s.MN(e[24], void 0), i += t[72], s.MN(e[28], void 0), i += t[72], s.MN(e[40], void 0), i += t[72], s.MN(e[42], void 0), i += t[72], s.MN(e[39], void 0), i += t[72], s.MN(e[25], void 0), i += t[72], s.MN(e[32], void 0), i += t[72], s.MN(e[31], void 0), i += t[72], s.MN(e[21], void 0), i += t[74], s.MN(e[10], void 0), i += t[72], s.MN(e[11], void 0), i += t[72], s.MN(e[12], void 0), i += t[72], s.MN(e[13], void 0), i += t[72], s.MN(e[14], void 0), i += t[72], s.MN(e[15], void 0), i += t[72], s.MN(e[16], void 0), i += t[72], s.MN(e[17], void 0), i += t[72], s.MN(e[18], void 0), i += t[72], s.MN(e[19], void 0), i += t[75], s.MN(e[34], void 0), i += t[74], s.MN(e[27], void 0), i += t[74], s.MN(e[9], void 0), i += t[72], s.MN("fe_banner__banners_count", s.MI(s.MB(e[48])) + s.MI(1)), i += t[74], s.MJ(s.MC(e[29]) + "" == "book") && s.MJ(s.track_experiment_stage("bp_banner_module_normalize_banners", 2)) ? i += t[72] :s.MJ(s.track_experiment_stage("bp_banner_module_normalize_banners", 1)) && (i += t[72]), i += t[72], _r_(i);
}
return n += t[0], n = a(n), n += t[72], _r_(n);
});
}()), B.define("component/search/destination/country-only", function(t, e, i) {
"use strict";
_i_("4ab:28");
var n = t("component"), s = t("search/searchbox/model"), a = t("read-data-options");
i.exports = n.extend({
init:function() {
_i_("4ab:382"), this.options = a(this.$el, {
modelId:{
name:"sb-id",
type:String,
required:!0
}
}), this.model = s.getInstance(this.options.modelId), this.model.use("destination"), this.model.on("change", this.modelChange.bind(this)), this.$onlyCurrentCountry = this.$el.find("[data-input]"), this.$onlyCurrentCountry.bind("change", this.onlyCurrentCountryChange.bind(this)), this.modelInit(), _r_();
},
modelInit:function() {
_i_("4ab:383");
var t = this.$onlyCurrentCountry.is(":checked");
this.model.destination.initOnlyCurrentCountry(t), _r_();
},
modelChange:function(t) {
if (_i_("4ab:384"), !t || !t.onlyCurrentCountry) return _r_();
var e = this.$onlyCurrentCountry.is(":checked"), i = this.model.destination.getOnlyCurrentCountry();
e != i && this.$onlyCurrentCountry.prop("checked", i), _r_();
},
onlyCurrentCountryChange:function() {
_i_("4ab:385"), this.model.destination.setOnlyCurrentCountry(this.$onlyCurrentCountry.is(":checked")), _r_();
}
}), _r_();
}), B.define("component/search/group/group", function(t, e, i) {
_i_("4ab:29"), booking.jstmpl("search_group_group_html", function() {
_i_("4ab:116");
var t, e = [ "\n		", "\n\n\n\n\n", "\n", "\n\n\n\n", "\n    ", '\n        <div class="sb-searchbox-children-tooltip">\n            <span class="fly-dropdown-close fly-dropdown-close-icon"></span>\n            <h4 class="sb-searchbox-children-tooltip__title">', "/private/gs_index_model_header_family/name", '</h4>\n            <p class="sb-searchbox-children-tooltip__text">', "/private/gs_index_model_desc_family/name", "</p>\n        </div>\n    ", "\n\n\n", "\n\n", '\n\n\n\n<div class="u-clearfix" data-render>\n  ', '<div class="sb-custom-wrapper">', "\n\n  ", "\n  ", '\n    <div class="sb-group__field sb-group__field-rooms">\n      ', '\n          <label class="sb-searchbox__label sb-group__field__label ', "-inline", " -small ", "no_rooms", '"\n             ', '\n                for="no_rooms_', '"\n              ', '\n               for="no_rooms"\n              ', "\n          >\n              ", "/private/sbox_rooms/name", "\n          </label>\n      ", "\n      ", '<div class="sb-custom-select">', '\n    <select name="no_rooms"\n        ', '\n            id="no_rooms_', '"\n            class="no_rooms"\n        ', '\n            id="no_rooms"\n        ', "\n        data-group-rooms-count\n        ", '\n            aria-label="', "/private/index_sbox_rooms_aria/name", '"\n        ', "\n    >\n        ", '\n            <option value="', '" ', 'selected="selected"', ">\n                ", "/private/search_box_room_filter/name", "\n            </option>\n        ", "\n    </select>\n    ", "</div>", "\n    </div>\n  ", '\n    <input type="hidden" name="no_rooms" value="', '">\n  ', "\n\n\n  ", '\n    <div class="sb-group__field">\n      ', '\n      <label class="sb-searchbox__label sb-group__field__label ', "group_children", '"\n         ', '\n            for="group_adults_', '"\n          ', '\n           for="group_adults"\n          ', "\n       >\n        ", "/private/sbox_adults/name", "/private/bbt_searchbox_travellers/name", "\n      </label>\n      ", '\n  <select\n    name="group_adults"\n    ', '\n        aria-label="', "/private/index_sbox_adults_aria/name", '"\n    ', '\n       id="group_adults_', '"\n       class="group_adults"\n    ', '\n       id="group_adults"\n    ', "\n    data-group-adults-count\n   >\n    ", '\n      <option value="', ">\n        ", "/private/search_box_adults_filter/name", "\n      </option>\n    ", "\n  </select>\n", '\n    <input type="hidden" name="group_adults" value="', '\n      <div class="sb-group__field sb-group-children ', "sb-group-children-universal", '">\n      ', '\n            for="group_children_', '\n           for="group_children"\n          ', "\n          >\n        ", "/private/sbox_children/name", '\n  <select\n    name="group_children"\n    ', "/private/index_sbox_children_aria/name", '\n        id="group_children_', '"\n        class="group_children"\n    ', '\n       id="group_children"\n    ', "\n    data-group-children-count ", 'data-component="search/group/children-ages-tooltip search/group/add-children-tooltip"\n    data-add-children-tooltip="', '"', "\n  >\n    ", "\n          ", "/private/search_box_no_children_filter_default/name", "\n        ", "/private/search_box_children_filter/name", "\n      \n      ", '\n      <div class="sb-group__children__field clearfix">\n        ', '\n        <label class="sb-searchbox__label -small sb-group__children__label">\n          ', "/private/bh_gsb_search_box_checkout_age/name", "/private/bh_gsb_search_box_checkout_age_plural/name", "/private/loc_sbox_children_age_singular/name", "/private/loc_sbox_children_age_plural/name", "\n        </label>\n        ", "\n\n        ", '<div class="sb-group-children-age"><div class="sb-custom-select">', '\n    <select\n      name="age"\n      data-group-child-age="', '"\n      aria-label="', "/private/acc_index_child_age_screenread/name", '"\n    >\n      <option class="sb_child_ages_empty_zero" value="12 ">\n          ', "\n            ", "/private/sxp_index_sbox_age_at_checkout/name", "\n      </option>\n      ", '\n        <option value="', ">\n            ", "\n                ", "/private/sxp_index_sbox_num_years_old/name", "/private/loc_counter_word_child_age_cjk/name", "\n        </option>\n      ", "</div></div>", "\n      </div>\n    ", "\n\n</div>\n", "\n	" ], i = [ "fe_add_children_tooltip", "b_action", "b_search_config", "b_predicted_traveller_type", "fe_sb_universal_design", "fe_sb_group_block_labels", "fe_remove_duplicate_ids", "fe_sb_unique_id", "fe_sb_a11y_group_inputs_aria_labels", "fe_sb_group_max_rooms", "fe_sb_state_number_of_rooms", "fe_sb_group_descriptive_dropdowns", "fe_sb_group_rooms_hide", "fe_sb_width", "fe_sb_group_use_adults_label", "fe_sb_group_max_adults", "fe_sb_state_number_of_adults", "fe_sb_group_adults_hide", "fe_sb_state_number_of_children", "fe_sb_state_rooms", "fe_sb_state_children_ages", "fe_sb_group_has_children", "fe_sb_group_max_children", "fe_sb_group_localized_short_date", "fe_sb_state_checkout", "fe_children_ages", "fe_child_i", "fe_sb_group_max_children_age", "b_lang_is_cjk", "fe_sb_group_children_hide" ];
return _r_(function(n) {
_i_("4ab:441");
var s = "", a = this.fn;
function r(s) {
_i_("4ab:456"), s += e[15];
var r = c, o = h, _ = u, l = d, h = a.MC(i[25]) || [];
n.unshift({
fe_child_age:null
});
for (var d, c = 1, u = h.length; u >= c; c++) {
n[0].fe_child_age = d = h[c - 1], s += e[15], a.MD(i[4]) && (s += e[105]), s += [ e[106], a.F.entities(a.MC(i[26])), e[107], (n.unshift({
child_number:a.MI(a.MB(i[26])) + a.MI(1)
}), t = a.ME(e[108], a.MB, a.MN, null), n.shift(), t), e[109] ].join(""), a.MD(i[4]) && (s += [ e[110], a.ME(e[111], a.MB, a.MN, null), e[92] ].join("")), s += e[112];
var p = c, f = h, b = u, g = m, h = a.seq(0, a.MB(i[27])) || [];
n.unshift({
i:null
});
for (var m, c = 1, u = h.length; u >= c; c++) n[0].i = m = h[c - 1], s += [ e[113], a.F.entities(m.value), e[40] ].join(""), a.MJ(d + "" != "") && a.MJ(d + "" == "" + m.value) && (s += e[41]), s += e[114], a.MD(i[4]) ? s += [ e[115], (n.unshift({
num_years:m.value
}), t = a.ME(e[116], a.MB, a.MN, a.MO(m.value, null, e[116])), n.shift(), t), e[110] ].join("") :(s += [ e[115], m.value ].join(""), a.MD(i[28]) && (s += a.ME(e[117], a.MB, a.MN, null)), s += e[110]), s += e[118];
n.shift(), c = p, h = f, u = b, m = g, s += e[45], a.MD(i[4]) && (s += e[119]), s += e[4], a.MN("fe_child_i", a.MI(a.MB(i[26])) + a.MI(1)), s += e[15];
}
return n.shift(), c = r, h = o, u = _, d = l, s += e[2], _r_(s);
}
function o(s) {
_i_("4ab:457"), s += e[15];
var r = c, o = h, _ = u, l = d, h = a.MC(i[25]) || [];
n.unshift({
fe_child_age:null
});
for (var d, c = 1, u = h.length; u >= c; c++) {
n[0].fe_child_age = d = h[c - 1], s += e[15], a.MD(i[4]) && (s += e[105]), s += [ e[106], a.F.entities(a.MC(i[26])), e[107], (n.unshift({
child_number:a.MI(a.MB(i[26])) + a.MI(1)
}), t = a.ME(e[108], a.MB, a.MN, null), n.shift(), t), e[109] ].join(""), a.MD(i[4]) && (s += [ e[110], a.ME(e[111], a.MB, a.MN, null), e[92] ].join("")), s += e[112];
var p = c, f = h, b = u, g = m, h = a.seq(0, a.MB(i[27])) || [];
n.unshift({
i:null
});
for (var m, c = 1, u = h.length; u >= c; c++) n[0].i = m = h[c - 1], s += [ e[113], a.F.entities(m.value), e[40] ].join(""), a.MJ(d + "" != "") && a.MJ(d + "" == "" + m.value) && (s += e[41]), s += e[114], a.MD(i[4]) ? s += [ e[115], (n.unshift({
num_years:m.value
}), t = a.ME(e[116], a.MB, a.MN, a.MO(m.value, null, e[116])), n.shift(), t), e[110] ].join("") :(s += [ e[115], m.value ].join(""), a.MD(i[28]) && (s += a.ME(e[117], a.MB, a.MN, null)), s += e[110]), s += e[118];
n.shift(), c = p, h = f, u = b, m = g, s += e[45], a.MD(i[4]) && (s += e[119]), s += e[4], a.MN("fe_child_i", a.MI(a.MB(i[26])) + a.MI(1)), s += e[15];
}
return n.shift(), c = r, h = o, u = _, d = l, s += e[2], _r_(s);
}
function _(s) {
_i_("4ab:458"), s += e[15];
var r = a.MC(i[25]) || [];
n.unshift({
fe_child_age:null
});
for (var o, _ = 1, l = r.length; l >= _; _++) {
n[0].fe_child_age = o = r[_ - 1], s += e[15], a.MD(i[4]) && (s += e[105]), s += [ e[106], a.F.entities(a.MC(i[26])), e[107], (n.unshift({
child_number:a.MI(a.MB(i[26])) + a.MI(1)
}), t = a.ME(e[108], a.MB, a.MN, null), n.shift(), t), e[109] ].join(""), a.MD(i[4]) && (s += [ e[110], a.ME(e[111], a.MB, a.MN, null), e[92] ].join("")), s += e[112];
var h = _, d = r, c = l, u = p, r = a.seq(0, a.MB(i[27])) || [];
n.unshift({
i:null
});
for (var p, _ = 1, l = r.length; l >= _; _++) n[0].i = p = r[_ - 1], s += [ e[113], a.F.entities(p.value), e[40] ].join(""), a.MJ(o + "" != "") && a.MJ(o + "" == "" + p.value) && (s += e[41]), s += e[114], a.MD(i[4]) ? s += [ e[115], (n.unshift({
num_years:p.value
}), t = a.ME(e[116], a.MB, a.MN, a.MO(p.value, null, e[116])), n.shift(), t), e[110] ].join("") :(s += [ e[115], p.value ].join(""), a.MD(i[28]) && (s += a.ME(e[117], a.MB, a.MN, null)), s += e[110]), s += e[118];
n.shift(), _ = h, r = d, l = c, p = u, s += e[45], a.MD(i[4]) && (s += e[119]), s += e[4], a.MN("fe_child_i", a.MI(a.MB(i[26])) + a.MI(1)), s += e[15];
}
return n.shift(), s += e[2], _r_(s);
}
function l(s) {
_i_("4ab:459"), s += e[15];
var r = a.MC(i[25]) || [];
n.unshift({
fe_child_age:null
});
for (var o, _ = 1, l = r.length; l >= _; _++) {
n[0].fe_child_age = o = r[_ - 1], s += e[15], a.MD(i[4]) && (s += e[105]), s += [ e[106], a.F.entities(a.MC(i[26])), e[107], (n.unshift({
child_number:a.MI(a.MB(i[26])) + a.MI(1)
}), t = a.ME(e[108], a.MB, a.MN, null), n.shift(), t), e[109] ].join(""), a.MD(i[4]) && (s += [ e[110], a.ME(e[111], a.MB, a.MN, null), e[92] ].join("")), s += e[112];
var h = _, d = r, c = l, u = p, r = a.seq(0, a.MB(i[27])) || [];
n.unshift({
i:null
});
for (var p, _ = 1, l = r.length; l >= _; _++) n[0].i = p = r[_ - 1], s += [ e[113], a.F.entities(p.value), e[40] ].join(""), a.MJ(o + "" != "") && a.MJ(o + "" == "" + p.value) && (s += e[41]), s += e[114], a.MD(i[4]) ? s += [ e[115], (n.unshift({
num_years:p.value
}), t = a.ME(e[116], a.MB, a.MN, a.MO(p.value, null, e[116])), n.shift(), t), e[110] ].join("") :(s += [ e[115], p.value ].join(""), a.MD(i[28]) && (s += a.ME(e[117], a.MB, a.MN, null)), s += e[110]), s += e[118];
n.shift(), _ = h, r = d, l = c, p = u, s += e[45], a.MD(i[4]) && (s += e[119]), s += e[4], a.MN("fe_child_i", a.MI(a.MB(i[26])) + a.MI(1)), s += e[15];
}
return n.shift(), s += e[2], _r_(s);
}
function h(t) {
return _i_("4ab:460"), t += e[15], a.MK(a.MB(i[12])) ? (t += e[16], a.MD(i[4]) || (t += e[17], a.MD(i[5]) || (t += e[18]), t += e[19], a.MD(i[6]) && (t += e[20]), t += e[21], t += a.MD(i[6]) ? [ e[22], a.MC(i[7]), e[23] ].join("") :e[24], t += [ e[25], a.ME(e[26], a.MB, a.MN, null), e[27] ].join("")), t += e[28], t = f(t), t += e[47]) :t += [ e[48], a.F.entities(a.MC(i[10])), e[49] ].join(""), t += e[2], _r_(t);
}
function d(t) {
return _i_("4ab:461"), t += e[1], a.MN("fe_sb_group_max_rooms", 30), t += e[2], a.MN("fe_sb_group_max_pets", 10), t += e[2], a.MN("fe_sb_group_max_adults", 30), t += e[2], a.MN("fe_sb_group_max_children", 10), t += e[2], a.MN("fe_sb_group_max_children_age", 17), t += e[3], a.MN("fe_add_children_tooltip", ""), t += e[2], a.MJ(a.MC(i[1]) + "" == "searchresults") && a.MJ(a.MC(i[2])) && a.MK(a.MC(i[2]).b_children_total) && a.MJ(a.MC(i[3]) + "" == "family") && (t += e[4], a.MN(i[0], [ e[5], a.ME(e[6], a.MB, a.MN, null), e[7], a.ME(e[8], a.MB, a.MN, null), e[9] ].join("")), t += e[2]), t += e[10], t += e[11], t += e[11], t += e[11], t += e[11], t += e[11], t += e[12], a.MD(i[4]) && (t += e[13]), t += e[14], a.MJ(a.MB(i[13])) && a.MJ(a.MB(i[4])) || (t += e[4], t = h(t), t += e[15]), t += e[50], a.MK(a.MB(i[17])) ? (t += e[51], a.MD(i[4]) || (t += e[52], a.MD(i[5]) || (t += e[18]), t += e[19], a.MD(i[6]) && (t += e[53]), t += e[54], t += a.MD(i[6]) ? [ e[55], a.MC(i[7]), e[56] ].join("") :e[57], t += e[58], t += a.MD(i[14]) ? a.ME(e[60], a.MB, a.MN, null) :a.ME(e[59], a.MB, a.MN, null), t += e[61]), t += e[28], t = c(t), t += e[47]) :t += [ e[75], a.F.entities(a.MC(i[16])), e[49] ].join(""), t += e[14], a.MK(a.MB(i[29])) && (t += e[28], a.MN("fe_sb_group_has_children", a.MB(i[18]) && (a.MB(i[19]) || a.MB(i[20]))), t += e[76], a.MJ(a.MB(i[4])) && a.MJ(a.MB(i[21])) && (t += e[77]), t += e[78], a.MD(i[4]) || (t += e[52], a.MD(i[5]) || (t += e[18]), t += e[19], a.MD(i[6]) && (t += e[53]), t += e[54], t += a.MD(i[6]) ? [ e[79], a.MC(i[7]), e[56] ].join("") :e[80], t += [ e[81], a.ME(e[82], a.MB, a.MN, null), e[61] ].join("")), t += e[28], t = u(t), t += e[96], a.MK(a.MB(i[29])) && a.MJ(a.MB(i[4])) && (t += e[92], t = p(t), t += e[28]), t += e[47]), t += e[14], a.MJ(a.MB(i[4])) && (t += e[4], t = h(t), t += e[15]), t += e[14], a.MD(i[4]) && (t += e[46]), t += e[14], a.MK(a.MB(i[29]) || a.MB(i[4])) && (t += e[28], t = b(t), t += e[15]), t += e[121], _r_(t);
}
function c(s) {
_i_("4ab:462"), s += e[2], a.MD(i[4]) && (s += e[29]), s += e[62], a.MD(i[8]) && (s += [ e[63], a.ME(e[64], a.MB, a.MN, null), e[65] ].join("")), s += e[4], s += a.MD(i[6]) ? [ e[66], a.MC(i[7]), e[67] ].join("") :e[68], s += e[69];
var r = a.seq(1, a.MB(i[15])) || [];
n.unshift({
i:null
});
for (var o, _ = 1, l = r.length; l >= _; _++) n[0].i = o = r[_ - 1], s += [ e[70], a.F.entities(o.value), e[40] ].join(""), a.MJ(a.MB(i[16]) == o.value) && (s += e[41]), s += e[71], a.MD(i[11]) ? (n.unshift({
num_adults:o.value
}), t = a.ME(e[72], a.MB, a.MN, a.MO(o.value, null, e[72])), n.shift(), s += t) :s += o.value, s += e[73];
return n.shift(), s += e[74], a.MD(i[4]) && (s += e[46]), s += e[2], _r_(s);
}
function u(s) {
_i_("4ab:463"), s += e[2], a.MD(i[4]) && (s += e[29]), s += e[83], a.MD(i[8]) && (s += [ e[63], a.ME(e[84], a.MB, a.MN, null), e[65] ].join("")), s += e[4], s += a.MD(i[6]) ? [ e[85], a.MC(i[7]), e[86] ].join("") :e[87], s += e[88], a.MD(i[4]) || (s += [ e[89], a.F.html(a.MC(i[0])), e[90] ].join("")), s += e[91];
var r = a.seq(0, a.MB(i[22])) || [];
n.unshift({
i:null
});
for (var o, _ = 1, l = r.length; l >= _; _++) n[0].i = o = r[_ - 1], s += [ e[70], a.F.entities(o.value), e[40] ].join(""), a.MJ(a.MB(i[18]) == o.value) && (s += e[41]), s += e[71], s += a.MJ(a.MB(i[11])) && a.MJ(0 == o.value) ? [ e[92], a.ME(e[93], a.MB, a.MN, null), e[94] ].join("") :a.MJ(a.MB(i[11])) ? [ e[92], (n.unshift({
num_kids:o.value
}), t = a.ME(e[95], a.MB, a.MN, a.MO(o.value, null, e[95])), n.shift(), t), e[94] ].join("") :[ e[92], o.value, e[94] ].join(""), s += e[73];
return n.shift(), s += e[74], a.MD(i[4]) && (s += e[46]), s += e[2], _r_(s);
}
function p(s) {
if (_i_("4ab:464"), s += e[4], a.MJ(a.MB(i[18])) && (a.MJ(a.MB(i[19])) || a.MJ(a.MB(i[20])))) {
if (s += e[97], a.MD(i[4]) || (s += e[98], a.MD(i[24]) ? (a.MN(i[23], a.DATE(a.MB(i[24]), "short_date", "", "", "")), s += a.MJ(1 == a.MB(i[18])) ? [ (n.unshift({
date:a.MB(i[23])
}), t = a.ME(e[99], a.MB, a.MN, null), n.shift(), t), e[2] ].join("") :[ (n.unshift({
date:a.MB(i[23])
}), t = a.ME(e[100], a.MB, a.MN, null), n.shift(), t), e[2] ].join("")) :s += a.MJ(1 == a.MB(i[18])) ? [ a.ME(e[101], a.MB, a.MN, null), e[2] ].join("") :[ a.ME(e[102], a.MB, a.MN, null), e[2] ].join(""), s += e[103]), s += e[104], a.MN("fe_child_i", 0), s += e[104], a.MD(i[20])) s += e[92], n.unshift({
fe_children_ages:a.MB(i[20])
}), s = _(s), n.shift(), s += e[94]; else if (a.MD(i[19])) {
s += e[92];
var o = a.MC(i[19]) || [];
n.unshift({
fe_room:null
});
for (var l, h = 1, d = o.length; d >= h; h++) n[0].fe_room = l = o[h - 1], s += e[110], n.unshift({
fe_children_ages:a.MG((l || {}).b_children_ages)
}), s = r(s), n.shift(), s += e[92];
n.shift(), s += e[94];
}
s += e[120];
}
return s += e[2], _r_(s);
}
function f(s) {
_i_("4ab:465"), s += e[4], a.MD(i[4]) && (s += e[29]), s += e[30], s += a.MD(i[6]) ? [ e[31], a.MC(i[7]), e[32] ].join("") :e[33], s += e[34], a.MD(i[8]) && (s += [ e[35], a.ME(e[36], a.MB, a.MN, null), e[37] ].join("")), s += e[38];
var r = a.seq(1, a.MB(i[9])) || [];
n.unshift({
i:null
});
for (var o, _ = 1, l = r.length; l >= _; _++) n[0].i = o = r[_ - 1], s += [ e[39], a.F.entities(o.value), e[40] ].join(""), a.MJ(a.MB(i[10]) == o.value) && (s += e[41]), s += e[42], a.MD(i[11]) ? (n.unshift({
num_rooms:o.value
}), t = a.ME(e[43], a.MB, a.MN, a.MO(o.value, null, e[43])), n.shift(), s += t) :s += o.value, s += e[44];
return n.shift(), s += e[45], a.MD(i[4]) && (s += e[46]), s += e[2], _r_(s);
}
function b(s) {
if (_i_("4ab:466"), s += e[4], a.MJ(a.MB(i[18])) && (a.MJ(a.MB(i[19])) || a.MJ(a.MB(i[20])))) {
if (s += e[97], a.MD(i[4]) || (s += e[98], a.MD(i[24]) ? (a.MN(i[23], a.DATE(a.MB(i[24]), "short_date", "", "", "")), s += a.MJ(1 == a.MB(i[18])) ? [ (n.unshift({
date:a.MB(i[23])
}), t = a.ME(e[99], a.MB, a.MN, null), n.shift(), t), e[2] ].join("") :[ (n.unshift({
date:a.MB(i[23])
}), t = a.ME(e[100], a.MB, a.MN, null), n.shift(), t), e[2] ].join("")) :s += a.MJ(1 == a.MB(i[18])) ? [ a.ME(e[101], a.MB, a.MN, null), e[2] ].join("") :[ a.ME(e[102], a.MB, a.MN, null), e[2] ].join(""), s += e[103]), s += e[104], a.MN("fe_child_i", 0), s += e[104], a.MD(i[20])) s += e[92], n.unshift({
fe_children_ages:a.MB(i[20])
}), s = l(s), n.shift(), s += e[94]; else if (a.MD(i[19])) {
s += e[92];
var r = a.MC(i[19]) || [];
n.unshift({
fe_room:null
});
for (var _, h = 1, d = r.length; d >= h; h++) n[0].fe_room = _ = r[h - 1], s += e[110], n.unshift({
fe_children_ages:a.MG((_ || {}).b_children_ages)
}), s = o(s), n.shift(), s += e[92];
n.shift(), s += e[94];
}
s += e[120];
}
return s += e[2], _r_(s);
}
return s += e[0], s = d(s), s += e[122], _r_(s);
});
}());
var n = t("component"), s = t("morphdom"), a = t("read-data-options"), r = t("search-config"), o = t("search/searchbox/model");
i.exports = n.extend({
init:function() {
if (_i_("4ab:386"), this.options = a(this.$el, {
modelId:{
name:"sb-id",
type:String,
required:!0
},
sbWidth:{
name:"sb-width",
type:String
},
sbBBToolSearchbox:{
name:"sb-bbtool-searchbox",
type:Boolean
},
childrenHide:{
name:"sb-group-children-hide",
type:Boolean
},
petsHide:{
name:"sb-group-pets-hide",
type:Boolean
},
roomsHide:{
name:"sb-group-rooms-hide",
type:Boolean
},
useAdultsLabel:{
name:"sb-group-use_adults_label",
type:Boolean
},
blockLabels:{
name:"sb-group-block-labels",
type:Boolean
},
alwaysExpanded:{
name:"sb-group-always-expanded",
type:Boolean
},
removeOldParams:{
name:"sb-group-remove-old-params",
type:Boolean
},
descriptiveDropdowns:{
name:"fe_sb_group_descriptive_dropdowns",
type:Boolean
},
universalDesign:{
name:"fe_sb_universal_design",
type:Boolean
},
removeDuplicateIds:{
name:"fe_remove_duplicate_ids",
type:Boolean
},
searchBoxUniqueId:{
name:"fe_sb_unique_id",
type:String
},
a11yGroupInputsAriaLabels:{
name:"fe_sb_a11y_group_inputs_aria_labels",
type:Boolean
}
}), this.model = o.getInstance(this.options.modelId), this.model.use("group"), this.model.use("dates"), this.model.on("change", this.modelChange.bind(this)), this.$form = this.$el.parents("form"), this.options.removeOldParams && this.$form.on("submit", this.formSubmit.bind(this)), r.on("change", this.searchConfigChange.bind(this)), this.$el.on("change", '[data-group-rooms-count=""]', this.groupRoomsChange.bind(this)), this.$el.on("change", '[data-group-adults-count=""]', this.groupAdultsChange.bind(this)), this.$el.on("change", '[data-group-children-count=""]', this.groupChildrenChange.bind(this)), this.$el.on("change", "[data-group-child-age]", this.groupChildAgeChange.bind(this)), this.renderEl = this.$el.find('[data-render=""]')[0], this.template = B.jstmpl("search_group_group_html"), this.$form.on("change", ".b-booker-type__input_business-booker", this.businessBookerSelected.bind(this)), this.modelInit(), "index" === B.env.b_action && "sessionStorage" in window && !r.childrenAges.length) {
var t = JSON.parse(window.sessionStorage.getItem("search_group_children_ages"));
if (t) {
this.model.group.set({
key:"children_count",
value:t.length
});
for (var e = 0; e < t.length; e++) this.model.group.set({
i:e,
key:"children_ages",
value:t[e]
});
}
}
_r_();
},
modelInit:function() {
_i_("4ab:387");
var t = {
rooms_count:r.rooms ? r.rooms.length :1,
adults_count:r.adults || 2,
children_ages:r.childrenAges || [],
default_empty_age_to:"12 "
};
this.model.group.init(t), _r_();
},
modelChange:function(t) {
if (_i_("4ab:388"), !t || "group" != t.group && "dates" != t.group) return _r_();
B.env.b_is_bbtool_user && B.et.customGoal("VObLMEKKTVeBKeYEGWe", 3), this.render(), _r_();
},
searchConfigChange:function() {
_i_("4ab:389"), this.model.group.set({
key:"rooms_count",
value:Array.isArray(r.rooms) ? r.rooms.length :1
}), this.model.group.set({
key:"adults_count",
value:r.adults
}), this.model.group.set({
key:"children_count",
value:Array.isArray(r.childrenAges) ? r.childrenAges.length :1
}), Array.isArray(r.childrenAges) && r.childrenAges.forEach(function(t, e) {
_i_("4ab:521"), this.model.group.set({
key:"children_ages",
i:e,
value:t
}), _r_();
}.bind(this)), _r_();
},
groupRoomsChange:function(t) {
_i_("4ab:390");
var e = $(t.currentTarget);
this.model.group.set({
key:"rooms_count",
value:e.val()
}), _r_();
},
groupAdultsChange:function(t) {
_i_("4ab:391");
var e = $(t.currentTarget);
this.model.group.set({
key:"adults_count",
value:e.val()
}), this.groupAdultsChanged = !0, _r_();
},
groupChildrenChange:function(t) {
_i_("4ab:392");
var e = $(t.currentTarget);
this.model.group.set({
key:"children_count",
value:e.val()
}), _r_();
},
groupChildAgeChange:function(t) {
_i_("4ab:393");
var e = $(t.currentTarget), i = e.attr("data-group-child-age");
this.model.group.set({
key:"children_ages",
i:+i,
value:e.val()
}), _r_();
},
formSubmit:function(t) {
if (_i_("4ab:394"), t.isDefaultPrevented()) return _r_(!1);
var e = [ "[data-group-adults-count]", "[data-group-children-count]", "[data-group-child-age]" ], i = this.$el.find("[name=room1]");
this.$el.find(e.join(",")).prop("disabled", !0), i.val(i.val().replace(" ", "")), _r_();
},
render:function() {
_i_("4ab:395");
var t = {}, e = this.model.group.get(), i = this.model.dates.get();
e = {
fe_sb_state_number_of_rooms:e.rooms_count,
fe_sb_state_number_of_adults:e.adults_count,
fe_sb_state_number_of_children:e.children_ages.length,
fe_sb_state_children_ages:e.children_ages,
fe_sb_state_traveller:e.fe_sb_state_traveller,
fe_sb_state_rooms:[ {
b_adults:e.adults_count,
b_children:e.children_ages.length,
b_children_ages:e.children_ages,
b_room_order:1
} ]
}, B.env.b_lang_is_cjk && (e.b_lang_is_cjk = B.env.b_lang_is_cjk), i.checkout && (e.fe_sb_state_checkout = i.checkout.toString()), this.options.sbWidth && (e.fe_sb_width = this.options.sbWidth), this.options.childrenHide && (e.fe_sb_group_children_hide = 1), this.options.petsHide && (e.fe_sb_group_pets_hide = 1), this.options.roomsHide && (e.fe_sb_group_rooms_hide = 1), this.options.blockLabels && (e.fe_sb_group_block_labels = 1), this.options.alwaysExpanded && (e.fe_sb_group_always_expanded = 1), this.options.useAdultsLabel && (e.fe_sb_group_use_adults_label = 1), this.options.sbBBToolSearchbox && (e.fe_sb_bbtool_searchbox = 1), this.options.descriptiveDropdowns && (e.fe_sb_group_descriptive_dropdowns = 1), this.options.universalDesign && (e.fe_sb_universal_design = 1), this.options.removeDuplicateIds && (e.fe_remove_duplicate_ids = 1), this.options.searchBoxUniqueId && (e.fe_sb_unique_id = this.options.searchBoxUniqueId), this.options.a11yGroupInputsAriaLabels && (e.fe_sb_a11y_group_inputs_aria_labels = 1);
var n = this.template.render(e).trim();
"msie" === B.env.b_browser && B.env.b_browser_version <= 8 && (t.onBeforeElUpdated = function(t, e) {
_i_("4ab:504");
var i = t.getAttribute(jQuery.expando);
return i && e.setAttribute(jQuery.expando, i), _r_(!0);
}), s(this.renderEl, n, t), _r_();
},
businessBookerSelected:function() {
_i_("4ab:396"), this.groupAdultsChanged || this.model.group.set({
key:"adults_count",
value:1
}), _r_();
},
groupChildrenAgeSave:function(e) {
_i_("4ab:397"), e.preventDefault();
var i = t("events");
i.trigger("SearchBox::SaveTravelGroupsClicked", e), _r_();
}
}), _r_();
}), B.define("search/group/model", function(t, e, i) {
"use strict";
_i_("4ab:30");
function n(t) {
_i_("4ab:77"), this.model = t, this.data = {
preset:-1
}, this.valid = !0, this.validationError = "", this.options = {}, _r_();
}
$.extend(n.prototype, {
init:function(t) {
_i_("4ab:199"), this.data = t, this.emit("init"), _r_();
},
configure:function(t, e) {
_i_("4ab:200"), void 0 !== e ? this.options[t] = e :"object" == typeof t && $.extend(this.options, t), _r_();
},
get:function() {
return _i_("4ab:201"), _r_(this.data);
},
setAll:function(t) {
if (_i_("4ab:202"), !t) return _r_(!1);
var e = this;
return Object.keys(t).forEach(function(i) {
_i_("4ab:467"), e.set({
key:i,
value:t[i]
}, !0), _r_();
}), this.emit("change"), _r_(!0);
},
set:function(t, e) {
if (_i_("4ab:203"), !t || !t.key) return _r_(!1);
if ("children_count" == t.key) if (this.data.children_ages || (this.data.children_ages = []), 0 == t.value) this.data.children_ages = []; else if (this.data.children_ages.length < t.value) for (var i = this.data.children_ages.length; i < t.value; i++) this.data.default_empty_age_to ? this.data.children_ages.push(this.data.default_empty_age_to) :this.data.children_ages.push(""); else this.data.children_ages.length > t.value && this.data.children_ages.splice(t.value, this.data.children_ages.length - t.value); else t.hasOwnProperty("i") ? this.data[t.key] ? this.data[t.key][t.i] = t.value :(this.data[t.key] = [], this.data[t.key][t.i] = t.value) :this.data[t.key] = t.value;
if ("index" === B.env.b_action && "sessionStorage" in window) {
var n = JSON.stringify(this.data.children_ages);
window.sessionStorage.setItem("search_group_children_ages", n);
}
return e || this.emit("change"), _r_(!0);
},
validate:function(t) {
_i_("4ab:204"), t = t || {};
var e = !0, i = "";
if (t.groupLimit) {
var n = 0;
this.data && this.data.adults_count && (n += parseInt(this.data.adults_count)), this.data && this.data.children_ages && (n += this.data.children_ages.length), n > t.groupLimit && (e = !1, i = "over-limit");
}
return this.valid != e && (this.valid = e, this.validationError = i, this.emit("validation", {
valid:e,
validationError:i
})), _r_(e);
},
modelChange:function(t) {
if (_i_("4ab:205"), !t || "traveller" !== t.group) return _r_();
var e = this.model.traveller.get().travellerType;
switch (e) {
case null:
case "":
case "couple":
this.data.rooms_count = 1, this.data.adults_count = 2, this.data.children_ages = [];
break;

case "solo":
case "business":
this.data.rooms_count = 1, this.data.adults_count = 1, this.data.children_ages = [];
break;

case "family":
this.data.adults_count = 1 == this.data.adults_count ? 2 :this.data.adults_count, this.data.children_ages && 0 != this.data.children_ages.length || (this.data.children_ages = [ this.data.default_empty_age_to ]);
break;

case "group":
this.data.adults_count = 1 == this.data.adults_count ? 2 :this.data.adults_count, this.data.children_ages = [];
}
this.data.fe_sb_state_traveller = e, this.emit("change"), _r_();
},
emit:function(t, e) {
_i_("4ab:206"), e = e || {}, this.model.emit(t, $.extend(e, {
group:"group"
})), _r_();
}
}), i.exports = n, _r_();
}), B.define("search/searchbox/analytics", function(t, e, i) {
_i_("4ab:31");
var n = {};
e.send = function(t, e, i) {
if (_i_("4ab:107"), !window.ga) return _r_();
window.ga("send", "event", "Searchbox", B.env.b_action, t, e, i), _r_();
}, e.sendNonInteractive = function(t, i) {
_i_("4ab:108"), e.send(t, i, {
nonInteraction:!0
}), _r_();
}, e.sendOnce = function(t, i) {
_i_("4ab:109");
var s = t + ":" + i;
n[s] || (e.send(t, i), n[s] = !0), _r_();
}, _r_();
}), B.define("search/searchbox/model", function(t, e, i) {
"use strict";
_i_("4ab:32");
var n = t("event-emitter"), s = t("search/modules/flags"), a = {};
function r(t) {
_i_("4ab:78"), n.extend(this), this.id = t, this.formAction, this.fieldGroups = {
track:[]
}, this.flags = {}, this.validators = [], _r_();
}
$.extend(r.prototype, {
use:function(e) {
if (_i_("4ab:207"), this[e]) return _r_();
switch (e) {
case "destination":
var i = t("search/destination/model");
this[e] = new i(this);
break;

case "dates":
var n = t("search/dates/model");
this[e] = new n(this);
break;

case "group":
var s = t("search/group/model");
this[e] = new s(this);
break;

case "traveller":
var a = t("search/traveller/model");
this[e] = new a(this);
break;

default:
return _r_();
}
if ("function" == typeof this[e].validate) {
var r = this[e]._options ? this[e]._options :this[e].options;
r || (r = {}), this.validators.push(this[e].validate.bind(this[e], r));
}
_r_();
},
submit:function() {
_i_("4ab:208"), this.emit("submit"), _r_();
},
getFormAction:function() {
return _i_("4ab:209"), _r_(this.formAction);
},
setFormAction:function(t) {
_i_("4ab:210"), this.formAction = t, _r_();
},
getFields:function() {
_i_("4ab:211");
var t = [];
return Object.keys(this.fieldGroups).forEach(function(e) {
_i_("4ab:489"), Array.isArray(this.fieldGroups[e]) && (t = t.concat(this.fieldGroups[e])), _r_();
}.bind(this)), _r_(t);
},
setFields:function(t, e) {
_i_("4ab:212"), this.fieldGroups[t] = e, _r_();
},
hasFlag:function(t) {
return _i_("4ab:213"), _r_(t in this.flags);
},
getFlag:function(t) {
return _i_("4ab:214"), _r_(this.flags[t]);
},
updateFlags:function(t) {
_i_("4ab:215");
var e = s.parse(t);
Object.assign(this.flags, e), _r_();
},
validate:function() {
_i_("4ab:216");
var t = this.validators.filter(function(t) {
return _i_("4ab:481"), _r_(t.call());
});
return _r_(t.length == this.validators.length);
}
}), i.exports = {
getInstance:function(t) {
return _i_("4ab:217"), a[t] || (a[t] = new r(t)), _r_(a[t]);
}
}, _r_();
}), B.define("component/search/searchbox/searchbox", function(t, e, i) {
"use strict";
_i_("4ab:33");
var n = t("component"), s = t("search/searchbox/model"), a = t("read-data-options"), r = t("search/dates/date-prices"), o = t("search/dates/date-public-holidays"), _ = t("events");
if (B.et.track("AEJPAcBUaXNNWTVISZbEC")) var l = !1;
var h = [ "country", "dest_id", "dest_type", "district", "iata", "landmark", "latitude", "longitude", "place_id", "place_id_lat", "place_id_lon", "region", "prefill_submitted" ];
i.exports = n.extend({
init:function() {
if (_i_("4ab:398"), this.hiddenFields = [], this.options = a(this.$el, {
modelId:{
name:"sb-id",
type:String,
required:!0
},
flags:{
name:"sb-flags",
type:String,
defaultValue:""
},
isFirstVisible:{
name:"is-first-visible",
type:Boolean
}
}), this.model = s.getInstance(this.options.modelId), this.model.on("init", this.modelChange.bind(this)), this.model.on("change", this.modelChange.bind(this)), this.model.on("submit", this.modelSubmit.bind(this)), this.model.updateFlags(this.options.flags), this.$form = this.$el.is("form") ? this.$el :this.$el.find("form:eq(0)"), this.$form.submit(this.formSubmit.bind(this)), this.originalAction = this.$form.attr("action"), this.options.isFirstVisible && this.model.hasFlag("sticky")) {
var e = t("search/searchbox/searchbox-sticky-controller").getController();
e.setElement(this.$form);
}
if (this.$searchOverlay = this.$el.find("[data-searching-overlay]"), this.shouldShowSearchOverlay = this.model.getFlag("AEJPAcBacPONDcFGHT") && this.$searchOverlay.length, this.shouldShowSearchOverlay && (this.$searchOverlay.on("click", this.searchOverlayClick.bind(this)), $(document).on("keydown", this.hideSearchOverlay.bind(this))), this.initCurrentCountryField(), this.model.getFlag("UBKeJbLYQCLBMJFUWOEQeRe") && (this.datePrices = r.getInstance(), this.datePrices.init({
model:this.model,
variant:B.et.track("UBKeJbLYQCLBMJFUWOEQeRe"),
style:"dots",
trackHash:"UBKeJbLYQCLBMJFUWOEQeRe"
})), B.et.track("AEJPAcBUaXNNWTVISZbEC")) {
var i = $(".sb-searchbox-horizontal__dismissible-btn");
if (i.length && !l) {
var n = i.parents(".sb-searchbox-horizontal");
l = !0, i.click(function() {
_i_("4ab:529"), n.hasClass("hidden") ? n.removeClass("hidden") :n.addClass("hidden"), _r_();
});
}
}
this.model.getFlag("highlight_public_holidays") && (this.datePublicHolidays = o.getInstance(), this.datePublicHolidays.init({
model:this.model
})), "www" == B.env.b_site_type && this.model.setFields("sr_traffic", [ {
name:"from_sf",
value:1
} ]), "www" == B.env.b_site_type && "index" === B.env.b_action && "en" === B.env.b_lang && B.et.track("dVRAOSDSIFPAZQMFEbOMFcWe") && this.$form.find('[name="ss"]').on("keyup", function(t) {
_i_("4ab:505"), _.trigger("SearchBox::destination_keyup", t), _r_();
}), _r_();
},
modelChange:function(t) {
_i_("4ab:399"), this.updateHiddenFields(), t && "destination" == t.group && B.et.track("AETbSEISUacWCcAATXT") && _.trigger("SearchBox::changed", this), _r_();
},
modelSubmit:function() {
_i_("4ab:400"), this.$form.submit(), _r_();
},
initCurrentCountryField:function() {
_i_("4ab:401");
var t = !1;
this.$onlyCurrentCountry = this.$form.find("#limit-search-area"), this.$onlyCurrentCountry.length && (t = this.$onlyCurrentCountry.is(":checked"), this.$onlyCurrentCountry.bind("change", this.onlyCurrentCountryChange.bind(this)), this.model.use("destination"), this.model.destination.initOnlyCurrentCountry(t)), _r_();
},
onlyCurrentCountryChange:function() {
_i_("4ab:402"), this.model.use("destination"), this.model.destination.setOnlyCurrentCountry(this.$onlyCurrentCountry.is(":checked")), _r_();
},
updateHiddenFields:function() {
_i_("4ab:403");
var t = this.model.getFormAction(), e = this.$form.attr("action");
t || (t = this.originalAction), e != t && this.$form.attr("action", t), this.hiddenFields && this.hiddenFields.forEach(function(t) {
_i_("4ab:506"), t.$node.remove(), t.$node = null, _r_();
});
var i = this.model.getFields();
this.hiddenFields = [];
var n = [], s = !1;
i.forEach(function(t) {
_i_("4ab:507"), this.hiddenFields.push({
name:t.name,
value:t.value
}), n.push(t.name), -1 != h.indexOf(t.name) && (s = !0), _r_();
}.bind(this)), this.$form.find("input").filter(function() {
return _i_("4ab:508"), _r_(s && -1 != h.indexOf(this.name) || -1 != n.indexOf(this.name));
}).remove(), this.hiddenFields.forEach(function(t) {
_i_("4ab:509");
var e = $("<input>");
e.attr("type", "hidden"), e.attr("name", t.name), e.attr("value", t.value), t.$node = e, this.$form.append(e), _r_();
}.bind(this)), _r_();
},
formSubmit:function(t) {
_i_("4ab:404");
var e = this.model.validate();
if (this.model.getFlag("TAeKPWbOTAcBNZXQeJaeC") && B.et.customGoal("TAeKPWbOTAcBNZXQeJaeC", 1), this.model.getFlag("TAeKPWbOTAcBNZXQeJfOC") && B.et.customGoal("TAeKPWbOTAcBNZXQeJfOC", 1), !e) return t.preventDefault(), _r_();
_.trigger("SearchBox::Submit__Success", this), this.shouldShowSearchOverlay ? this.showSearchOverlay() :this.shouldShowSearchPageOverlay ? this.pageOverlay.show(this.model.destination.data.ss_raw) :this.shouldShowSRPP && this.SRPPOverlay.show(this.model.destination.data.ss_raw), _r_();
},
searchOverlayClick:function() {
_i_("4ab:405"), this.abortSubmit(), this.hideSearchOverlay(), B.et.customGoal("AEJPAcBacPONDcFGHT", 1), _r_();
},
abortSubmit:function() {
_i_("4ab:406"), window.stop ? window.stop() :document.execCommand && document.execCommand("Stop"), _r_();
},
showSearchOverlay:function() {
_i_("4ab:407"), this.$searchOverlay.addClass("-visible"), _r_();
},
hideSearchOverlay:function() {
_i_("4ab:408"), this.$searchOverlay.removeClass("-visible"), _r_();
}
}), _r_();
}), B.define("search/searchbox/searchbox-sticky-controller", function(t, e, i) {
"use strict";
_i_("4ab:34");
var n = t("jquery"), s = t("event-emitter"), a = null;
function r() {
_i_("4ab:79"), s.extend(this), this.visible = !1, this.bottomPosition = null, this.$el = null, this.$sticky = null, this.$window = n(window), this.$window.on("scroll", this.windowScroll.bind(this)), this.$window.on("keydown", this.onKeyDown.bind(this)), this.$window.on("click", this.clickOnWindow.bind(this)), _r_();
}
Object.assign(r.prototype, {
setElement:function(t) {
if (_i_("4ab:218"), this.bottomPosition) {
var e = t.offset(), i = t.outerHeight();
if (e && e.top + i > this.bottomPosition) return _r_();
}
this.$el = t, this.recalculate(), _r_();
},
setStickyElement:function(t) {
_i_("4ab:219"), this.$sticky = t, _r_();
},
isVisible:function() {
return _i_("4ab:220"), _r_(this.visible);
},
recalculate:function() {
if (_i_("4ab:221"), null === this.$el) return _r_();
var t = this.$el.offset(), e = this.$el.outerHeight();
if (!t) return _r_();
this.bottomPosition = t.top + e, this.updateStatus(), _r_();
},
show:function() {
_i_("4ab:222"), this.visible = !0, this.emit("show"), _r_();
},
onKeyDown:function(t) {
_i_("4ab:223");
var e = 27 === t.keyCode;
e && this.visible && this.updateStatus(), _r_();
},
clickOnWindow:function(t) {
if (_i_("4ab:224"), this.$sticky && this.$sticky.length) {
var e = t.target, i = this.$sticky.get(0), s = n.contains(i, e) || i === e;
!s && this.visible && this.updateStatus();
}
_r_();
},
updateStatus:function() {
_i_("4ab:225"), !this.visible && this.$window.scrollTop() >= this.bottomPosition ? (this.visible = !0, this.emit("show")) :this.visible && this.$window.scrollTop() < this.bottomPosition && (this.visible = !1, this.emit("hide")), _r_();
},
windowScroll:function(t) {
if (_i_("4ab:226"), null === this.bottomPosition) return _r_();
this.updateStatus(), _r_();
}
}), i.exports = {
getController:function() {
return _i_("4ab:227"), a || (a = new r()), _r_(a);
}
}, _r_();
}), B.define("component/search/searchbox/searchbox-sticky", function(t, e, i) {
"use strict";
_i_("4ab:35");
var n = t("component"), s = t("events"), a = t("search/searchbox/searchbox-sticky-controller").getController();
i.exports = n.extend({
init:function() {
_i_("4ab:409"), a.on("show", this.show.bind(this)), a.on("hide", this.hide.bind(this)), a.setStickyElement(this.$el), a.isVisible() && this.hardShow(), _r_();
},
show:function(t) {
_i_("4ab:410"), this.$el.addClass("-visible-1"), s.trigger("searchbox-sticky:show"), setTimeout(function() {
_i_("4ab:510"), this.$el.addClass("-visible-2"), _r_();
}.bind(this), 0), _r_();
},
hardShow:function() {
_i_("4ab:411"), this.$el.addClass("-visible-1 -visible-2"), _r_();
},
hide:function(t) {
_i_("4ab:412"), this.$el.removeClass("-visible-2"), setTimeout(function() {
_i_("4ab:511"), this.$el.removeClass("-visible-1"), _r_();
}.bind(this), 1e3), _r_();
}
}), _r_();
}), B.define("component/search/group/children-ages-tooltip", function(t, e, i) {
"use strict";
_i_("4ab:36");
var n = t("jquery"), s = t("jstmpl"), a = t("component"), r = t("events");
i.exports = a.extend({
init:function() {
_i_("4ab:413"), this.dropdown = !1, this.$form = this.$el.closest("form"), this.isPopupAlreadyShown = !1, this.agesSelector = '[name="age"]', this.addEventListeners(), _r_();
},
addEventListeners:function() {
_i_("4ab:414"), this.$el.change(this.showTooltip.bind(this)), this.$form.delegate(this.agesSelector, "click", this.hideTooltip.bind(this)), B.eventEmitter.bind("CALENDAR:opened", this.hideTooltip.bind(this)), "undefined" != typeof B.hotel.Events && (r.on(B.hotel.Events.RT.LIGHTBOX_CLOSE, this.hideTooltip.bind(this)), r.on(B.hotel.Events.RT.LIGHTBOX_OPEN, this.hideTooltip.bind(this))), _r_();
},
showTooltip:function() {
_i_("4ab:415");
var t = parseInt(this.$el.val()) > 0;
if (t && !this.isPopupAlreadyShown) var e = setTimeout(function() {
_i_("4ab:533");
var t = this.$form.find(this.agesSelector).eq(0);
if (0 === t.length) return _r_();
this.dropdown = n.fly.dropdown.extend({
defaults:{
position:"bottom left",
content:function() {
return _i_("4ab:543"), _r_(s("searchbox_children_ages_tooltip").render({}));
},
extraClass:"searchbox_children_ages_tooltip"
}
}).create(t[0]), this.dropdown.show(), this.isPopupAlreadyShown = !0, clearTimeout(e), _r_();
}.bind(this), 0);
_r_();
},
hideTooltip:function() {
_i_("4ab:416"), this.dropdown && (this.dropdown.hide(), this.dropdown.destroy()), _r_();
}
}), _r_();
}), B.define("component/search/group/add-children-tooltip", function(t, e, i) {
"use strict";
_i_("4ab:37");
var n = t("jquery"), s = B.env.rtl ? "left" :"right", a = "searchbox_children_tooltip", r = null, o = null === B.browserStorageHandler.getSessionValue("gs_sb_add_children_tooltip"), _ = t("component");
i.exports = _.extend({
init:function() {
_i_("4ab:417"), o && this.$el.data("add-children-tooltip") && (this.showTooltip(), B.browserStorageHandler.addSessionValue("gs_sb_add_children_tooltip", 1), o = !1, B.eventEmitter.bind("CALENDAR:opened", this.hideTooltip), n(".sb-destination__input").on("focus", this.hideTooltip)), _r_();
},
showTooltip:function() {
_i_("4ab:418");
var t = this.$el;
r && r.hide(), r = n.fly.dropdown.extend({
defaults:{
position:s,
content:function() {
return _i_("4ab:538"), _r_(t.data("add-children-tooltip"));
},
extraClass:a
},
actions:{
click:function(t) {
_i_("4ab:539"), n(t.target).is("select") && this.hide(), _r_();
}
},
_autohide:function() {},
init:function() {
_i_("4ab:535"), this.bind(this.events.show, function() {
_i_("4ab:540"), n("." + a).delegate(".fly-dropdown-close", "click", function(t) {
_i_("4ab:542"), r.hide(), _r_();
}), _r_();
}), _r_();
}
}).create(t), r.show(), _r_();
},
hideTooltip:function() {
_i_("4ab:419"), r && r.hide(), _r_();
}
}), _r_();
}), B.define("component/search/dates/prompt", function(t, e, i) {
"use strict";
_i_("4ab:38");
var n = "sb-dates-prompt-dismissed", s = 200, a = "mdot" === B.env.b_site_type, r = t("component"), o = t("click-out"), _ = !a && "searchresults" === B.env.b_action && t("searchresults/events");
i.exports = r.extend({
init:function() {
if (_i_("4ab:420"), this.boundHide = this.hide.bind(this), this.boundCleanUp = this.cleanUp.bind(this), this.$el.find(".sb-dates-prompt__close").on("click", this.dismiss.bind(this)), this.isDismissed()) return _r_();
_ && this.isLandingScrollStarted() ? _.once(_.UI_LANDING_SCROLL_COMPLETED, this.show.bind(this)) :this.show(), _r_();
},
show:function() {
if (_i_("4ab:421"), this.hiding) return _r_();
this.$el.removeClass("g-hidden").addClass("fadein"), this.monitorId = o.addMonitor(this.el, this.boundHide), _r_();
},
hide:function() {
_i_("4ab:422"), this.hiding = !0, this.$el.removeClass("fadein").addClass("fadeout"), window.setTimeout(this.boundCleanUp, s), _r_();
},
dismiss:function() {
_i_("4ab:423"), B.et.customGoal("AEJPCcacVScZXAHWe", 1), a && B.et.customGoal("TZdPKPZFKLCSCDWOOWAUFHKBVT", 1), l(), this.hide(), _r_();
},
cleanUp:function() {
_i_("4ab:424"), this.monitorId && o.removeMonitor(this.monitorId), this.$el.addClass("g-hidden").removeClass("fadeout"), this.hiding = !1, _r_();
},
isDismissed:function() {
_i_("4ab:425");
var t = a ? B.storage({
key:n,
location:"sessionstorage"
}) :"true" === B.browserStorageHandler.getSessionValue(n);
return _r_(t);
},
isLandingScrollStarted:function() {
return _i_("4ab:426"), _r_(B.sr && B.sr.landingScrollStarted || B.env.fe_landing_scroll_started);
}
});
function l() {
_i_("4ab:80"), a ? B.storage({
key:n,
value:!0,
location:"sessionstorage"
}) :B.browserStorageHandler.addSessionValue(n, !0), _r_();
}
_r_();
});